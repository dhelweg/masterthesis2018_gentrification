select 
case 
when mss.status_index > 0.5 then "niedrig"
when mss.status_index < -0.5 then "hoch"
else "stabil"
end as status_klasse_prj,
case 
when mss.dynamik_index > 0.5 then "negativ"
when mss.dynamik_index < -0.5 then "positiv"
else "neutral"
end as dynamik_klasse_prj,
case 
when mss.status_index > 0 then "niedrig"
when mss.status_index <= 0 then "hoch"
else "stabil"
end as status_klasse_prj_bi,
case 
when mss.dynamik_index > 0 then "negativ"
when mss.dynamik_index <= 0 then "positiv"
else "neutral"
end as dynamik_klasse_prj_bi,
ewr.*, 
mss.* , 
coalesce((d_tourismus_stock / (ewr.ee/1000)),0) as d_tourismus_stock,
coalesce((d_vergnuegung_stock / (ewr.ee/1000)),0) as d_vergnuegung_stock,
coalesce((d_sport_und_erholung_stock / (ewr.ee/1000)),0) as d_sport_und_erholung_stock,
coalesce((d_public_service_stock / (ewr.ee/1000)),0) as d_public_service_stock,
coalesce((d_buero_stock / (ewr.ee/1000)),0) as d_buero_stock,
coalesce((d_mobilitaet_stock / (ewr.ee/1000)),0) as d_mobilitaet_stock,
coalesce((d_sonstiges_stock / (ewr.ee/1000)),0) as d_sonstiges_stock,
coalesce((d_gastronomie_stock / (ewr.ee/1000)),0) as d_gastronomie_stock,
coalesce((d_religion_stock / (ewr.ee/1000)),0) as d_religion_stock,
coalesce((d_oeffentlicher_raum_stock / (ewr.ee/1000)),0) as d_oeffentlicher_raum_stock,
coalesce((d_dienstleistung_stock / (ewr.ee/1000)),0) as d_dienstleistung_stock,
coalesce((d_waren_stock / (ewr.ee/1000)),0) as d_waren_stock,
coalesce((d_leerstand_stock / (ewr.ee/1000)),0) as d_leerstand_stock,
coalesce((d_tourismus_ytd / (ewr.ee/1000)),0) as d_tourismus_ytd,
coalesce((d_vergnuegung_ytd / (ewr.ee/1000)),0) as d_vergnuegung_ytd,
coalesce((d_sport_und_erholung_ytd / (ewr.ee/1000)),0) as d_sport_und_erholung_ytd,
coalesce((d_public_service_ytd / (ewr.ee/1000)),0) as d_public_service_ytd,
coalesce((d_buero_ytd / (ewr.ee/1000)),0) as d_buero_ytd,
coalesce((d_mobilitaet_ytd / (ewr.ee/1000)),0) as d_mobilitaet_ytd,
coalesce((d_sonstiges_ytd / (ewr.ee/1000)),0) as d_sonstiges_ytd,
coalesce((d_gastronomie_ytd / (ewr.ee/1000)),0) as d_gastronomie_ytd,
coalesce((d_religion_ytd / (ewr.ee/1000)),0) as d_religion_ytd,
coalesce((d_oeffentlicher_raum_ytd / (ewr.ee/1000)),0) as d_oeffentlicher_raum_ytd,
coalesce((d_dienstleistung_ytd / (ewr.ee/1000)),0) as d_dienstleistung_ytd,
coalesce((d_waren_ytd / (ewr.ee/1000)),0) as d_waren_ytd,
coalesce((d_leerstand_ytd / (ewr.ee/1000)),0) as d_leerstand_ytd,

coalesce((c_uebernachtung_stock / ewr.ee/1000),0) as c_uebernachtung_stock,
coalesce((c_sehenswuerdigkeit_stock / ewr.ee/1000),0) as c_sehenswuerdigkeit_stock,
coalesce((c_kultur_stock / ewr.ee/1000),0) as c_kultur_stock,
coalesce((c_info_stock / ewr.ee/1000),0) as c_info_stock,
coalesce((c_sport_stock / ewr.ee/1000),0) as c_sport_stock,
coalesce((c_erholung_stock / ewr.ee/1000),0) as c_erholung_stock,
coalesce((c_zwielicht_stock / ewr.ee/1000),0) as c_zwielicht_stock,
coalesce((c_bildung_stock / ewr.ee/1000),0) as c_bildung_stock,
coalesce((c_buero_stock / ewr.ee/1000),0) as c_buero_stock,
coalesce((c_individual_stock / ewr.ee/1000),0) as c_individual_stock,
coalesce((c_hipster_stock / ewr.ee/1000),0) as c_hipster_stock,
coalesce((c_sicherheit_stock / ewr.ee/1000),0) as c_sicherheit_stock,
coalesce((c_sonstiges_stock / ewr.ee/1000),0) as c_sonstiges_stock,
coalesce((c_ausgehen_stock / ewr.ee/1000),0) as c_ausgehen_stock,
coalesce((c_gaststaetten_stock / ewr.ee/1000),0) as c_gaststaetten_stock,
coalesce((c_sozial_stock / ewr.ee/1000),0) as c_sozial_stock,
coalesce((c_cafe_stock / ewr.ee/1000),0) as c_cafe_stock,
coalesce((c_religioese_gebaeude_stock / ewr.ee/1000),0) as c_religioese_gebaeude_stock,
coalesce((c_post_stock / ewr.ee/1000),0) as c_post_stock,
coalesce((c_gesundheit_stock / ewr.ee/1000),0) as c_gesundheit_stock,
coalesce((c_wc_stock / ewr.ee/1000),0) as c_wc_stock,
coalesce((c_bank_stock / ewr.ee/1000),0) as c_bank_stock,
coalesce((c_telefon_stock / ewr.ee/1000),0) as c_telefon_stock,
coalesce((c_recycling_stock / ewr.ee/1000),0) as c_recycling_stock,
coalesce((c_parkbank_stock / ewr.ee/1000),0) as c_parkbank_stock,
coalesce((c_briefe_und_pakete_stock / ewr.ee/1000),0) as c_briefe_und_pakete_stock,
coalesce((c_friedhof_stock / ewr.ee/1000),0) as c_friedhof_stock,
coalesce((c_automaten_stock / ewr.ee/1000),0) as c_automaten_stock,
coalesce((c_oepnv_stock / ewr.ee/1000),0) as c_oepnv_stock,
coalesce((c_restaurant_stock / ewr.ee/1000),0) as c_restaurant_stock,
coalesce((c_fast_food_stock / ewr.ee/1000),0) as c_fast_food_stock,
coalesce((c_friseur_stock / ewr.ee/1000),0) as c_friseur_stock,
coalesce((c_essen_und_trinken_stock / ewr.ee/1000),0) as c_essen_und_trinken_stock,
coalesce((c_kleidung_stock / ewr.ee/1000),0) as c_kleidung_stock,
coalesce((c_sonstige_waren_stock / ewr.ee/1000),0) as c_sonstige_waren_stock,
coalesce((c_werkstatt_stock / ewr.ee/1000),0) as c_werkstatt_stock,
coalesce((c_kosmetik_und_beauty_stock / ewr.ee/1000),0) as c_kosmetik_und_beauty_stock,
coalesce((c_medical_stock / ewr.ee/1000),0) as c_medical_stock,
coalesce((c_print_stock / ewr.ee/1000),0) as c_print_stock,
coalesce((c_massage_stock / ewr.ee/1000),0) as c_massage_stock,
coalesce((c_drogerie_stock / ewr.ee/1000),0) as c_drogerie_stock,
coalesce((c_reisen_stock / ewr.ee/1000),0) as c_reisen_stock,
coalesce((c_technik_stock / ewr.ee/1000),0) as c_technik_stock,
coalesce((c_spielzeug_und_geschenke_stock / ewr.ee/1000),0) as c_spielzeug_und_geschenke_stock,
coalesce((c_waescherei_stock / ewr.ee/1000),0) as c_waescherei_stock,
coalesce((c_kunst_stock / ewr.ee/1000),0) as c_kunst_stock,
coalesce((c_beerdigung_stock / ewr.ee/1000),0) as c_beerdigung_stock,
coalesce((c_handwerk_stock / ewr.ee/1000),0) as c_handwerk_stock,
coalesce((c_leerstand_stock / ewr.ee/1000),0) as c_leerstand_stock,
coalesce((c_sonstiger_shop_stock / ewr.ee/1000),0) as c_sonstiger_shop_stock,
coalesce((c_sonstiges_gebaeude_stock / ewr.ee/1000),0) as c_sonstiges_gebaeude_stock,
coalesce((c_sonstiges_gelaende_stock / ewr.ee/1000),0) as c_sonstiges_gelaende_stock,
coalesce((c_sonstiges_tourismus_stock / ewr.ee/1000),0) as c_sonstiges_tourismus_stock,
coalesce((c_uebernachtung_ytd / ewr.ee/1000),0) as c_uebernachtung_ytd,
coalesce((c_sehenswuerdigkeit_ytd / ewr.ee/1000),0) as c_sehenswuerdigkeit_ytd,
coalesce((c_kultur_ytd / ewr.ee/1000),0) as c_kultur_ytd,
coalesce((c_info_ytd / ewr.ee/1000),0) as c_info_ytd,
coalesce((c_sport_ytd / ewr.ee/1000),0) as c_sport_ytd,
coalesce((c_erholung_ytd / ewr.ee/1000),0) as c_erholung_ytd,
coalesce((c_zwielicht_ytd / ewr.ee/1000),0) as c_zwielicht_ytd,
coalesce((c_bildung_ytd / ewr.ee/1000),0) as c_bildung_ytd,
coalesce((c_buero_ytd / ewr.ee/1000),0) as c_buero_ytd,
coalesce((c_individual_ytd / ewr.ee/1000),0) as c_individual_ytd,
coalesce((c_hipster_ytd / ewr.ee/1000),0) as c_hipster_ytd,
coalesce((c_sicherheit_ytd / ewr.ee/1000),0) as c_sicherheit_ytd,
coalesce((c_sonstiges_ytd / ewr.ee/1000),0) as c_sonstiges_ytd,
coalesce((c_ausgehen_ytd / ewr.ee/1000),0) as c_ausgehen_ytd,
coalesce((c_gaststaetten_ytd / ewr.ee/1000),0) as c_gaststaetten_ytd,
coalesce((c_sozial_ytd / ewr.ee/1000),0) as c_sozial_ytd,
coalesce((c_cafe_ytd / ewr.ee/1000),0) as c_cafe_ytd,
coalesce((c_religioese_gebaeude_ytd / ewr.ee/1000),0) as c_religioese_gebaeude_ytd,
coalesce((c_post_ytd / ewr.ee/1000),0) as c_post_ytd,
coalesce((c_gesundheit_ytd / ewr.ee/1000),0) as c_gesundheit_ytd,
coalesce((c_wc_ytd / ewr.ee/1000),0) as c_wc_ytd,
coalesce((c_bank_ytd / ewr.ee/1000),0) as c_bank_ytd,
coalesce((c_telefon_ytd / ewr.ee/1000),0) as c_telefon_ytd,
coalesce((c_recycling_ytd / ewr.ee/1000),0) as c_recycling_ytd,
coalesce((c_parkbank_ytd / ewr.ee/1000),0) as c_parkbank_ytd,
coalesce((c_briefe_und_pakete_ytd / ewr.ee/1000),0) as c_briefe_und_pakete_ytd,
coalesce((c_friedhof_ytd / ewr.ee/1000),0) as c_friedhof_ytd,
coalesce((c_automaten_ytd / ewr.ee/1000),0) as c_automaten_ytd,
coalesce((c_oepnv_ytd / ewr.ee/1000),0) as c_oepnv_ytd,
coalesce((c_restaurant_ytd / ewr.ee/1000),0) as c_restaurant_ytd,
coalesce((c_fast_food_ytd / ewr.ee/1000),0) as c_fast_food_ytd,
coalesce((c_friseur_ytd / ewr.ee/1000),0) as c_friseur_ytd,
coalesce((c_essen_und_trinken_ytd / ewr.ee/1000),0) as c_essen_und_trinken_ytd,
coalesce((c_kleidung_ytd / ewr.ee/1000),0) as c_kleidung_ytd,
coalesce((c_sonstige_waren_ytd / ewr.ee/1000),0) as c_sonstige_waren_ytd,
coalesce((c_werkstatt_ytd / ewr.ee/1000),0) as c_werkstatt_ytd,
coalesce((c_kosmetik_und_beauty_ytd / ewr.ee/1000),0) as c_kosmetik_und_beauty_ytd,
coalesce((c_medical_ytd / ewr.ee/1000),0) as c_medical_ytd,
coalesce((c_print_ytd / ewr.ee/1000),0) as c_print_ytd,
coalesce((c_massage_ytd / ewr.ee/1000),0) as c_massage_ytd,
coalesce((c_drogerie_ytd / ewr.ee/1000),0) as c_drogerie_ytd,
coalesce((c_reisen_ytd / ewr.ee/1000),0) as c_reisen_ytd,
coalesce((c_technik_ytd / ewr.ee/1000),0) as c_technik_ytd,
coalesce((c_spielzeug_und_geschenke_ytd / ewr.ee/1000),0) as c_spielzeug_und_geschenke_ytd,
coalesce((c_waescherei_ytd / ewr.ee/1000),0) as c_waescherei_ytd,
coalesce((c_kunst_ytd / ewr.ee/1000),0) as c_kunst_ytd,
coalesce((c_beerdigung_ytd / ewr.ee/1000),0) as c_beerdigung_ytd,
coalesce((c_handwerk_ytd / ewr.ee/1000),0) as c_handwerk_ytd,
coalesce((c_leerstand_ytd / ewr.ee/1000),0) as c_leerstand_ytd,
coalesce((c_sonstiger_shop_ytd / ewr.ee/1000),0) as c_sonstiger_shop_ytd,
coalesce((c_sonstiges_gebaeude_ytd / ewr.ee/1000),0) as c_sonstiges_gebaeude_ytd,
coalesce((c_sonstiges_gelaende_ytd / ewr.ee/1000),0) as c_sonstiges_gelaende_ytd,
coalesce((c_sonstiges_tourismus_ytd / ewr.ee/1000),0) as c_sonstiges_tourismus_ytd,


coalesce((t_hostel_ytd / ewr.ee/1000),0) as t_hostel_ytd,
coalesce((t_hotel_ytd / ewr.ee/1000),0) as t_hotel_ytd,
coalesce((t_sonstige_ytd / ewr.ee/1000),0) as t_sonstige_ytd,
coalesce((t_kunstwerk_ytd / ewr.ee/1000),0) as t_kunstwerk_ytd,
coalesce((t_kunstzentrum_ytd / ewr.ee/1000),0) as t_kunstzentrum_ytd,
coalesce((t_gallerie_ytd / ewr.ee/1000),0) as t_gallerie_ytd,
coalesce((t_info_ytd / ewr.ee/1000),0) as t_info_ytd,
coalesce((t_museum_ytd / ewr.ee/1000),0) as t_museum_ytd,
coalesce((t_aussichtspunkt_ytd / ewr.ee/1000),0) as t_aussichtspunkt_ytd,
coalesce((t_zoo_ytd / ewr.ee/1000),0) as t_zoo_ytd,
coalesce((t_schwimmen_ytd / ewr.ee/1000),0) as t_schwimmen_ytd,
coalesce((t_basketball_ytd / ewr.ee/1000),0) as t_basketball_ytd,
coalesce((t_fussball_ytd / ewr.ee/1000),0) as t_fussball_ytd,
coalesce((t_sportzentrum_ytd / ewr.ee/1000),0) as t_sportzentrum_ytd,
coalesce((t_tischtennis_ytd / ewr.ee/1000),0) as t_tischtennis_ytd,
coalesce((t_sauna_ytd / ewr.ee/1000),0) as t_sauna_ytd,
coalesce((t_tennis_ytd / ewr.ee/1000),0) as t_tennis_ytd,
coalesce((t_kampfsport_ytd / ewr.ee/1000),0) as t_kampfsport_ytd,
coalesce((t_fitnesszentrum_ytd / ewr.ee/1000),0) as t_fitnesszentrum_ytd,
coalesce((t_spielplatz_ytd / ewr.ee/1000),0) as t_spielplatz_ytd,
coalesce((t_wassersport_ytd / ewr.ee/1000),0) as t_wassersport_ytd,
coalesce((t_spielothek_ytd / ewr.ee/1000),0) as t_spielothek_ytd,
coalesce((t_sonstige_sportarten_ytd / ewr.ee/1000),0) as t_sonstige_sportarten_ytd,
coalesce((t_kindergarten_ytd / ewr.ee/1000),0) as t_kindergarten_ytd,
coalesce((t_buero_ytd / ewr.ee/1000),0) as t_buero_ytd,
coalesce((t_tankstelle_ytd / ewr.ee/1000),0) as t_tankstelle_ytd,
coalesce((t_coworking_space_ytd / ewr.ee/1000),0) as t_coworking_space_ytd,
coalesce((t_universitaet_ytd / ewr.ee/1000),0) as t_universitaet_ytd,
coalesce((t_poilzei_ytd / ewr.ee/1000),0) as t_poilzei_ytd,
coalesce((t_feuerwehr_ytd / ewr.ee/1000),0) as t_feuerwehr_ytd,
coalesce((t_kita_ytd / ewr.ee/1000),0) as t_kita_ytd,
coalesce((t_hoehere_schule_ytd / ewr.ee/1000),0) as t_hoehere_schule_ytd,
coalesce((t_wochenmarkt_ytd / ewr.ee/1000),0) as t_wochenmarkt_ytd,
coalesce((t_kino_ytd / ewr.ee/1000),0) as t_kino_ytd,
coalesce((t_biergarten_ytd / ewr.ee/1000),0) as t_biergarten_ytd,
coalesce((t_autovermietung_ytd / ewr.ee/1000),0) as t_autovermietung_ytd,
coalesce((t_buecherei_ytd / ewr.ee/1000),0) as t_buecherei_ytd,
coalesce((t_nachbarschaftszentrum_ytd / ewr.ee/1000),0) as t_nachbarschaftszentrum_ytd,
coalesce((t_theater_ytd / ewr.ee/1000),0) as t_theater_ytd,
coalesce((t_eisdiele_ytd / ewr.ee/1000),0) as t_eisdiele_ytd,
coalesce((t_nachtclub_ytd / ewr.ee/1000),0) as t_nachtclub_ytd,
coalesce((t_kirche_ytd / ewr.ee/1000),0) as t_kirche_ytd,
coalesce((t_moschee_ytd / ewr.ee/1000),0) as t_moschee_ytd,
coalesce((t_sonstige_tempel_ytd / ewr.ee/1000),0) as t_sonstige_tempel_ytd,
coalesce((t_schule_ytd / ewr.ee/1000),0) as t_schule_ytd,
coalesce((t_bordell_ytd / ewr.ee/1000),0) as t_bordell_ytd,
coalesce((t_post_filiale_ytd / ewr.ee/1000),0) as t_post_filiale_ytd,
coalesce((t_sozialeinrichtung_ytd / ewr.ee/1000),0) as t_sozialeinrichtung_ytd,
coalesce((t_ladestation_ytd / ewr.ee/1000),0) as t_ladestation_ytd,
coalesce((t_zahnarzt_ytd / ewr.ee/1000),0) as t_zahnarzt_ytd,
coalesce((t_fahrradverleih_ytd / ewr.ee/1000),0) as t_fahrradverleih_ytd,
coalesce((t_fahrschule_ytd / ewr.ee/1000),0) as t_fahrschule_ytd,
coalesce((t_tierarzt_ytd / ewr.ee/1000),0) as t_tierarzt_ytd,
coalesce((t_botschaft_ytd / ewr.ee/1000),0) as t_botschaft_ytd,
coalesce((t_taxistand_ytd / ewr.ee/1000),0) as t_taxistand_ytd,
coalesce((t_wc_ytd / ewr.ee/1000),0) as t_wc_ytd,
coalesce((t_bankfiliale_ytd / ewr.ee/1000),0) as t_bankfiliale_ytd,
coalesce((t_arzt_ytd / ewr.ee/1000),0) as t_arzt_ytd,
coalesce((t_parkplatz_ytd / ewr.ee/1000),0) as t_parkplatz_ytd,
coalesce((t_bar_ytd / ewr.ee/1000),0) as t_bar_ytd,
coalesce((t_apotheke_ytd / ewr.ee/1000),0) as t_apotheke_ytd,
coalesce((t_pub_ytd / ewr.ee/1000),0) as t_pub_ytd,
coalesce((t_telefon_ytd / ewr.ee/1000),0) as t_telefon_ytd,
coalesce((t_kaffee_ytd / ewr.ee/1000),0) as t_kaffee_ytd,
coalesce((t_sonstige_cafes_ytd / ewr.ee/1000),0) as t_sonstige_cafes_ytd,
coalesce((t_fahrrad_parkplatz_ytd / ewr.ee/1000),0) as t_fahrrad_parkplatz_ytd,
coalesce((t_muelleimer_ytd / ewr.ee/1000),0) as t_muelleimer_ytd,
coalesce((t_parkbank_ytd / ewr.ee/1000),0) as t_parkbank_ytd,
coalesce((t_krankenhaus_ytd / ewr.ee/1000),0) as t_krankenhaus_ytd,
coalesce((t_klinik_ytd / ewr.ee/1000),0) as t_klinik_ytd,
coalesce((t_geldautomat_ytd / ewr.ee/1000),0) as t_geldautomat_ytd,
coalesce((t_briefkasten_ytd / ewr.ee/1000),0) as t_briefkasten_ytd,
coalesce((t_friedhof_ytd / ewr.ee/1000),0) as t_friedhof_ytd,
coalesce((t_musikschule_ytd / ewr.ee/1000),0) as t_musikschule_ytd,
coalesce((t_paketautomat_ytd / ewr.ee/1000),0) as t_paketautomat_ytd,
coalesce((t_sonstige_automaten_ytd / ewr.ee/1000),0) as t_sonstige_automaten_ytd,
coalesce((t_fahrscheinautomat_ytd / ewr.ee/1000),0) as t_fahrscheinautomat_ytd,
coalesce((t_parkticketautomat_ytd / ewr.ee/1000),0) as t_parkticketautomat_ytd,
coalesce((t_kotbeutelautomat_ytd / ewr.ee/1000),0) as t_kotbeutelautomat_ytd,
coalesce((t_zigarettenautomat_ytd / ewr.ee/1000),0) as t_zigarettenautomat_ytd,
coalesce((t_suessigkeitenautomat_ytd / ewr.ee/1000),0) as t_suessigkeitenautomat_ytd,
coalesce((t_briefmarkenautomat_ytd / ewr.ee/1000),0) as t_briefmarkenautomat_ytd,
coalesce((t_kondomautomat_ytd / ewr.ee/1000),0) as t_kondomautomat_ytd,
coalesce((t_getraenke_und_suessigkeitenautomat_ytd / ewr.ee/1000),0) as t_getraenke_und_suessigkeitenautomat_ytd,
coalesce((t_getraenkeautomat_ytd / ewr.ee/1000),0) as t_getraenkeautomat_ytd,
coalesce((t_grillplatz_ytd / ewr.ee/1000),0) as t_grillplatz_ytd,
coalesce((t_glascontainer_ytd / ewr.ee/1000),0) as t_glascontainer_ytd,
coalesce((t_glas__und_kleidungscontainer_ytd / ewr.ee/1000),0) as t_glas__und_kleidungscontainer_ytd,
coalesce((t_kleidungscontainer_ytd / ewr.ee/1000),0) as t_kleidungscontainer_ytd,
coalesce((t_sonstige_container_ytd / ewr.ee/1000),0) as t_sonstige_container_ytd,
coalesce((t_restaurant_italiener_ytd / ewr.ee/1000),0) as t_restaurant_italiener_ytd,
coalesce((t_restaurant_deutsch_ytd / ewr.ee/1000),0) as t_restaurant_deutsch_ytd,
coalesce((t_restaurant_indisch_ytd / ewr.ee/1000),0) as t_restaurant_indisch_ytd,
coalesce((t_restaurant_asiatisch_ytd / ewr.ee/1000),0) as t_restaurant_asiatisch_ytd,
coalesce((t_restaurant_sushi_ytd / ewr.ee/1000),0) as t_restaurant_sushi_ytd,
coalesce((t_restaurant_griechisch_ytd / ewr.ee/1000),0) as t_restaurant_griechisch_ytd,
coalesce((t_restaurant_steakhouse_ytd / ewr.ee/1000),0) as t_restaurant_steakhouse_ytd,
coalesce((t_restaurant_international_ytd / ewr.ee/1000),0) as t_restaurant_international_ytd,
coalesce((t_restaurant_tuerkisch_ytd / ewr.ee/1000),0) as t_restaurant_tuerkisch_ytd,
coalesce((t_fastfood_kebap_ytd / ewr.ee/1000),0) as t_fastfood_kebap_ytd,
coalesce((t_fastfood_burger_ytd / ewr.ee/1000),0) as t_fastfood_burger_ytd,
coalesce((t_fastfood_asiatisch_ytd / ewr.ee/1000),0) as t_fastfood_asiatisch_ytd,
coalesce((t_fastfood_pizza_ytd / ewr.ee/1000),0) as t_fastfood_pizza_ytd,
coalesce((t_fastfood_pommesbude_ytd / ewr.ee/1000),0) as t_fastfood_pommesbude_ytd,
coalesce((t_fast_food_sonstiges_ytd / ewr.ee/1000),0) as t_fast_food_sonstiges_ytd,
coalesce((t_restaurant_sonstiges_ytd / ewr.ee/1000),0) as t_restaurant_sonstiges_ytd,
coalesce((t_friseur_ytd / ewr.ee/1000),0) as t_friseur_ytd,
coalesce((t_baeckerei_ytd / ewr.ee/1000),0) as t_baeckerei_ytd,
coalesce((t_kleidung_ytd / ewr.ee/1000),0) as t_kleidung_ytd,
coalesce((t_supermarkt_ytd / ewr.ee/1000),0) as t_supermarkt_ytd,
coalesce((t_kiosk_ytd / ewr.ee/1000),0) as t_kiosk_ytd,
coalesce((t_florist_ytd / ewr.ee/1000),0) as t_florist_ytd,
coalesce((t_fahrrad_ytd / ewr.ee/1000),0) as t_fahrrad_ytd,
coalesce((t_kosmetik_und_beauty_ytd / ewr.ee/1000),0) as t_kosmetik_und_beauty_ytd,
coalesce((t_optiker_ytd / ewr.ee/1000),0) as t_optiker_ytd,
coalesce((t_schuhe_ytd / ewr.ee/1000),0) as t_schuhe_ytd,
coalesce((t_buecher_ytd / ewr.ee/1000),0) as t_buecher_ytd,
coalesce((t_massage_ytd / ewr.ee/1000),0) as t_massage_ytd,
coalesce((t_schmuck_ytd / ewr.ee/1000),0) as t_schmuck_ytd,
coalesce((t_autoreperatur_ytd / ewr.ee/1000),0) as t_autoreperatur_ytd,
coalesce((t_drogerie_ytd / ewr.ee/1000),0) as t_drogerie_ytd,
coalesce((t_reisen_ytd / ewr.ee/1000),0) as t_reisen_ytd,
coalesce((t_mobilfunk_ytd / ewr.ee/1000),0) as t_mobilfunk_ytd,
coalesce((t_moebel_ytd / ewr.ee/1000),0) as t_moebel_ytd,
coalesce((t_getraenke_ytd / ewr.ee/1000),0) as t_getraenke_ytd,
coalesce((t_feinkost_ytd / ewr.ee/1000),0) as t_feinkost_ytd,
coalesce((t_elektronik_ytd / ewr.ee/1000),0) as t_elektronik_ytd,
coalesce((t_boutique_ytd / ewr.ee/1000),0) as t_boutique_ytd,
coalesce((t_autohaus_ytd / ewr.ee/1000),0) as t_autohaus_ytd,
coalesce((t_spirituosen_ytd / ewr.ee/1000),0) as t_spirituosen_ytd,
coalesce((t_geschenke_ytd / ewr.ee/1000),0) as t_geschenke_ytd,
coalesce((t_postenmarkt_ytd / ewr.ee/1000),0) as t_postenmarkt_ytd,
coalesce((t_schlachter_ytd / ewr.ee/1000),0) as t_schlachter_ytd,
coalesce((t_waescherei_ytd / ewr.ee/1000),0) as t_waescherei_ytd,
coalesce((t_computer_ytd / ewr.ee/1000),0) as t_computer_ytd,
coalesce((t_spielzeug_ytd / ewr.ee/1000),0) as t_spielzeug_ytd,
coalesce((t_copyshop_ytd / ewr.ee/1000),0) as t_copyshop_ytd,
coalesce((t_schneider_ytd / ewr.ee/1000),0) as t_schneider_ytd,
coalesce((t_foto_ytd / ewr.ee/1000),0) as t_foto_ytd,
coalesce((t_kunst_ytd / ewr.ee/1000),0) as t_kunst_ytd,
coalesce((t_suessigkeiten_ytd / ewr.ee/1000),0) as t_suessigkeiten_ytd,
coalesce((t_dekoration_ytd / ewr.ee/1000),0) as t_dekoration_ytd,
coalesce((t_reinigung_ytd / ewr.ee/1000),0) as t_reinigung_ytd,
coalesce((t_beerdigung_ytd / ewr.ee/1000),0) as t_beerdigung_ytd,
coalesce((t_sport_ytd / ewr.ee/1000),0) as t_sport_ytd,
coalesce((t_zoofachgeschaeft_ytd / ewr.ee/1000),0) as t_zoofachgeschaeft_ytd,
coalesce((t_textilgeschaeft_ytd / ewr.ee/1000),0) as t_textilgeschaeft_ytd,
coalesce((t_hoergeraete_ytd / ewr.ee/1000),0) as t_hoergeraete_ytd,
coalesce((t_baumarkt_ytd / ewr.ee/1000),0) as t_baumarkt_ytd,
coalesce((t_leerstand_ytd / ewr.ee/1000),0) as t_leerstand_ytd,
coalesce((t_medical_ytd / ewr.ee/1000),0) as t_medical_ytd,
coalesce((t_second_hand_ytd / ewr.ee/1000),0) as t_second_hand_ytd,
coalesce((t_zeitung_ytd / ewr.ee/1000),0) as t_zeitung_ytd,
coalesce((t_eisenwarenhandlung_ytd / ewr.ee/1000),0) as t_eisenwarenhandlung_ytd,
coalesce((t_sonstiger_shop_ytd / ewr.ee/1000),0) as t_sonstiger_shop_ytd,
coalesce((t_baudenkmal_ytd / ewr.ee/1000),0) as t_baudenkmal_ytd,
coalesce((t_haltestelle_ytd / ewr.ee/1000),0) as t_haltestelle_ytd,
coalesce((t_sonstiges_gebaeude_ytd / ewr.ee/1000),0) as t_sonstiges_gebaeude_ytd,
coalesce((t_sonstiges_gelaende_ytd / ewr.ee/1000),0) as t_sonstiges_gelaende_ytd,
coalesce((t_sonstiges_denkmal_ytd / ewr.ee/1000),0) as t_sonstiges_denkmal_ytd,
coalesce((t_sonstiges_tourismus_ytd / ewr.ee/1000),0) as t_sonstiges_tourismus_ytd,
coalesce((t_sonstiges_sport_ytd / ewr.ee/1000),0) as t_sonstiges_sport_ytd,
coalesce((t_sonstiges_erholung_ytd / ewr.ee/1000),0) as t_sonstiges_erholung_ytd,
coalesce((t_hostel_stock / ewr.ee/1000),0) as t_hostel_stock,
coalesce((t_hotel_stock / ewr.ee/1000),0) as t_hotel_stock,
coalesce((t_sonstige_stock / ewr.ee/1000),0) as t_sonstige_stock,
coalesce((t_kunstwerk_stock / ewr.ee/1000),0) as t_kunstwerk_stock,
coalesce((t_kunstzentrum_stock / ewr.ee/1000),0) as t_kunstzentrum_stock,
coalesce((t_gallerie_stock / ewr.ee/1000),0) as t_gallerie_stock,
coalesce((t_info_stock / ewr.ee/1000),0) as t_info_stock,
coalesce((t_museum_stock / ewr.ee/1000),0) as t_museum_stock,
coalesce((t_aussichtspunkt_stock / ewr.ee/1000),0) as t_aussichtspunkt_stock,
coalesce((t_zoo_stock / ewr.ee/1000),0) as t_zoo_stock,
coalesce((t_schwimmen_stock / ewr.ee/1000),0) as t_schwimmen_stock,
coalesce((t_basketball_stock / ewr.ee/1000),0) as t_basketball_stock,
coalesce((t_fussball_stock / ewr.ee/1000),0) as t_fussball_stock,
coalesce((t_sportzentrum_stock / ewr.ee/1000),0) as t_sportzentrum_stock,
coalesce((t_tischtennis_stock / ewr.ee/1000),0) as t_tischtennis_stock,
coalesce((t_sauna_stock / ewr.ee/1000),0) as t_sauna_stock,
coalesce((t_tennis_stock / ewr.ee/1000),0) as t_tennis_stock,
coalesce((t_kampfsport_stock / ewr.ee/1000),0) as t_kampfsport_stock,
coalesce((t_fitnesszentrum_stock / ewr.ee/1000),0) as t_fitnesszentrum_stock,
coalesce((t_spielplatz_stock / ewr.ee/1000),0) as t_spielplatz_stock,
coalesce((t_wassersport_stock / ewr.ee/1000),0) as t_wassersport_stock,
coalesce((t_spielothek_stock / ewr.ee/1000),0) as t_spielothek_stock,
coalesce((t_sonstige_sportarten_stock / ewr.ee/1000),0) as t_sonstige_sportarten_stock,
coalesce((t_kindergarten_stock / ewr.ee/1000),0) as t_kindergarten_stock,
coalesce((t_buero_stock / ewr.ee/1000),0) as t_buero_stock,
coalesce((t_tankstelle_stock / ewr.ee/1000),0) as t_tankstelle_stock,
coalesce((t_coworking_space_stock / ewr.ee/1000),0) as t_coworking_space_stock,
coalesce((t_universitaet_stock / ewr.ee/1000),0) as t_universitaet_stock,
coalesce((t_poilzei_stock / ewr.ee/1000),0) as t_poilzei_stock,
coalesce((t_feuerwehr_stock / ewr.ee/1000),0) as t_feuerwehr_stock,
coalesce((t_kita_stock / ewr.ee/1000),0) as t_kita_stock,
coalesce((t_hoehere_schule_stock / ewr.ee/1000),0) as t_hoehere_schule_stock,
coalesce((t_wochenmarkt_stock / ewr.ee/1000),0) as t_wochenmarkt_stock,
coalesce((t_kino_stock / ewr.ee/1000),0) as t_kino_stock,
coalesce((t_biergarten_stock / ewr.ee/1000),0) as t_biergarten_stock,
coalesce((t_autovermietung_stock / ewr.ee/1000),0) as t_autovermietung_stock,
coalesce((t_buecherei_stock / ewr.ee/1000),0) as t_buecherei_stock,
coalesce((t_nachbarschaftszentrum_stock / ewr.ee/1000),0) as t_nachbarschaftszentrum_stock,
coalesce((t_theater_stock / ewr.ee/1000),0) as t_theater_stock,
coalesce((t_eisdiele_stock / ewr.ee/1000),0) as t_eisdiele_stock,
coalesce((t_nachtclub_stock / ewr.ee/1000),0) as t_nachtclub_stock,
coalesce((t_kirche_stock / ewr.ee/1000),0) as t_kirche_stock,
coalesce((t_moschee_stock / ewr.ee/1000),0) as t_moschee_stock,
coalesce((t_sonstige_tempel_stock / ewr.ee/1000),0) as t_sonstige_tempel_stock,
coalesce((t_schule_stock / ewr.ee/1000),0) as t_schule_stock,
coalesce((t_bordell_stock / ewr.ee/1000),0) as t_bordell_stock,
coalesce((t_post_filiale_stock / ewr.ee/1000),0) as t_post_filiale_stock,
coalesce((t_sozialeinrichtung_stock / ewr.ee/1000),0) as t_sozialeinrichtung_stock,
coalesce((t_ladestation_stock / ewr.ee/1000),0) as t_ladestation_stock,
coalesce((t_zahnarzt_stock / ewr.ee/1000),0) as t_zahnarzt_stock,
coalesce((t_fahrradverleih_stock / ewr.ee/1000),0) as t_fahrradverleih_stock,
coalesce((t_fahrschule_stock / ewr.ee/1000),0) as t_fahrschule_stock,
coalesce((t_tierarzt_stock / ewr.ee/1000),0) as t_tierarzt_stock,
coalesce((t_botschaft_stock / ewr.ee/1000),0) as t_botschaft_stock,
coalesce((t_taxistand_stock / ewr.ee/1000),0) as t_taxistand_stock,
coalesce((t_wc_stock / ewr.ee/1000),0) as t_wc_stock,
coalesce((t_bankfiliale_stock / ewr.ee/1000),0) as t_bankfiliale_stock,
coalesce((t_arzt_stock / ewr.ee/1000),0) as t_arzt_stock,
coalesce((t_parkplatz_stock / ewr.ee/1000),0) as t_parkplatz_stock,
coalesce((t_bar_stock / ewr.ee/1000),0) as t_bar_stock,
coalesce((t_apotheke_stock / ewr.ee/1000),0) as t_apotheke_stock,
coalesce((t_pub_stock / ewr.ee/1000),0) as t_pub_stock,
coalesce((t_telefon_stock / ewr.ee/1000),0) as t_telefon_stock,
coalesce((t_kaffee_stock / ewr.ee/1000),0) as t_kaffee_stock,
coalesce((t_sonstige_cafes_stock / ewr.ee/1000),0) as t_sonstige_cafes_stock,
coalesce((t_fahrrad_parkplatz_stock / ewr.ee/1000),0) as t_fahrrad_parkplatz_stock,
coalesce((t_muelleimer_stock / ewr.ee/1000),0) as t_muelleimer_stock,
coalesce((t_parkbank_stock / ewr.ee/1000),0) as t_parkbank_stock,
coalesce((t_krankenhaus_stock / ewr.ee/1000),0) as t_krankenhaus_stock,
coalesce((t_klinik_stock / ewr.ee/1000),0) as t_klinik_stock,
coalesce((t_geldautomat_stock / ewr.ee/1000),0) as t_geldautomat_stock,
coalesce((t_briefkasten_stock / ewr.ee/1000),0) as t_briefkasten_stock,
coalesce((t_friedhof_stock / ewr.ee/1000),0) as t_friedhof_stock,
coalesce((t_musikschule_stock / ewr.ee/1000),0) as t_musikschule_stock,
coalesce((t_paketautomat_stock / ewr.ee/1000),0) as t_paketautomat_stock,
coalesce((t_sonstige_automaten_stock / ewr.ee/1000),0) as t_sonstige_automaten_stock,
coalesce((t_fahrscheinautomat_stock / ewr.ee/1000),0) as t_fahrscheinautomat_stock,
coalesce((t_parkticketautomat_stock / ewr.ee/1000),0) as t_parkticketautomat_stock,
coalesce((t_kotbeutelautomat_stock / ewr.ee/1000),0) as t_kotbeutelautomat_stock,
coalesce((t_zigarettenautomat_stock / ewr.ee/1000),0) as t_zigarettenautomat_stock,
coalesce((t_suessigkeitenautomat_stock / ewr.ee/1000),0) as t_suessigkeitenautomat_stock,
coalesce((t_briefmarkenautomat_stock / ewr.ee/1000),0) as t_briefmarkenautomat_stock,
coalesce((t_kondomautomat_stock / ewr.ee/1000),0) as t_kondomautomat_stock,
coalesce((t_getraenke_und_suessigkeitenautomat_stock / ewr.ee/1000),0) as t_getraenke_und_suessigkeitenautomat_stock,
coalesce((t_getraenkeautomat_stock / ewr.ee/1000),0) as t_getraenkeautomat_stock,
coalesce((t_grillplatz_stock / ewr.ee/1000),0) as t_grillplatz_stock,
coalesce((t_glascontainer_stock / ewr.ee/1000),0) as t_glascontainer_stock,
coalesce((t_glas__und_kleidungscontainer_stock / ewr.ee/1000),0) as t_glas__und_kleidungscontainer_stock,
coalesce((t_kleidungscontainer_stock / ewr.ee/1000),0) as t_kleidungscontainer_stock,
coalesce((t_sonstige_container_stock / ewr.ee/1000),0) as t_sonstige_container_stock,
coalesce((t_restaurant_italiener_stock / ewr.ee/1000),0) as t_restaurant_italiener_stock,
coalesce((t_restaurant_deutsch_stock / ewr.ee/1000),0) as t_restaurant_deutsch_stock,
coalesce((t_restaurant_indisch_stock / ewr.ee/1000),0) as t_restaurant_indisch_stock,
coalesce((t_restaurant_asiatisch_stock / ewr.ee/1000),0) as t_restaurant_asiatisch_stock,
coalesce((t_restaurant_sushi_stock / ewr.ee/1000),0) as t_restaurant_sushi_stock,
coalesce((t_restaurant_griechisch_stock / ewr.ee/1000),0) as t_restaurant_griechisch_stock,
coalesce((t_restaurant_steakhouse_stock / ewr.ee/1000),0) as t_restaurant_steakhouse_stock,
coalesce((t_restaurant_international_stock / ewr.ee/1000),0) as t_restaurant_international_stock,
coalesce((t_restaurant_tuerkisch_stock / ewr.ee/1000),0) as t_restaurant_tuerkisch_stock,
coalesce((t_fastfood_kebap_stock / ewr.ee/1000),0) as t_fastfood_kebap_stock,
coalesce((t_fastfood_burger_stock / ewr.ee/1000),0) as t_fastfood_burger_stock,
coalesce((t_fastfood_asiatisch_stock / ewr.ee/1000),0) as t_fastfood_asiatisch_stock,
coalesce((t_fastfood_pizza_stock / ewr.ee/1000),0) as t_fastfood_pizza_stock,
coalesce((t_fastfood_pommesbude_stock / ewr.ee/1000),0) as t_fastfood_pommesbude_stock,
coalesce((t_fast_food_sonstiges_stock / ewr.ee/1000),0) as t_fast_food_sonstiges_stock,
coalesce((t_restaurant_sonstiges_stock / ewr.ee/1000),0) as t_restaurant_sonstiges_stock,
coalesce((t_friseur_stock / ewr.ee/1000),0) as t_friseur_stock,
coalesce((t_baeckerei_stock / ewr.ee/1000),0) as t_baeckerei_stock,
coalesce((t_kleidung_stock / ewr.ee/1000),0) as t_kleidung_stock,
coalesce((t_supermarkt_stock / ewr.ee/1000),0) as t_supermarkt_stock,
coalesce((t_kiosk_stock / ewr.ee/1000),0) as t_kiosk_stock,
coalesce((t_florist_stock / ewr.ee/1000),0) as t_florist_stock,
coalesce((t_fahrrad_stock / ewr.ee/1000),0) as t_fahrrad_stock,
coalesce((t_kosmetik_und_beauty_stock / ewr.ee/1000),0) as t_kosmetik_und_beauty_stock,
coalesce((t_optiker_stock / ewr.ee/1000),0) as t_optiker_stock,
coalesce((t_schuhe_stock / ewr.ee/1000),0) as t_schuhe_stock,
coalesce((t_buecher_stock / ewr.ee/1000),0) as t_buecher_stock,
coalesce((t_massage_stock / ewr.ee/1000),0) as t_massage_stock,
coalesce((t_schmuck_stock / ewr.ee/1000),0) as t_schmuck_stock,
coalesce((t_autoreperatur_stock / ewr.ee/1000),0) as t_autoreperatur_stock,
coalesce((t_drogerie_stock / ewr.ee/1000),0) as t_drogerie_stock,
coalesce((t_reisen_stock / ewr.ee/1000),0) as t_reisen_stock,
coalesce((t_mobilfunk_stock / ewr.ee/1000),0) as t_mobilfunk_stock,
coalesce((t_moebel_stock / ewr.ee/1000),0) as t_moebel_stock,
coalesce((t_getraenke_stock / ewr.ee/1000),0) as t_getraenke_stock,
coalesce((t_feinkost_stock / ewr.ee/1000),0) as t_feinkost_stock,
coalesce((t_elektronik_stock / ewr.ee/1000),0) as t_elektronik_stock,
coalesce((t_boutique_stock / ewr.ee/1000),0) as t_boutique_stock,
coalesce((t_autohaus_stock / ewr.ee/1000),0) as t_autohaus_stock,
coalesce((t_spirituosen_stock / ewr.ee/1000),0) as t_spirituosen_stock,
coalesce((t_geschenke_stock / ewr.ee/1000),0) as t_geschenke_stock,
coalesce((t_postenmarkt_stock / ewr.ee/1000),0) as t_postenmarkt_stock,
coalesce((t_schlachter_stock / ewr.ee/1000),0) as t_schlachter_stock,
coalesce((t_waescherei_stock / ewr.ee/1000),0) as t_waescherei_stock,
coalesce((t_computer_stock / ewr.ee/1000),0) as t_computer_stock,
coalesce((t_spielzeug_stock / ewr.ee/1000),0) as t_spielzeug_stock,
coalesce((t_copyshop_stock / ewr.ee/1000),0) as t_copyshop_stock,
coalesce((t_schneider_stock / ewr.ee/1000),0) as t_schneider_stock,
coalesce((t_foto_stock / ewr.ee/1000),0) as t_foto_stock,
coalesce((t_kunst_stock / ewr.ee/1000),0) as t_kunst_stock,
coalesce((t_suessigkeiten_stock / ewr.ee/1000),0) as t_suessigkeiten_stock,
coalesce((t_dekoration_stock / ewr.ee/1000),0) as t_dekoration_stock,
coalesce((t_reinigung_stock / ewr.ee/1000),0) as t_reinigung_stock,
coalesce((t_beerdigung_stock / ewr.ee/1000),0) as t_beerdigung_stock,
coalesce((t_sport_stock / ewr.ee/1000),0) as t_sport_stock,
coalesce((t_zoofachgeschaeft_stock / ewr.ee/1000),0) as t_zoofachgeschaeft_stock,
coalesce((t_textilgeschaeft_stock / ewr.ee/1000),0) as t_textilgeschaeft_stock,
coalesce((t_hoergeraete_stock / ewr.ee/1000),0) as t_hoergeraete_stock,
coalesce((t_baumarkt_stock / ewr.ee/1000),0) as t_baumarkt_stock,
coalesce((t_leerstand_stock / ewr.ee/1000),0) as t_leerstand_stock,
coalesce((t_medical_stock / ewr.ee/1000),0) as t_medical_stock,
coalesce((t_second_hand_stock / ewr.ee/1000),0) as t_second_hand_stock,
coalesce((t_zeitung_stock / ewr.ee/1000),0) as t_zeitung_stock,
coalesce((t_eisenwarenhandlung_stock / ewr.ee/1000),0) as t_eisenwarenhandlung_stock,
coalesce((t_sonstiger_shop_stock / ewr.ee/1000),0) as t_sonstiger_shop_stock,
coalesce((t_baudenkmal_stock / ewr.ee/1000),0) as t_baudenkmal_stock,
coalesce((t_haltestelle_stock / ewr.ee/1000),0) as t_haltestelle_stock,
coalesce((t_sonstiges_gebaeude_stock / ewr.ee/1000),0) as t_sonstiges_gebaeude_stock,
coalesce((t_sonstiges_gelaende_stock / ewr.ee/1000),0) as t_sonstiges_gelaende_stock,
coalesce((t_sonstiges_denkmal_stock / ewr.ee/1000),0) as t_sonstiges_denkmal_stock,
coalesce((t_sonstiges_tourismus_stock / ewr.ee/1000),0) as t_sonstiges_tourismus_stock,
coalesce((t_sonstiges_sport_stock / ewr.ee/1000),0) as t_sonstiges_sport_stock,
coalesce((t_sonstiges_erholung_stock / ewr.ee/1000),0) as t_sonstiges_erholung_stock



  
from lor_ewr_einwohnergewichtet_bzr ewr 
join lor_mss_idx_bzr_idx mss 
on ewr.zeit = mss.zeit 
and cast(ewr.planungsraum as int) = mss.raum_id

left join 
(select 
  planungsraum,
  201612 as timeslice,

t_hostel_stock,
t_hotel_stock,
t_sonstige_stock,
t_kunstwerk_stock,
t_kunstzentrum_stock,
t_gallerie_stock,
t_info_stock,
t_museum_stock,
t_aussichtspunkt_stock,
t_zoo_stock,
t_schwimmen_stock,
t_basketball_stock,
t_fussball_stock,
t_sportzentrum_stock,
t_tischtennis_stock,
t_sauna_stock,
t_tennis_stock,
t_kampfsport_stock,
t_fitnesszentrum_stock,
t_spielplatz_stock,
t_wassersport_stock,
t_spielothek_stock,
t_sonstige_sportarten_stock,
t_kindergarten_stock,
t_buero_stock,
t_tankstelle_stock,
t_coworking_space_stock,
t_universitaet_stock,
t_poilzei_stock,
t_feuerwehr_stock,
t_kita_stock,
t_hoehere_schule_stock,
t_wochenmarkt_stock,
t_kino_stock,
t_biergarten_stock,
t_autovermietung_stock,
t_buecherei_stock,
t_nachbarschaftszentrum_stock,
t_theater_stock,
t_eisdiele_stock,
t_nachtclub_stock,
t_kirche_stock,
t_moschee_stock,
t_sonstige_tempel_stock,
t_schule_stock,
t_bordell_stock,
t_post_filiale_stock,
t_sozialeinrichtung_stock,
t_ladestation_stock,
t_zahnarzt_stock,
t_fahrradverleih_stock,
t_fahrschule_stock,
t_tierarzt_stock,
t_botschaft_stock,
t_taxistand_stock,
t_wc_stock,
t_bankfiliale_stock,
t_arzt_stock,
t_parkplatz_stock,
t_bar_stock,
t_apotheke_stock,
t_pub_stock,
t_telefon_stock,
t_kaffee_stock,
t_sonstige_cafes_stock,
t_fahrrad_parkplatz_stock,
t_muelleimer_stock,
t_parkbank_stock,
t_krankenhaus_stock,
t_klinik_stock,
t_geldautomat_stock,
t_briefkasten_stock,
t_friedhof_stock,
t_musikschule_stock,
t_paketautomat_stock,
t_sonstige_automaten_stock,
t_fahrscheinautomat_stock,
t_parkticketautomat_stock,
t_kotbeutelautomat_stock,
t_zigarettenautomat_stock,
t_suessigkeitenautomat_stock,
t_briefmarkenautomat_stock,
t_kondomautomat_stock,
t_getraenke_und_suessigkeitenautomat_stock,
t_getraenkeautomat_stock,
t_grillplatz_stock,
t_glascontainer_stock,
t_glas__und_kleidungscontainer_stock,
t_kleidungscontainer_stock,
t_sonstige_container_stock,
t_restaurant_italiener_stock,
t_restaurant_deutsch_stock,
t_restaurant_indisch_stock,
t_restaurant_asiatisch_stock,
t_restaurant_sushi_stock,
t_restaurant_griechisch_stock,
t_restaurant_steakhouse_stock,
t_restaurant_international_stock,
t_restaurant_tuerkisch_stock,
t_fastfood_kebap_stock,
t_fastfood_burger_stock,
t_fastfood_asiatisch_stock,
t_fastfood_pizza_stock,
t_fastfood_pommesbude_stock,
t_fast_food_sonstiges_stock,
t_restaurant_sonstiges_stock,
t_friseur_stock,
t_baeckerei_stock,
t_kleidung_stock,
t_supermarkt_stock,
t_kiosk_stock,
t_florist_stock,
t_fahrrad_stock,
t_kosmetik_und_beauty_stock,
t_optiker_stock,
t_schuhe_stock,
t_buecher_stock,
t_massage_stock,
t_schmuck_stock,
t_autoreperatur_stock,
t_drogerie_stock,
t_reisen_stock,
t_mobilfunk_stock,
t_moebel_stock,
t_getraenke_stock,
t_feinkost_stock,
t_elektronik_stock,
t_boutique_stock,
t_autohaus_stock,
t_spirituosen_stock,
t_geschenke_stock,
t_postenmarkt_stock,
t_schlachter_stock,
t_waescherei_stock,
t_computer_stock,
t_spielzeug_stock,
t_copyshop_stock,
t_schneider_stock,
t_foto_stock,
t_kunst_stock,
t_suessigkeiten_stock,
t_dekoration_stock,
t_reinigung_stock,
t_beerdigung_stock,
t_sport_stock,
t_zoofachgeschaeft_stock,
t_textilgeschaeft_stock,
t_hoergeraete_stock,
t_baumarkt_stock,
t_leerstand_stock,
t_medical_stock,
t_second_hand_stock,
t_zeitung_stock,
t_eisenwarenhandlung_stock,
t_sonstiger_shop_stock,
t_baudenkmal_stock,
t_haltestelle_stock,
t_sonstiges_gebaeude_stock,
t_sonstiges_gelaende_stock,
t_sonstiges_denkmal_stock,
t_sonstiges_tourismus_stock,
t_sonstiges_sport_stock,
t_sonstiges_erholung_stock

  
  from osm_poi_features_type_piv_distcalc_bzr
  where timeslice in (201701) 
) stock_t
on ewr.zeit = stock_t.timeslice
and cast(ewr.planungsraum as int) = cast(stock_t.planungsraum as int)
left join
(select
  planungsraum,
  201612 as timeslice,

SUM(t_hostel_ytd) as t_hostel_ytd,
SUM(t_hotel_ytd) as t_hotel_ytd,
SUM(t_sonstige_ytd) as t_sonstige_ytd,
SUM(t_kunstwerk_ytd) as t_kunstwerk_ytd,
SUM(t_kunstzentrum_ytd) as t_kunstzentrum_ytd,
SUM(t_gallerie_ytd) as t_gallerie_ytd,
SUM(t_info_ytd) as t_info_ytd,
SUM(t_museum_ytd) as t_museum_ytd,
SUM(t_aussichtspunkt_ytd) as t_aussichtspunkt_ytd,
SUM(t_zoo_ytd) as t_zoo_ytd,
SUM(t_schwimmen_ytd) as t_schwimmen_ytd,
SUM(t_basketball_ytd) as t_basketball_ytd,
SUM(t_fussball_ytd) as t_fussball_ytd,
SUM(t_sportzentrum_ytd) as t_sportzentrum_ytd,
SUM(t_tischtennis_ytd) as t_tischtennis_ytd,
SUM(t_sauna_ytd) as t_sauna_ytd,
SUM(t_tennis_ytd) as t_tennis_ytd,
SUM(t_kampfsport_ytd) as t_kampfsport_ytd,
SUM(t_fitnesszentrum_ytd) as t_fitnesszentrum_ytd,
SUM(t_spielplatz_ytd) as t_spielplatz_ytd,
SUM(t_wassersport_ytd) as t_wassersport_ytd,
SUM(t_spielothek_ytd) as t_spielothek_ytd,
SUM(t_sonstige_sportarten_ytd) as t_sonstige_sportarten_ytd,
SUM(t_kindergarten_ytd) as t_kindergarten_ytd,
SUM(t_buero_ytd) as t_buero_ytd,
SUM(t_tankstelle_ytd) as t_tankstelle_ytd,
SUM(t_coworking_space_ytd) as t_coworking_space_ytd,
SUM(t_universitaet_ytd) as t_universitaet_ytd,
SUM(t_poilzei_ytd) as t_poilzei_ytd,
SUM(t_feuerwehr_ytd) as t_feuerwehr_ytd,
SUM(t_kita_ytd) as t_kita_ytd,
SUM(t_hoehere_schule_ytd) as t_hoehere_schule_ytd,
SUM(t_wochenmarkt_ytd) as t_wochenmarkt_ytd,
SUM(t_kino_ytd) as t_kino_ytd,
SUM(t_biergarten_ytd) as t_biergarten_ytd,
SUM(t_autovermietung_ytd) as t_autovermietung_ytd,
SUM(t_buecherei_ytd) as t_buecherei_ytd,
SUM(t_nachbarschaftszentrum_ytd) as t_nachbarschaftszentrum_ytd,
SUM(t_theater_ytd) as t_theater_ytd,
SUM(t_eisdiele_ytd) as t_eisdiele_ytd,
SUM(t_nachtclub_ytd) as t_nachtclub_ytd,
SUM(t_kirche_ytd) as t_kirche_ytd,
SUM(t_moschee_ytd) as t_moschee_ytd,
SUM(t_sonstige_tempel_ytd) as t_sonstige_tempel_ytd,
SUM(t_schule_ytd) as t_schule_ytd,
SUM(t_bordell_ytd) as t_bordell_ytd,
SUM(t_post_filiale_ytd) as t_post_filiale_ytd,
SUM(t_sozialeinrichtung_ytd) as t_sozialeinrichtung_ytd,
SUM(t_ladestation_ytd) as t_ladestation_ytd,
SUM(t_zahnarzt_ytd) as t_zahnarzt_ytd,
SUM(t_fahrradverleih_ytd) as t_fahrradverleih_ytd,
SUM(t_fahrschule_ytd) as t_fahrschule_ytd,
SUM(t_tierarzt_ytd) as t_tierarzt_ytd,
SUM(t_botschaft_ytd) as t_botschaft_ytd,
SUM(t_taxistand_ytd) as t_taxistand_ytd,
SUM(t_wc_ytd) as t_wc_ytd,
SUM(t_bankfiliale_ytd) as t_bankfiliale_ytd,
SUM(t_arzt_ytd) as t_arzt_ytd,
SUM(t_parkplatz_ytd) as t_parkplatz_ytd,
SUM(t_bar_ytd) as t_bar_ytd,
SUM(t_apotheke_ytd) as t_apotheke_ytd,
SUM(t_pub_ytd) as t_pub_ytd,
SUM(t_telefon_ytd) as t_telefon_ytd,
SUM(t_kaffee_ytd) as t_kaffee_ytd,
SUM(t_sonstige_cafes_ytd) as t_sonstige_cafes_ytd,
SUM(t_fahrrad_parkplatz_ytd) as t_fahrrad_parkplatz_ytd,
SUM(t_muelleimer_ytd) as t_muelleimer_ytd,
SUM(t_parkbank_ytd) as t_parkbank_ytd,
SUM(t_krankenhaus_ytd) as t_krankenhaus_ytd,
SUM(t_klinik_ytd) as t_klinik_ytd,
SUM(t_geldautomat_ytd) as t_geldautomat_ytd,
SUM(t_briefkasten_ytd) as t_briefkasten_ytd,
SUM(t_friedhof_ytd) as t_friedhof_ytd,
SUM(t_musikschule_ytd) as t_musikschule_ytd,
SUM(t_paketautomat_ytd) as t_paketautomat_ytd,
SUM(t_sonstige_automaten_ytd) as t_sonstige_automaten_ytd,
SUM(t_fahrscheinautomat_ytd) as t_fahrscheinautomat_ytd,
SUM(t_parkticketautomat_ytd) as t_parkticketautomat_ytd,
SUM(t_kotbeutelautomat_ytd) as t_kotbeutelautomat_ytd,
SUM(t_zigarettenautomat_ytd) as t_zigarettenautomat_ytd,
SUM(t_suessigkeitenautomat_ytd) as t_suessigkeitenautomat_ytd,
SUM(t_briefmarkenautomat_ytd) as t_briefmarkenautomat_ytd,
SUM(t_kondomautomat_ytd) as t_kondomautomat_ytd,
SUM(t_getraenke_und_suessigkeitenautomat_ytd) as t_getraenke_und_suessigkeitenautomat_ytd,
SUM(t_getraenkeautomat_ytd) as t_getraenkeautomat_ytd,
SUM(t_grillplatz_ytd) as t_grillplatz_ytd,
SUM(t_glascontainer_ytd) as t_glascontainer_ytd,
SUM(t_glas__und_kleidungscontainer_ytd) as t_glas__und_kleidungscontainer_ytd,
SUM(t_kleidungscontainer_ytd) as t_kleidungscontainer_ytd,
SUM(t_sonstige_container_ytd) as t_sonstige_container_ytd,
SUM(t_restaurant_italiener_ytd) as t_restaurant_italiener_ytd,
SUM(t_restaurant_deutsch_ytd) as t_restaurant_deutsch_ytd,
SUM(t_restaurant_indisch_ytd) as t_restaurant_indisch_ytd,
SUM(t_restaurant_asiatisch_ytd) as t_restaurant_asiatisch_ytd,
SUM(t_restaurant_sushi_ytd) as t_restaurant_sushi_ytd,
SUM(t_restaurant_griechisch_ytd) as t_restaurant_griechisch_ytd,
SUM(t_restaurant_steakhouse_ytd) as t_restaurant_steakhouse_ytd,
SUM(t_restaurant_international_ytd) as t_restaurant_international_ytd,
SUM(t_restaurant_tuerkisch_ytd) as t_restaurant_tuerkisch_ytd,
SUM(t_fastfood_kebap_ytd) as t_fastfood_kebap_ytd,
SUM(t_fastfood_burger_ytd) as t_fastfood_burger_ytd,
SUM(t_fastfood_asiatisch_ytd) as t_fastfood_asiatisch_ytd,
SUM(t_fastfood_pizza_ytd) as t_fastfood_pizza_ytd,
SUM(t_fastfood_pommesbude_ytd) as t_fastfood_pommesbude_ytd,
SUM(t_fast_food_sonstiges_ytd) as t_fast_food_sonstiges_ytd,
SUM(t_restaurant_sonstiges_ytd) as t_restaurant_sonstiges_ytd,
SUM(t_friseur_ytd) as t_friseur_ytd,
SUM(t_baeckerei_ytd) as t_baeckerei_ytd,
SUM(t_kleidung_ytd) as t_kleidung_ytd,
SUM(t_supermarkt_ytd) as t_supermarkt_ytd,
SUM(t_kiosk_ytd) as t_kiosk_ytd,
SUM(t_florist_ytd) as t_florist_ytd,
SUM(t_fahrrad_ytd) as t_fahrrad_ytd,
SUM(t_kosmetik_und_beauty_ytd) as t_kosmetik_und_beauty_ytd,
SUM(t_optiker_ytd) as t_optiker_ytd,
SUM(t_schuhe_ytd) as t_schuhe_ytd,
SUM(t_buecher_ytd) as t_buecher_ytd,
SUM(t_massage_ytd) as t_massage_ytd,
SUM(t_schmuck_ytd) as t_schmuck_ytd,
SUM(t_autoreperatur_ytd) as t_autoreperatur_ytd,
SUM(t_drogerie_ytd) as t_drogerie_ytd,
SUM(t_reisen_ytd) as t_reisen_ytd,
SUM(t_mobilfunk_ytd) as t_mobilfunk_ytd,
SUM(t_moebel_ytd) as t_moebel_ytd,
SUM(t_getraenke_ytd) as t_getraenke_ytd,
SUM(t_feinkost_ytd) as t_feinkost_ytd,
SUM(t_elektronik_ytd) as t_elektronik_ytd,
SUM(t_boutique_ytd) as t_boutique_ytd,
SUM(t_autohaus_ytd) as t_autohaus_ytd,
SUM(t_spirituosen_ytd) as t_spirituosen_ytd,
SUM(t_geschenke_ytd) as t_geschenke_ytd,
SUM(t_postenmarkt_ytd) as t_postenmarkt_ytd,
SUM(t_schlachter_ytd) as t_schlachter_ytd,
SUM(t_waescherei_ytd) as t_waescherei_ytd,
SUM(t_computer_ytd) as t_computer_ytd,
SUM(t_spielzeug_ytd) as t_spielzeug_ytd,
SUM(t_copyshop_ytd) as t_copyshop_ytd,
SUM(t_schneider_ytd) as t_schneider_ytd,
SUM(t_foto_ytd) as t_foto_ytd,
SUM(t_kunst_ytd) as t_kunst_ytd,
SUM(t_suessigkeiten_ytd) as t_suessigkeiten_ytd,
SUM(t_dekoration_ytd) as t_dekoration_ytd,
SUM(t_reinigung_ytd) as t_reinigung_ytd,
SUM(t_beerdigung_ytd) as t_beerdigung_ytd,
SUM(t_sport_ytd) as t_sport_ytd,
SUM(t_zoofachgeschaeft_ytd) as t_zoofachgeschaeft_ytd,
SUM(t_textilgeschaeft_ytd) as t_textilgeschaeft_ytd,
SUM(t_hoergeraete_ytd) as t_hoergeraete_ytd,
SUM(t_baumarkt_ytd) as t_baumarkt_ytd,
SUM(t_leerstand_ytd) as t_leerstand_ytd,
SUM(t_medical_ytd) as t_medical_ytd,
SUM(t_second_hand_ytd) as t_second_hand_ytd,
SUM(t_zeitung_ytd) as t_zeitung_ytd,
SUM(t_eisenwarenhandlung_ytd) as t_eisenwarenhandlung_ytd,
SUM(t_sonstiger_shop_ytd) as t_sonstiger_shop_ytd,
SUM(t_baudenkmal_ytd) as t_baudenkmal_ytd,
SUM(t_haltestelle_ytd) as t_haltestelle_ytd,
SUM(t_sonstiges_gebaeude_ytd) as t_sonstiges_gebaeude_ytd,
SUM(t_sonstiges_gelaende_ytd) as t_sonstiges_gelaende_ytd,
SUM(t_sonstiges_denkmal_ytd) as t_sonstiges_denkmal_ytd,
SUM(t_sonstiges_tourismus_ytd) as t_sonstiges_tourismus_ytd,
SUM(t_sonstiges_sport_ytd) as t_sonstiges_sport_ytd,
SUM(t_sonstiges_erholung_ytd) as t_sonstiges_erholung_ytd

  
  from osm_poi_features_type_piv_distcalc_bzr
  where timeslice in (201601, 201701)
  group by planungsraum
) dyn_t
on ewr.zeit = dyn_t.timeslice
and cast(ewr.planungsraum as int) = cast(dyn_t.planungsraum as int)


left join 
(select 
  planungsraum,
  201612 as timeslice,

c_uebernachtung_stock,
c_sehenswuerdigkeit_stock,
c_kultur_stock,
c_info_stock,
c_sport_stock,
c_erholung_stock,
c_zwielicht_stock,
c_bildung_stock,
c_buero_stock,
c_individual_stock,
c_hipster_stock,
c_sicherheit_stock,
c_sonstiges_stock,
c_ausgehen_stock,
c_gaststaetten_stock,
c_sozial_stock,
c_cafe_stock,
c_religioese_gebaeude_stock,
c_post_stock,
c_gesundheit_stock,
c_wc_stock,
c_bank_stock,
c_telefon_stock,
c_recycling_stock,
c_parkbank_stock,
c_briefe_und_pakete_stock,
c_friedhof_stock,
c_automaten_stock,
c_oepnv_stock,
c_restaurant_stock,
c_fast_food_stock,
c_friseur_stock,
c_essen_und_trinken_stock,
c_kleidung_stock,
c_sonstige_waren_stock,
c_werkstatt_stock,
c_kosmetik_und_beauty_stock,
c_medical_stock,
c_print_stock,
c_massage_stock,
c_drogerie_stock,
c_reisen_stock,
c_technik_stock,
c_spielzeug_und_geschenke_stock,
c_waescherei_stock,
c_kunst_stock,
c_beerdigung_stock,
c_handwerk_stock,
c_leerstand_stock,
c_sonstiger_shop_stock,
c_sonstiges_gebaeude_stock,
c_sonstiges_gelaende_stock,
c_sonstiges_tourismus_stock
  
  from osm_poi_features_category_piv_distcalc_bzr
  where timeslice in (201701) 
) stock_c
on ewr.zeit = stock_c.timeslice
and cast(ewr.planungsraum as int) = cast(stock_c.planungsraum as int)
left join
(select
  planungsraum,
  201612 as timeslice,

SUM(c_uebernachtung_ytd) as c_uebernachtung_ytd,
SUM(c_sehenswuerdigkeit_ytd) as c_sehenswuerdigkeit_ytd,
SUM(c_kultur_ytd) as c_kultur_ytd,
SUM(c_info_ytd) as c_info_ytd,
SUM(c_sport_ytd) as c_sport_ytd,
SUM(c_erholung_ytd) as c_erholung_ytd,
SUM(c_zwielicht_ytd) as c_zwielicht_ytd,
SUM(c_bildung_ytd) as c_bildung_ytd,
SUM(c_buero_ytd) as c_buero_ytd,
SUM(c_individual_ytd) as c_individual_ytd,
SUM(c_hipster_ytd) as c_hipster_ytd,
SUM(c_sicherheit_ytd) as c_sicherheit_ytd,
SUM(c_sonstiges_ytd) as c_sonstiges_ytd,
SUM(c_ausgehen_ytd) as c_ausgehen_ytd,
SUM(c_gaststaetten_ytd) as c_gaststaetten_ytd,
SUM(c_sozial_ytd) as c_sozial_ytd,
SUM(c_cafe_ytd) as c_cafe_ytd,
SUM(c_religioese_gebaeude_ytd) as c_religioese_gebaeude_ytd,
SUM(c_post_ytd) as c_post_ytd,
SUM(c_gesundheit_ytd) as c_gesundheit_ytd,
SUM(c_wc_ytd) as c_wc_ytd,
SUM(c_bank_ytd) as c_bank_ytd,
SUM(c_telefon_ytd) as c_telefon_ytd,
SUM(c_recycling_ytd) as c_recycling_ytd,
SUM(c_parkbank_ytd) as c_parkbank_ytd,
SUM(c_briefe_und_pakete_ytd) as c_briefe_und_pakete_ytd,
SUM(c_friedhof_ytd) as c_friedhof_ytd,
SUM(c_automaten_ytd) as c_automaten_ytd,
SUM(c_oepnv_ytd) as c_oepnv_ytd,
SUM(c_restaurant_ytd) as c_restaurant_ytd,
SUM(c_fast_food_ytd) as c_fast_food_ytd,
SUM(c_friseur_ytd) as c_friseur_ytd,
SUM(c_essen_und_trinken_ytd) as c_essen_und_trinken_ytd,
SUM(c_kleidung_ytd) as c_kleidung_ytd,
SUM(c_sonstige_waren_ytd) as c_sonstige_waren_ytd,
SUM(c_werkstatt_ytd) as c_werkstatt_ytd,
SUM(c_kosmetik_und_beauty_ytd) as c_kosmetik_und_beauty_ytd,
SUM(c_medical_ytd) as c_medical_ytd,
SUM(c_print_ytd) as c_print_ytd,
SUM(c_massage_ytd) as c_massage_ytd,
SUM(c_drogerie_ytd) as c_drogerie_ytd,
SUM(c_reisen_ytd) as c_reisen_ytd,
SUM(c_technik_ytd) as c_technik_ytd,
SUM(c_spielzeug_und_geschenke_ytd) as c_spielzeug_und_geschenke_ytd,
SUM(c_waescherei_ytd) as c_waescherei_ytd,
SUM(c_kunst_ytd) as c_kunst_ytd,
SUM(c_beerdigung_ytd) as c_beerdigung_ytd,
SUM(c_handwerk_ytd) as c_handwerk_ytd,
SUM(c_leerstand_ytd) as c_leerstand_ytd,
SUM(c_sonstiger_shop_ytd) as c_sonstiger_shop_ytd,
SUM(c_sonstiges_gebaeude_ytd) as c_sonstiges_gebaeude_ytd,
SUM(c_sonstiges_gelaende_ytd) as c_sonstiges_gelaende_ytd,
SUM(c_sonstiges_tourismus_ytd) as c_sonstiges_tourismus_ytd

  
  from osm_poi_features_category_piv_distcalc_bzr
  where timeslice in (201601, 201701)
  group by planungsraum
) dyn_c
on ewr.zeit = dyn_c.timeslice
and cast(ewr.planungsraum as int) = cast(dyn_c.planungsraum as int)

left join 
(select 
  planungsraum,
  201612 as timeslice,
  d_tourismus_stock,
  d_vergnuegung_stock,
  d_sport_und_erholung_stock,
  d_public_service_stock,
  d_buero_stock,
  d_mobilitaet_stock,
  d_sonstiges_stock,
  d_gastronomie_stock,
  d_religion_stock,
  d_oeffentlicher_raum_stock,
  d_dienstleistung_stock,
  d_waren_stock,
  d_leerstand_stock
  from osm_poi_features_domain_piv_distcalc_bzr
  where timeslice in (201701) 
) stock_d
on ewr.zeit = stock_d.timeslice
and cast(ewr.planungsraum as int) = cast(stock_d.planungsraum as int)
left join
(select
  planungsraum,
  201612 as timeslice,
  SUM(d_tourismus_ytd) as d_tourismus_ytd,
  SUM(d_vergnuegung_ytd) as d_vergnuegung_ytd,
  SUM(d_sport_und_erholung_ytd) as d_sport_und_erholung_ytd,
  SUM(d_public_service_ytd) as d_public_service_ytd,
  SUM(d_buero_ytd) as d_buero_ytd,
  SUM(d_mobilitaet_ytd) as d_mobilitaet_ytd,
  SUM(d_sonstiges_ytd) as d_sonstiges_ytd,
  SUM(d_gastronomie_ytd) as d_gastronomie_ytd,
  SUM(d_religion_ytd) as d_religion_ytd,
  SUM(d_oeffentlicher_raum_ytd) as d_oeffentlicher_raum_ytd,
  SUM(d_dienstleistung_ytd) as d_dienstleistung_ytd,
  SUM(d_waren_ytd) as d_waren_ytd,
  SUM(d_leerstand_ytd) as d_leerstand_ytd
  from osm_poi_features_domain_piv_distcalc_bzr
  where timeslice in (201601, 201701)
  group by planungsraum
) dyn_d
on ewr.zeit = dyn_d.timeslice
and cast(ewr.planungsraum as int) = cast(dyn_d.planungsraum as int)



where ewr.zeit = 201612


union all

select 
case 
when mss.status_index > 0.5 then "niedrig"
when mss.status_index < -0.5 then "hoch"
else "stabil"
end as status_klasse_prj,
case 
when mss.dynamik_index > 0.5 then "negativ"
when mss.dynamik_index < -0.5 then "positiv"
else "neutral"
end as dynamik_klasse_prj,
case 
when mss.status_index > 0 then "niedrig"
when mss.status_index <= 0 then "hoch"
else "stabil"
end as status_klasse_prj_bi,
case 
when mss.dynamik_index > 0 then "negativ"
when mss.dynamik_index <= 0 then "positiv"
else "neutral"
end as dynamik_klasse_prj_bi,
ewr.*, 
mss.* , 

coalesce((d_tourismus_stock / (ewr.ee/1000)),0) as d_tourismus_stock,
coalesce((d_vergnuegung_stock / (ewr.ee/1000)),0) as d_vergnuegung_stock,
coalesce((d_sport_und_erholung_stock / (ewr.ee/1000)),0) as d_sport_und_erholung_stock,
coalesce((d_public_service_stock / (ewr.ee/1000)),0) as d_public_service_stock,
coalesce((d_buero_stock / (ewr.ee/1000)),0) as d_buero_stock,
coalesce((d_mobilitaet_stock / (ewr.ee/1000)),0) as d_mobilitaet_stock,
coalesce((d_sonstiges_stock / (ewr.ee/1000)),0) as d_sonstiges_stock,
coalesce((d_gastronomie_stock / (ewr.ee/1000)),0) as d_gastronomie_stock,
coalesce((d_religion_stock / (ewr.ee/1000)),0) as d_religion_stock,
coalesce((d_oeffentlicher_raum_stock / (ewr.ee/1000)),0) as d_oeffentlicher_raum_stock,
coalesce((d_dienstleistung_stock / (ewr.ee/1000)),0) as d_dienstleistung_stock,
coalesce((d_waren_stock / (ewr.ee/1000)),0) as d_waren_stock,
coalesce((d_leerstand_stock / (ewr.ee/1000)),0) as d_leerstand_stock,
coalesce((d_tourismus_ytd / (ewr.ee/1000)),0) as d_tourismus_ytd,
coalesce((d_vergnuegung_ytd / (ewr.ee/1000)),0) as d_vergnuegung_ytd,
coalesce((d_sport_und_erholung_ytd / (ewr.ee/1000)),0) as d_sport_und_erholung_ytd,
coalesce((d_public_service_ytd / (ewr.ee/1000)),0) as d_public_service_ytd,
coalesce((d_buero_ytd / (ewr.ee/1000)),0) as d_buero_ytd,
coalesce((d_mobilitaet_ytd / (ewr.ee/1000)),0) as d_mobilitaet_ytd,
coalesce((d_sonstiges_ytd / (ewr.ee/1000)),0) as d_sonstiges_ytd,
coalesce((d_gastronomie_ytd / (ewr.ee/1000)),0) as d_gastronomie_ytd,
coalesce((d_religion_ytd / (ewr.ee/1000)),0) as d_religion_ytd,
coalesce((d_oeffentlicher_raum_ytd / (ewr.ee/1000)),0) as d_oeffentlicher_raum_ytd,
coalesce((d_dienstleistung_ytd / (ewr.ee/1000)),0) as d_dienstleistung_ytd,
coalesce((d_waren_ytd / (ewr.ee/1000)),0) as d_waren_ytd,
coalesce((d_leerstand_ytd / (ewr.ee/1000)),0) as d_leerstand_ytd,

coalesce((c_uebernachtung_ytd / ewr.ee/1000),0) as c_uebernachtung_ytd,
coalesce((c_sehenswuerdigkeit_ytd / ewr.ee/1000),0) as c_sehenswuerdigkeit_ytd,
coalesce((c_kultur_ytd / ewr.ee/1000),0) as c_kultur_ytd,
coalesce((c_info_ytd / ewr.ee/1000),0) as c_info_ytd,
coalesce((c_sport_ytd / ewr.ee/1000),0) as c_sport_ytd,
coalesce((c_erholung_ytd / ewr.ee/1000),0) as c_erholung_ytd,
coalesce((c_zwielicht_ytd / ewr.ee/1000),0) as c_zwielicht_ytd,
coalesce((c_bildung_ytd / ewr.ee/1000),0) as c_bildung_ytd,
coalesce((c_buero_ytd / ewr.ee/1000),0) as c_buero_ytd,
coalesce((c_individual_ytd / ewr.ee/1000),0) as c_individual_ytd,
coalesce((c_hipster_ytd / ewr.ee/1000),0) as c_hipster_ytd,
coalesce((c_sicherheit_ytd / ewr.ee/1000),0) as c_sicherheit_ytd,
coalesce((c_sonstiges_ytd / ewr.ee/1000),0) as c_sonstiges_ytd,
coalesce((c_ausgehen_ytd / ewr.ee/1000),0) as c_ausgehen_ytd,
coalesce((c_gaststaetten_ytd / ewr.ee/1000),0) as c_gaststaetten_ytd,
coalesce((c_sozial_ytd / ewr.ee/1000),0) as c_sozial_ytd,
coalesce((c_cafe_ytd / ewr.ee/1000),0) as c_cafe_ytd,
coalesce((c_religioese_gebaeude_ytd / ewr.ee/1000),0) as c_religioese_gebaeude_ytd,
coalesce((c_post_ytd / ewr.ee/1000),0) as c_post_ytd,
coalesce((c_gesundheit_ytd / ewr.ee/1000),0) as c_gesundheit_ytd,
coalesce((c_wc_ytd / ewr.ee/1000),0) as c_wc_ytd,
coalesce((c_bank_ytd / ewr.ee/1000),0) as c_bank_ytd,
coalesce((c_telefon_ytd / ewr.ee/1000),0) as c_telefon_ytd,
coalesce((c_recycling_ytd / ewr.ee/1000),0) as c_recycling_ytd,
coalesce((c_parkbank_ytd / ewr.ee/1000),0) as c_parkbank_ytd,
coalesce((c_briefe_und_pakete_ytd / ewr.ee/1000),0) as c_briefe_und_pakete_ytd,
coalesce((c_friedhof_ytd / ewr.ee/1000),0) as c_friedhof_ytd,
coalesce((c_automaten_ytd / ewr.ee/1000),0) as c_automaten_ytd,
coalesce((c_oepnv_ytd / ewr.ee/1000),0) as c_oepnv_ytd,
coalesce((c_restaurant_ytd / ewr.ee/1000),0) as c_restaurant_ytd,
coalesce((c_fast_food_ytd / ewr.ee/1000),0) as c_fast_food_ytd,
coalesce((c_friseur_ytd / ewr.ee/1000),0) as c_friseur_ytd,
coalesce((c_essen_und_trinken_ytd / ewr.ee/1000),0) as c_essen_und_trinken_ytd,
coalesce((c_kleidung_ytd / ewr.ee/1000),0) as c_kleidung_ytd,
coalesce((c_sonstige_waren_ytd / ewr.ee/1000),0) as c_sonstige_waren_ytd,
coalesce((c_werkstatt_ytd / ewr.ee/1000),0) as c_werkstatt_ytd,
coalesce((c_kosmetik_und_beauty_ytd / ewr.ee/1000),0) as c_kosmetik_und_beauty_ytd,
coalesce((c_medical_ytd / ewr.ee/1000),0) as c_medical_ytd,
coalesce((c_print_ytd / ewr.ee/1000),0) as c_print_ytd,
coalesce((c_massage_ytd / ewr.ee/1000),0) as c_massage_ytd,
coalesce((c_drogerie_ytd / ewr.ee/1000),0) as c_drogerie_ytd,
coalesce((c_reisen_ytd / ewr.ee/1000),0) as c_reisen_ytd,
coalesce((c_technik_ytd / ewr.ee/1000),0) as c_technik_ytd,
coalesce((c_spielzeug_und_geschenke_ytd / ewr.ee/1000),0) as c_spielzeug_und_geschenke_ytd,
coalesce((c_waescherei_ytd / ewr.ee/1000),0) as c_waescherei_ytd,
coalesce((c_kunst_ytd / ewr.ee/1000),0) as c_kunst_ytd,
coalesce((c_beerdigung_ytd / ewr.ee/1000),0) as c_beerdigung_ytd,
coalesce((c_handwerk_ytd / ewr.ee/1000),0) as c_handwerk_ytd,
coalesce((c_leerstand_ytd / ewr.ee/1000),0) as c_leerstand_ytd,
coalesce((c_sonstiger_shop_ytd / ewr.ee/1000),0) as c_sonstiger_shop_ytd,
coalesce((c_sonstiges_gebaeude_ytd / ewr.ee/1000),0) as c_sonstiges_gebaeude_ytd,
coalesce((c_sonstiges_gelaende_ytd / ewr.ee/1000),0) as c_sonstiges_gelaende_ytd,
coalesce((c_sonstiges_tourismus_ytd / ewr.ee/1000),0) as c_sonstiges_tourismus_ytd,
coalesce((c_uebernachtung_stock / ewr.ee/1000),0) as c_uebernachtung_stock,
coalesce((c_sehenswuerdigkeit_stock / ewr.ee/1000),0) as c_sehenswuerdigkeit_stock,
coalesce((c_kultur_stock / ewr.ee/1000),0) as c_kultur_stock,
coalesce((c_info_stock / ewr.ee/1000),0) as c_info_stock,
coalesce((c_sport_stock / ewr.ee/1000),0) as c_sport_stock,
coalesce((c_erholung_stock / ewr.ee/1000),0) as c_erholung_stock,
coalesce((c_zwielicht_stock / ewr.ee/1000),0) as c_zwielicht_stock,
coalesce((c_bildung_stock / ewr.ee/1000),0) as c_bildung_stock,
coalesce((c_buero_stock / ewr.ee/1000),0) as c_buero_stock,
coalesce((c_individual_stock / ewr.ee/1000),0) as c_individual_stock,
coalesce((c_hipster_stock / ewr.ee/1000),0) as c_hipster_stock,
coalesce((c_sicherheit_stock / ewr.ee/1000),0) as c_sicherheit_stock,
coalesce((c_sonstiges_stock / ewr.ee/1000),0) as c_sonstiges_stock,
coalesce((c_ausgehen_stock / ewr.ee/1000),0) as c_ausgehen_stock,
coalesce((c_gaststaetten_stock / ewr.ee/1000),0) as c_gaststaetten_stock,
coalesce((c_sozial_stock / ewr.ee/1000),0) as c_sozial_stock,
coalesce((c_cafe_stock / ewr.ee/1000),0) as c_cafe_stock,
coalesce((c_religioese_gebaeude_stock / ewr.ee/1000),0) as c_religioese_gebaeude_stock,
coalesce((c_post_stock / ewr.ee/1000),0) as c_post_stock,
coalesce((c_gesundheit_stock / ewr.ee/1000),0) as c_gesundheit_stock,
coalesce((c_wc_stock / ewr.ee/1000),0) as c_wc_stock,
coalesce((c_bank_stock / ewr.ee/1000),0) as c_bank_stock,
coalesce((c_telefon_stock / ewr.ee/1000),0) as c_telefon_stock,
coalesce((c_recycling_stock / ewr.ee/1000),0) as c_recycling_stock,
coalesce((c_parkbank_stock / ewr.ee/1000),0) as c_parkbank_stock,
coalesce((c_briefe_und_pakete_stock / ewr.ee/1000),0) as c_briefe_und_pakete_stock,
coalesce((c_friedhof_stock / ewr.ee/1000),0) as c_friedhof_stock,
coalesce((c_automaten_stock / ewr.ee/1000),0) as c_automaten_stock,
coalesce((c_oepnv_stock / ewr.ee/1000),0) as c_oepnv_stock,
coalesce((c_restaurant_stock / ewr.ee/1000),0) as c_restaurant_stock,
coalesce((c_fast_food_stock / ewr.ee/1000),0) as c_fast_food_stock,
coalesce((c_friseur_stock / ewr.ee/1000),0) as c_friseur_stock,
coalesce((c_essen_und_trinken_stock / ewr.ee/1000),0) as c_essen_und_trinken_stock,
coalesce((c_kleidung_stock / ewr.ee/1000),0) as c_kleidung_stock,
coalesce((c_sonstige_waren_stock / ewr.ee/1000),0) as c_sonstige_waren_stock,
coalesce((c_werkstatt_stock / ewr.ee/1000),0) as c_werkstatt_stock,
coalesce((c_kosmetik_und_beauty_stock / ewr.ee/1000),0) as c_kosmetik_und_beauty_stock,
coalesce((c_medical_stock / ewr.ee/1000),0) as c_medical_stock,
coalesce((c_print_stock / ewr.ee/1000),0) as c_print_stock,
coalesce((c_massage_stock / ewr.ee/1000),0) as c_massage_stock,
coalesce((c_drogerie_stock / ewr.ee/1000),0) as c_drogerie_stock,
coalesce((c_reisen_stock / ewr.ee/1000),0) as c_reisen_stock,
coalesce((c_technik_stock / ewr.ee/1000),0) as c_technik_stock,
coalesce((c_spielzeug_und_geschenke_stock / ewr.ee/1000),0) as c_spielzeug_und_geschenke_stock,
coalesce((c_waescherei_stock / ewr.ee/1000),0) as c_waescherei_stock,
coalesce((c_kunst_stock / ewr.ee/1000),0) as c_kunst_stock,
coalesce((c_beerdigung_stock / ewr.ee/1000),0) as c_beerdigung_stock,
coalesce((c_handwerk_stock / ewr.ee/1000),0) as c_handwerk_stock,
coalesce((c_leerstand_stock / ewr.ee/1000),0) as c_leerstand_stock,
coalesce((c_sonstiger_shop_stock / ewr.ee/1000),0) as c_sonstiger_shop_stock,
coalesce((c_sonstiges_gebaeude_stock / ewr.ee/1000),0) as c_sonstiges_gebaeude_stock,
coalesce((c_sonstiges_gelaende_stock / ewr.ee/1000),0) as c_sonstiges_gelaende_stock,
coalesce((c_sonstiges_tourismus_stock / ewr.ee/1000),0) as c_sonstiges_tourismus_stock,


coalesce((t_hostel_ytd / ewr.ee/1000),0) as t_hostel_ytd,
coalesce((t_hotel_ytd / ewr.ee/1000),0) as t_hotel_ytd,
coalesce((t_sonstige_ytd / ewr.ee/1000),0) as t_sonstige_ytd,
coalesce((t_kunstwerk_ytd / ewr.ee/1000),0) as t_kunstwerk_ytd,
coalesce((t_kunstzentrum_ytd / ewr.ee/1000),0) as t_kunstzentrum_ytd,
coalesce((t_gallerie_ytd / ewr.ee/1000),0) as t_gallerie_ytd,
coalesce((t_info_ytd / ewr.ee/1000),0) as t_info_ytd,
coalesce((t_museum_ytd / ewr.ee/1000),0) as t_museum_ytd,
coalesce((t_aussichtspunkt_ytd / ewr.ee/1000),0) as t_aussichtspunkt_ytd,
coalesce((t_zoo_ytd / ewr.ee/1000),0) as t_zoo_ytd,
coalesce((t_schwimmen_ytd / ewr.ee/1000),0) as t_schwimmen_ytd,
coalesce((t_basketball_ytd / ewr.ee/1000),0) as t_basketball_ytd,
coalesce((t_fussball_ytd / ewr.ee/1000),0) as t_fussball_ytd,
coalesce((t_sportzentrum_ytd / ewr.ee/1000),0) as t_sportzentrum_ytd,
coalesce((t_tischtennis_ytd / ewr.ee/1000),0) as t_tischtennis_ytd,
coalesce((t_sauna_ytd / ewr.ee/1000),0) as t_sauna_ytd,
coalesce((t_tennis_ytd / ewr.ee/1000),0) as t_tennis_ytd,
coalesce((t_kampfsport_ytd / ewr.ee/1000),0) as t_kampfsport_ytd,
coalesce((t_fitnesszentrum_ytd / ewr.ee/1000),0) as t_fitnesszentrum_ytd,
coalesce((t_spielplatz_ytd / ewr.ee/1000),0) as t_spielplatz_ytd,
coalesce((t_wassersport_ytd / ewr.ee/1000),0) as t_wassersport_ytd,
coalesce((t_spielothek_ytd / ewr.ee/1000),0) as t_spielothek_ytd,
coalesce((t_sonstige_sportarten_ytd / ewr.ee/1000),0) as t_sonstige_sportarten_ytd,
coalesce((t_kindergarten_ytd / ewr.ee/1000),0) as t_kindergarten_ytd,
coalesce((t_buero_ytd / ewr.ee/1000),0) as t_buero_ytd,
coalesce((t_tankstelle_ytd / ewr.ee/1000),0) as t_tankstelle_ytd,
coalesce((t_coworking_space_ytd / ewr.ee/1000),0) as t_coworking_space_ytd,
coalesce((t_universitaet_ytd / ewr.ee/1000),0) as t_universitaet_ytd,
coalesce((t_poilzei_ytd / ewr.ee/1000),0) as t_poilzei_ytd,
coalesce((t_feuerwehr_ytd / ewr.ee/1000),0) as t_feuerwehr_ytd,
coalesce((t_kita_ytd / ewr.ee/1000),0) as t_kita_ytd,
coalesce((t_hoehere_schule_ytd / ewr.ee/1000),0) as t_hoehere_schule_ytd,
coalesce((t_wochenmarkt_ytd / ewr.ee/1000),0) as t_wochenmarkt_ytd,
coalesce((t_kino_ytd / ewr.ee/1000),0) as t_kino_ytd,
coalesce((t_biergarten_ytd / ewr.ee/1000),0) as t_biergarten_ytd,
coalesce((t_autovermietung_ytd / ewr.ee/1000),0) as t_autovermietung_ytd,
coalesce((t_buecherei_ytd / ewr.ee/1000),0) as t_buecherei_ytd,
coalesce((t_nachbarschaftszentrum_ytd / ewr.ee/1000),0) as t_nachbarschaftszentrum_ytd,
coalesce((t_theater_ytd / ewr.ee/1000),0) as t_theater_ytd,
coalesce((t_eisdiele_ytd / ewr.ee/1000),0) as t_eisdiele_ytd,
coalesce((t_nachtclub_ytd / ewr.ee/1000),0) as t_nachtclub_ytd,
coalesce((t_kirche_ytd / ewr.ee/1000),0) as t_kirche_ytd,
coalesce((t_moschee_ytd / ewr.ee/1000),0) as t_moschee_ytd,
coalesce((t_sonstige_tempel_ytd / ewr.ee/1000),0) as t_sonstige_tempel_ytd,
coalesce((t_schule_ytd / ewr.ee/1000),0) as t_schule_ytd,
coalesce((t_bordell_ytd / ewr.ee/1000),0) as t_bordell_ytd,
coalesce((t_post_filiale_ytd / ewr.ee/1000),0) as t_post_filiale_ytd,
coalesce((t_sozialeinrichtung_ytd / ewr.ee/1000),0) as t_sozialeinrichtung_ytd,
coalesce((t_ladestation_ytd / ewr.ee/1000),0) as t_ladestation_ytd,
coalesce((t_zahnarzt_ytd / ewr.ee/1000),0) as t_zahnarzt_ytd,
coalesce((t_fahrradverleih_ytd / ewr.ee/1000),0) as t_fahrradverleih_ytd,
coalesce((t_fahrschule_ytd / ewr.ee/1000),0) as t_fahrschule_ytd,
coalesce((t_tierarzt_ytd / ewr.ee/1000),0) as t_tierarzt_ytd,
coalesce((t_botschaft_ytd / ewr.ee/1000),0) as t_botschaft_ytd,
coalesce((t_taxistand_ytd / ewr.ee/1000),0) as t_taxistand_ytd,
coalesce((t_wc_ytd / ewr.ee/1000),0) as t_wc_ytd,
coalesce((t_bankfiliale_ytd / ewr.ee/1000),0) as t_bankfiliale_ytd,
coalesce((t_arzt_ytd / ewr.ee/1000),0) as t_arzt_ytd,
coalesce((t_parkplatz_ytd / ewr.ee/1000),0) as t_parkplatz_ytd,
coalesce((t_bar_ytd / ewr.ee/1000),0) as t_bar_ytd,
coalesce((t_apotheke_ytd / ewr.ee/1000),0) as t_apotheke_ytd,
coalesce((t_pub_ytd / ewr.ee/1000),0) as t_pub_ytd,
coalesce((t_telefon_ytd / ewr.ee/1000),0) as t_telefon_ytd,
coalesce((t_kaffee_ytd / ewr.ee/1000),0) as t_kaffee_ytd,
coalesce((t_sonstige_cafes_ytd / ewr.ee/1000),0) as t_sonstige_cafes_ytd,
coalesce((t_fahrrad_parkplatz_ytd / ewr.ee/1000),0) as t_fahrrad_parkplatz_ytd,
coalesce((t_muelleimer_ytd / ewr.ee/1000),0) as t_muelleimer_ytd,
coalesce((t_parkbank_ytd / ewr.ee/1000),0) as t_parkbank_ytd,
coalesce((t_krankenhaus_ytd / ewr.ee/1000),0) as t_krankenhaus_ytd,
coalesce((t_klinik_ytd / ewr.ee/1000),0) as t_klinik_ytd,
coalesce((t_geldautomat_ytd / ewr.ee/1000),0) as t_geldautomat_ytd,
coalesce((t_briefkasten_ytd / ewr.ee/1000),0) as t_briefkasten_ytd,
coalesce((t_friedhof_ytd / ewr.ee/1000),0) as t_friedhof_ytd,
coalesce((t_musikschule_ytd / ewr.ee/1000),0) as t_musikschule_ytd,
coalesce((t_paketautomat_ytd / ewr.ee/1000),0) as t_paketautomat_ytd,
coalesce((t_sonstige_automaten_ytd / ewr.ee/1000),0) as t_sonstige_automaten_ytd,
coalesce((t_fahrscheinautomat_ytd / ewr.ee/1000),0) as t_fahrscheinautomat_ytd,
coalesce((t_parkticketautomat_ytd / ewr.ee/1000),0) as t_parkticketautomat_ytd,
coalesce((t_kotbeutelautomat_ytd / ewr.ee/1000),0) as t_kotbeutelautomat_ytd,
coalesce((t_zigarettenautomat_ytd / ewr.ee/1000),0) as t_zigarettenautomat_ytd,
coalesce((t_suessigkeitenautomat_ytd / ewr.ee/1000),0) as t_suessigkeitenautomat_ytd,
coalesce((t_briefmarkenautomat_ytd / ewr.ee/1000),0) as t_briefmarkenautomat_ytd,
coalesce((t_kondomautomat_ytd / ewr.ee/1000),0) as t_kondomautomat_ytd,
coalesce((t_getraenke_und_suessigkeitenautomat_ytd / ewr.ee/1000),0) as t_getraenke_und_suessigkeitenautomat_ytd,
coalesce((t_getraenkeautomat_ytd / ewr.ee/1000),0) as t_getraenkeautomat_ytd,
coalesce((t_grillplatz_ytd / ewr.ee/1000),0) as t_grillplatz_ytd,
coalesce((t_glascontainer_ytd / ewr.ee/1000),0) as t_glascontainer_ytd,
coalesce((t_glas__und_kleidungscontainer_ytd / ewr.ee/1000),0) as t_glas__und_kleidungscontainer_ytd,
coalesce((t_kleidungscontainer_ytd / ewr.ee/1000),0) as t_kleidungscontainer_ytd,
coalesce((t_sonstige_container_ytd / ewr.ee/1000),0) as t_sonstige_container_ytd,
coalesce((t_restaurant_italiener_ytd / ewr.ee/1000),0) as t_restaurant_italiener_ytd,
coalesce((t_restaurant_deutsch_ytd / ewr.ee/1000),0) as t_restaurant_deutsch_ytd,
coalesce((t_restaurant_indisch_ytd / ewr.ee/1000),0) as t_restaurant_indisch_ytd,
coalesce((t_restaurant_asiatisch_ytd / ewr.ee/1000),0) as t_restaurant_asiatisch_ytd,
coalesce((t_restaurant_sushi_ytd / ewr.ee/1000),0) as t_restaurant_sushi_ytd,
coalesce((t_restaurant_griechisch_ytd / ewr.ee/1000),0) as t_restaurant_griechisch_ytd,
coalesce((t_restaurant_steakhouse_ytd / ewr.ee/1000),0) as t_restaurant_steakhouse_ytd,
coalesce((t_restaurant_international_ytd / ewr.ee/1000),0) as t_restaurant_international_ytd,
coalesce((t_restaurant_tuerkisch_ytd / ewr.ee/1000),0) as t_restaurant_tuerkisch_ytd,
coalesce((t_fastfood_kebap_ytd / ewr.ee/1000),0) as t_fastfood_kebap_ytd,
coalesce((t_fastfood_burger_ytd / ewr.ee/1000),0) as t_fastfood_burger_ytd,
coalesce((t_fastfood_asiatisch_ytd / ewr.ee/1000),0) as t_fastfood_asiatisch_ytd,
coalesce((t_fastfood_pizza_ytd / ewr.ee/1000),0) as t_fastfood_pizza_ytd,
coalesce((t_fastfood_pommesbude_ytd / ewr.ee/1000),0) as t_fastfood_pommesbude_ytd,
coalesce((t_fast_food_sonstiges_ytd / ewr.ee/1000),0) as t_fast_food_sonstiges_ytd,
coalesce((t_restaurant_sonstiges_ytd / ewr.ee/1000),0) as t_restaurant_sonstiges_ytd,
coalesce((t_friseur_ytd / ewr.ee/1000),0) as t_friseur_ytd,
coalesce((t_baeckerei_ytd / ewr.ee/1000),0) as t_baeckerei_ytd,
coalesce((t_kleidung_ytd / ewr.ee/1000),0) as t_kleidung_ytd,
coalesce((t_supermarkt_ytd / ewr.ee/1000),0) as t_supermarkt_ytd,
coalesce((t_kiosk_ytd / ewr.ee/1000),0) as t_kiosk_ytd,
coalesce((t_florist_ytd / ewr.ee/1000),0) as t_florist_ytd,
coalesce((t_fahrrad_ytd / ewr.ee/1000),0) as t_fahrrad_ytd,
coalesce((t_kosmetik_und_beauty_ytd / ewr.ee/1000),0) as t_kosmetik_und_beauty_ytd,
coalesce((t_optiker_ytd / ewr.ee/1000),0) as t_optiker_ytd,
coalesce((t_schuhe_ytd / ewr.ee/1000),0) as t_schuhe_ytd,
coalesce((t_buecher_ytd / ewr.ee/1000),0) as t_buecher_ytd,
coalesce((t_massage_ytd / ewr.ee/1000),0) as t_massage_ytd,
coalesce((t_schmuck_ytd / ewr.ee/1000),0) as t_schmuck_ytd,
coalesce((t_autoreperatur_ytd / ewr.ee/1000),0) as t_autoreperatur_ytd,
coalesce((t_drogerie_ytd / ewr.ee/1000),0) as t_drogerie_ytd,
coalesce((t_reisen_ytd / ewr.ee/1000),0) as t_reisen_ytd,
coalesce((t_mobilfunk_ytd / ewr.ee/1000),0) as t_mobilfunk_ytd,
coalesce((t_moebel_ytd / ewr.ee/1000),0) as t_moebel_ytd,
coalesce((t_getraenke_ytd / ewr.ee/1000),0) as t_getraenke_ytd,
coalesce((t_feinkost_ytd / ewr.ee/1000),0) as t_feinkost_ytd,
coalesce((t_elektronik_ytd / ewr.ee/1000),0) as t_elektronik_ytd,
coalesce((t_boutique_ytd / ewr.ee/1000),0) as t_boutique_ytd,
coalesce((t_autohaus_ytd / ewr.ee/1000),0) as t_autohaus_ytd,
coalesce((t_spirituosen_ytd / ewr.ee/1000),0) as t_spirituosen_ytd,
coalesce((t_geschenke_ytd / ewr.ee/1000),0) as t_geschenke_ytd,
coalesce((t_postenmarkt_ytd / ewr.ee/1000),0) as t_postenmarkt_ytd,
coalesce((t_schlachter_ytd / ewr.ee/1000),0) as t_schlachter_ytd,
coalesce((t_waescherei_ytd / ewr.ee/1000),0) as t_waescherei_ytd,
coalesce((t_computer_ytd / ewr.ee/1000),0) as t_computer_ytd,
coalesce((t_spielzeug_ytd / ewr.ee/1000),0) as t_spielzeug_ytd,
coalesce((t_copyshop_ytd / ewr.ee/1000),0) as t_copyshop_ytd,
coalesce((t_schneider_ytd / ewr.ee/1000),0) as t_schneider_ytd,
coalesce((t_foto_ytd / ewr.ee/1000),0) as t_foto_ytd,
coalesce((t_kunst_ytd / ewr.ee/1000),0) as t_kunst_ytd,
coalesce((t_suessigkeiten_ytd / ewr.ee/1000),0) as t_suessigkeiten_ytd,
coalesce((t_dekoration_ytd / ewr.ee/1000),0) as t_dekoration_ytd,
coalesce((t_reinigung_ytd / ewr.ee/1000),0) as t_reinigung_ytd,
coalesce((t_beerdigung_ytd / ewr.ee/1000),0) as t_beerdigung_ytd,
coalesce((t_sport_ytd / ewr.ee/1000),0) as t_sport_ytd,
coalesce((t_zoofachgeschaeft_ytd / ewr.ee/1000),0) as t_zoofachgeschaeft_ytd,
coalesce((t_textilgeschaeft_ytd / ewr.ee/1000),0) as t_textilgeschaeft_ytd,
coalesce((t_hoergeraete_ytd / ewr.ee/1000),0) as t_hoergeraete_ytd,
coalesce((t_baumarkt_ytd / ewr.ee/1000),0) as t_baumarkt_ytd,
coalesce((t_leerstand_ytd / ewr.ee/1000),0) as t_leerstand_ytd,
coalesce((t_medical_ytd / ewr.ee/1000),0) as t_medical_ytd,
coalesce((t_second_hand_ytd / ewr.ee/1000),0) as t_second_hand_ytd,
coalesce((t_zeitung_ytd / ewr.ee/1000),0) as t_zeitung_ytd,
coalesce((t_eisenwarenhandlung_ytd / ewr.ee/1000),0) as t_eisenwarenhandlung_ytd,
coalesce((t_sonstiger_shop_ytd / ewr.ee/1000),0) as t_sonstiger_shop_ytd,
coalesce((t_baudenkmal_ytd / ewr.ee/1000),0) as t_baudenkmal_ytd,
coalesce((t_haltestelle_ytd / ewr.ee/1000),0) as t_haltestelle_ytd,
coalesce((t_sonstiges_gebaeude_ytd / ewr.ee/1000),0) as t_sonstiges_gebaeude_ytd,
coalesce((t_sonstiges_gelaende_ytd / ewr.ee/1000),0) as t_sonstiges_gelaende_ytd,
coalesce((t_sonstiges_denkmal_ytd / ewr.ee/1000),0) as t_sonstiges_denkmal_ytd,
coalesce((t_sonstiges_tourismus_ytd / ewr.ee/1000),0) as t_sonstiges_tourismus_ytd,
coalesce((t_sonstiges_sport_ytd / ewr.ee/1000),0) as t_sonstiges_sport_ytd,
coalesce((t_sonstiges_erholung_ytd / ewr.ee/1000),0) as t_sonstiges_erholung_ytd,
coalesce((t_hostel_stock / ewr.ee/1000),0) as t_hostel_stock,
coalesce((t_hotel_stock / ewr.ee/1000),0) as t_hotel_stock,
coalesce((t_sonstige_stock / ewr.ee/1000),0) as t_sonstige_stock,
coalesce((t_kunstwerk_stock / ewr.ee/1000),0) as t_kunstwerk_stock,
coalesce((t_kunstzentrum_stock / ewr.ee/1000),0) as t_kunstzentrum_stock,
coalesce((t_gallerie_stock / ewr.ee/1000),0) as t_gallerie_stock,
coalesce((t_info_stock / ewr.ee/1000),0) as t_info_stock,
coalesce((t_museum_stock / ewr.ee/1000),0) as t_museum_stock,
coalesce((t_aussichtspunkt_stock / ewr.ee/1000),0) as t_aussichtspunkt_stock,
coalesce((t_zoo_stock / ewr.ee/1000),0) as t_zoo_stock,
coalesce((t_schwimmen_stock / ewr.ee/1000),0) as t_schwimmen_stock,
coalesce((t_basketball_stock / ewr.ee/1000),0) as t_basketball_stock,
coalesce((t_fussball_stock / ewr.ee/1000),0) as t_fussball_stock,
coalesce((t_sportzentrum_stock / ewr.ee/1000),0) as t_sportzentrum_stock,
coalesce((t_tischtennis_stock / ewr.ee/1000),0) as t_tischtennis_stock,
coalesce((t_sauna_stock / ewr.ee/1000),0) as t_sauna_stock,
coalesce((t_tennis_stock / ewr.ee/1000),0) as t_tennis_stock,
coalesce((t_kampfsport_stock / ewr.ee/1000),0) as t_kampfsport_stock,
coalesce((t_fitnesszentrum_stock / ewr.ee/1000),0) as t_fitnesszentrum_stock,
coalesce((t_spielplatz_stock / ewr.ee/1000),0) as t_spielplatz_stock,
coalesce((t_wassersport_stock / ewr.ee/1000),0) as t_wassersport_stock,
coalesce((t_spielothek_stock / ewr.ee/1000),0) as t_spielothek_stock,
coalesce((t_sonstige_sportarten_stock / ewr.ee/1000),0) as t_sonstige_sportarten_stock,
coalesce((t_kindergarten_stock / ewr.ee/1000),0) as t_kindergarten_stock,
coalesce((t_buero_stock / ewr.ee/1000),0) as t_buero_stock,
coalesce((t_tankstelle_stock / ewr.ee/1000),0) as t_tankstelle_stock,
coalesce((t_coworking_space_stock / ewr.ee/1000),0) as t_coworking_space_stock,
coalesce((t_universitaet_stock / ewr.ee/1000),0) as t_universitaet_stock,
coalesce((t_poilzei_stock / ewr.ee/1000),0) as t_poilzei_stock,
coalesce((t_feuerwehr_stock / ewr.ee/1000),0) as t_feuerwehr_stock,
coalesce((t_kita_stock / ewr.ee/1000),0) as t_kita_stock,
coalesce((t_hoehere_schule_stock / ewr.ee/1000),0) as t_hoehere_schule_stock,
coalesce((t_wochenmarkt_stock / ewr.ee/1000),0) as t_wochenmarkt_stock,
coalesce((t_kino_stock / ewr.ee/1000),0) as t_kino_stock,
coalesce((t_biergarten_stock / ewr.ee/1000),0) as t_biergarten_stock,
coalesce((t_autovermietung_stock / ewr.ee/1000),0) as t_autovermietung_stock,
coalesce((t_buecherei_stock / ewr.ee/1000),0) as t_buecherei_stock,
coalesce((t_nachbarschaftszentrum_stock / ewr.ee/1000),0) as t_nachbarschaftszentrum_stock,
coalesce((t_theater_stock / ewr.ee/1000),0) as t_theater_stock,
coalesce((t_eisdiele_stock / ewr.ee/1000),0) as t_eisdiele_stock,
coalesce((t_nachtclub_stock / ewr.ee/1000),0) as t_nachtclub_stock,
coalesce((t_kirche_stock / ewr.ee/1000),0) as t_kirche_stock,
coalesce((t_moschee_stock / ewr.ee/1000),0) as t_moschee_stock,
coalesce((t_sonstige_tempel_stock / ewr.ee/1000),0) as t_sonstige_tempel_stock,
coalesce((t_schule_stock / ewr.ee/1000),0) as t_schule_stock,
coalesce((t_bordell_stock / ewr.ee/1000),0) as t_bordell_stock,
coalesce((t_post_filiale_stock / ewr.ee/1000),0) as t_post_filiale_stock,
coalesce((t_sozialeinrichtung_stock / ewr.ee/1000),0) as t_sozialeinrichtung_stock,
coalesce((t_ladestation_stock / ewr.ee/1000),0) as t_ladestation_stock,
coalesce((t_zahnarzt_stock / ewr.ee/1000),0) as t_zahnarzt_stock,
coalesce((t_fahrradverleih_stock / ewr.ee/1000),0) as t_fahrradverleih_stock,
coalesce((t_fahrschule_stock / ewr.ee/1000),0) as t_fahrschule_stock,
coalesce((t_tierarzt_stock / ewr.ee/1000),0) as t_tierarzt_stock,
coalesce((t_botschaft_stock / ewr.ee/1000),0) as t_botschaft_stock,
coalesce((t_taxistand_stock / ewr.ee/1000),0) as t_taxistand_stock,
coalesce((t_wc_stock / ewr.ee/1000),0) as t_wc_stock,
coalesce((t_bankfiliale_stock / ewr.ee/1000),0) as t_bankfiliale_stock,
coalesce((t_arzt_stock / ewr.ee/1000),0) as t_arzt_stock,
coalesce((t_parkplatz_stock / ewr.ee/1000),0) as t_parkplatz_stock,
coalesce((t_bar_stock / ewr.ee/1000),0) as t_bar_stock,
coalesce((t_apotheke_stock / ewr.ee/1000),0) as t_apotheke_stock,
coalesce((t_pub_stock / ewr.ee/1000),0) as t_pub_stock,
coalesce((t_telefon_stock / ewr.ee/1000),0) as t_telefon_stock,
coalesce((t_kaffee_stock / ewr.ee/1000),0) as t_kaffee_stock,
coalesce((t_sonstige_cafes_stock / ewr.ee/1000),0) as t_sonstige_cafes_stock,
coalesce((t_fahrrad_parkplatz_stock / ewr.ee/1000),0) as t_fahrrad_parkplatz_stock,
coalesce((t_muelleimer_stock / ewr.ee/1000),0) as t_muelleimer_stock,
coalesce((t_parkbank_stock / ewr.ee/1000),0) as t_parkbank_stock,
coalesce((t_krankenhaus_stock / ewr.ee/1000),0) as t_krankenhaus_stock,
coalesce((t_klinik_stock / ewr.ee/1000),0) as t_klinik_stock,
coalesce((t_geldautomat_stock / ewr.ee/1000),0) as t_geldautomat_stock,
coalesce((t_briefkasten_stock / ewr.ee/1000),0) as t_briefkasten_stock,
coalesce((t_friedhof_stock / ewr.ee/1000),0) as t_friedhof_stock,
coalesce((t_musikschule_stock / ewr.ee/1000),0) as t_musikschule_stock,
coalesce((t_paketautomat_stock / ewr.ee/1000),0) as t_paketautomat_stock,
coalesce((t_sonstige_automaten_stock / ewr.ee/1000),0) as t_sonstige_automaten_stock,
coalesce((t_fahrscheinautomat_stock / ewr.ee/1000),0) as t_fahrscheinautomat_stock,
coalesce((t_parkticketautomat_stock / ewr.ee/1000),0) as t_parkticketautomat_stock,
coalesce((t_kotbeutelautomat_stock / ewr.ee/1000),0) as t_kotbeutelautomat_stock,
coalesce((t_zigarettenautomat_stock / ewr.ee/1000),0) as t_zigarettenautomat_stock,
coalesce((t_suessigkeitenautomat_stock / ewr.ee/1000),0) as t_suessigkeitenautomat_stock,
coalesce((t_briefmarkenautomat_stock / ewr.ee/1000),0) as t_briefmarkenautomat_stock,
coalesce((t_kondomautomat_stock / ewr.ee/1000),0) as t_kondomautomat_stock,
coalesce((t_getraenke_und_suessigkeitenautomat_stock / ewr.ee/1000),0) as t_getraenke_und_suessigkeitenautomat_stock,
coalesce((t_getraenkeautomat_stock / ewr.ee/1000),0) as t_getraenkeautomat_stock,
coalesce((t_grillplatz_stock / ewr.ee/1000),0) as t_grillplatz_stock,
coalesce((t_glascontainer_stock / ewr.ee/1000),0) as t_glascontainer_stock,
coalesce((t_glas__und_kleidungscontainer_stock / ewr.ee/1000),0) as t_glas__und_kleidungscontainer_stock,
coalesce((t_kleidungscontainer_stock / ewr.ee/1000),0) as t_kleidungscontainer_stock,
coalesce((t_sonstige_container_stock / ewr.ee/1000),0) as t_sonstige_container_stock,
coalesce((t_restaurant_italiener_stock / ewr.ee/1000),0) as t_restaurant_italiener_stock,
coalesce((t_restaurant_deutsch_stock / ewr.ee/1000),0) as t_restaurant_deutsch_stock,
coalesce((t_restaurant_indisch_stock / ewr.ee/1000),0) as t_restaurant_indisch_stock,
coalesce((t_restaurant_asiatisch_stock / ewr.ee/1000),0) as t_restaurant_asiatisch_stock,
coalesce((t_restaurant_sushi_stock / ewr.ee/1000),0) as t_restaurant_sushi_stock,
coalesce((t_restaurant_griechisch_stock / ewr.ee/1000),0) as t_restaurant_griechisch_stock,
coalesce((t_restaurant_steakhouse_stock / ewr.ee/1000),0) as t_restaurant_steakhouse_stock,
coalesce((t_restaurant_international_stock / ewr.ee/1000),0) as t_restaurant_international_stock,
coalesce((t_restaurant_tuerkisch_stock / ewr.ee/1000),0) as t_restaurant_tuerkisch_stock,
coalesce((t_fastfood_kebap_stock / ewr.ee/1000),0) as t_fastfood_kebap_stock,
coalesce((t_fastfood_burger_stock / ewr.ee/1000),0) as t_fastfood_burger_stock,
coalesce((t_fastfood_asiatisch_stock / ewr.ee/1000),0) as t_fastfood_asiatisch_stock,
coalesce((t_fastfood_pizza_stock / ewr.ee/1000),0) as t_fastfood_pizza_stock,
coalesce((t_fastfood_pommesbude_stock / ewr.ee/1000),0) as t_fastfood_pommesbude_stock,
coalesce((t_fast_food_sonstiges_stock / ewr.ee/1000),0) as t_fast_food_sonstiges_stock,
coalesce((t_restaurant_sonstiges_stock / ewr.ee/1000),0) as t_restaurant_sonstiges_stock,
coalesce((t_friseur_stock / ewr.ee/1000),0) as t_friseur_stock,
coalesce((t_baeckerei_stock / ewr.ee/1000),0) as t_baeckerei_stock,
coalesce((t_kleidung_stock / ewr.ee/1000),0) as t_kleidung_stock,
coalesce((t_supermarkt_stock / ewr.ee/1000),0) as t_supermarkt_stock,
coalesce((t_kiosk_stock / ewr.ee/1000),0) as t_kiosk_stock,
coalesce((t_florist_stock / ewr.ee/1000),0) as t_florist_stock,
coalesce((t_fahrrad_stock / ewr.ee/1000),0) as t_fahrrad_stock,
coalesce((t_kosmetik_und_beauty_stock / ewr.ee/1000),0) as t_kosmetik_und_beauty_stock,
coalesce((t_optiker_stock / ewr.ee/1000),0) as t_optiker_stock,
coalesce((t_schuhe_stock / ewr.ee/1000),0) as t_schuhe_stock,
coalesce((t_buecher_stock / ewr.ee/1000),0) as t_buecher_stock,
coalesce((t_massage_stock / ewr.ee/1000),0) as t_massage_stock,
coalesce((t_schmuck_stock / ewr.ee/1000),0) as t_schmuck_stock,
coalesce((t_autoreperatur_stock / ewr.ee/1000),0) as t_autoreperatur_stock,
coalesce((t_drogerie_stock / ewr.ee/1000),0) as t_drogerie_stock,
coalesce((t_reisen_stock / ewr.ee/1000),0) as t_reisen_stock,
coalesce((t_mobilfunk_stock / ewr.ee/1000),0) as t_mobilfunk_stock,
coalesce((t_moebel_stock / ewr.ee/1000),0) as t_moebel_stock,
coalesce((t_getraenke_stock / ewr.ee/1000),0) as t_getraenke_stock,
coalesce((t_feinkost_stock / ewr.ee/1000),0) as t_feinkost_stock,
coalesce((t_elektronik_stock / ewr.ee/1000),0) as t_elektronik_stock,
coalesce((t_boutique_stock / ewr.ee/1000),0) as t_boutique_stock,
coalesce((t_autohaus_stock / ewr.ee/1000),0) as t_autohaus_stock,
coalesce((t_spirituosen_stock / ewr.ee/1000),0) as t_spirituosen_stock,
coalesce((t_geschenke_stock / ewr.ee/1000),0) as t_geschenke_stock,
coalesce((t_postenmarkt_stock / ewr.ee/1000),0) as t_postenmarkt_stock,
coalesce((t_schlachter_stock / ewr.ee/1000),0) as t_schlachter_stock,
coalesce((t_waescherei_stock / ewr.ee/1000),0) as t_waescherei_stock,
coalesce((t_computer_stock / ewr.ee/1000),0) as t_computer_stock,
coalesce((t_spielzeug_stock / ewr.ee/1000),0) as t_spielzeug_stock,
coalesce((t_copyshop_stock / ewr.ee/1000),0) as t_copyshop_stock,
coalesce((t_schneider_stock / ewr.ee/1000),0) as t_schneider_stock,
coalesce((t_foto_stock / ewr.ee/1000),0) as t_foto_stock,
coalesce((t_kunst_stock / ewr.ee/1000),0) as t_kunst_stock,
coalesce((t_suessigkeiten_stock / ewr.ee/1000),0) as t_suessigkeiten_stock,
coalesce((t_dekoration_stock / ewr.ee/1000),0) as t_dekoration_stock,
coalesce((t_reinigung_stock / ewr.ee/1000),0) as t_reinigung_stock,
coalesce((t_beerdigung_stock / ewr.ee/1000),0) as t_beerdigung_stock,
coalesce((t_sport_stock / ewr.ee/1000),0) as t_sport_stock,
coalesce((t_zoofachgeschaeft_stock / ewr.ee/1000),0) as t_zoofachgeschaeft_stock,
coalesce((t_textilgeschaeft_stock / ewr.ee/1000),0) as t_textilgeschaeft_stock,
coalesce((t_hoergeraete_stock / ewr.ee/1000),0) as t_hoergeraete_stock,
coalesce((t_baumarkt_stock / ewr.ee/1000),0) as t_baumarkt_stock,
coalesce((t_leerstand_stock / ewr.ee/1000),0) as t_leerstand_stock,
coalesce((t_medical_stock / ewr.ee/1000),0) as t_medical_stock,
coalesce((t_second_hand_stock / ewr.ee/1000),0) as t_second_hand_stock,
coalesce((t_zeitung_stock / ewr.ee/1000),0) as t_zeitung_stock,
coalesce((t_eisenwarenhandlung_stock / ewr.ee/1000),0) as t_eisenwarenhandlung_stock,
coalesce((t_sonstiger_shop_stock / ewr.ee/1000),0) as t_sonstiger_shop_stock,
coalesce((t_baudenkmal_stock / ewr.ee/1000),0) as t_baudenkmal_stock,
coalesce((t_haltestelle_stock / ewr.ee/1000),0) as t_haltestelle_stock,
coalesce((t_sonstiges_gebaeude_stock / ewr.ee/1000),0) as t_sonstiges_gebaeude_stock,
coalesce((t_sonstiges_gelaende_stock / ewr.ee/1000),0) as t_sonstiges_gelaende_stock,
coalesce((t_sonstiges_denkmal_stock / ewr.ee/1000),0) as t_sonstiges_denkmal_stock,
coalesce((t_sonstiges_tourismus_stock / ewr.ee/1000),0) as t_sonstiges_tourismus_stock,
coalesce((t_sonstiges_sport_stock / ewr.ee/1000),0) as t_sonstiges_sport_stock,
coalesce((t_sonstiges_erholung_stock / ewr.ee/1000),0) as t_sonstiges_erholung_stock
  
from lor_ewr_einwohnergewichtet_bzr ewr 
join lor_mss_idx_bzr_idx mss 
on ewr.zeit = mss.zeit 
and cast(ewr.planungsraum as int) = mss.raum_id

left join 
(select 
  planungsraum,
  201412 as timeslice,

t_hostel_stock,
t_hotel_stock,
t_sonstige_stock,
t_kunstwerk_stock,
t_kunstzentrum_stock,
t_gallerie_stock,
t_info_stock,
t_museum_stock,
t_aussichtspunkt_stock,
t_zoo_stock,
t_schwimmen_stock,
t_basketball_stock,
t_fussball_stock,
t_sportzentrum_stock,
t_tischtennis_stock,
t_sauna_stock,
t_tennis_stock,
t_kampfsport_stock,
t_fitnesszentrum_stock,
t_spielplatz_stock,
t_wassersport_stock,
t_spielothek_stock,
t_sonstige_sportarten_stock,
t_kindergarten_stock,
t_buero_stock,
t_tankstelle_stock,
t_coworking_space_stock,
t_universitaet_stock,
t_poilzei_stock,
t_feuerwehr_stock,
t_kita_stock,
t_hoehere_schule_stock,
t_wochenmarkt_stock,
t_kino_stock,
t_biergarten_stock,
t_autovermietung_stock,
t_buecherei_stock,
t_nachbarschaftszentrum_stock,
t_theater_stock,
t_eisdiele_stock,
t_nachtclub_stock,
t_kirche_stock,
t_moschee_stock,
t_sonstige_tempel_stock,
t_schule_stock,
t_bordell_stock,
t_post_filiale_stock,
t_sozialeinrichtung_stock,
t_ladestation_stock,
t_zahnarzt_stock,
t_fahrradverleih_stock,
t_fahrschule_stock,
t_tierarzt_stock,
t_botschaft_stock,
t_taxistand_stock,
t_wc_stock,
t_bankfiliale_stock,
t_arzt_stock,
t_parkplatz_stock,
t_bar_stock,
t_apotheke_stock,
t_pub_stock,
t_telefon_stock,
t_kaffee_stock,
t_sonstige_cafes_stock,
t_fahrrad_parkplatz_stock,
t_muelleimer_stock,
t_parkbank_stock,
t_krankenhaus_stock,
t_klinik_stock,
t_geldautomat_stock,
t_briefkasten_stock,
t_friedhof_stock,
t_musikschule_stock,
t_paketautomat_stock,
t_sonstige_automaten_stock,
t_fahrscheinautomat_stock,
t_parkticketautomat_stock,
t_kotbeutelautomat_stock,
t_zigarettenautomat_stock,
t_suessigkeitenautomat_stock,
t_briefmarkenautomat_stock,
t_kondomautomat_stock,
t_getraenke_und_suessigkeitenautomat_stock,
t_getraenkeautomat_stock,
t_grillplatz_stock,
t_glascontainer_stock,
t_glas__und_kleidungscontainer_stock,
t_kleidungscontainer_stock,
t_sonstige_container_stock,
t_restaurant_italiener_stock,
t_restaurant_deutsch_stock,
t_restaurant_indisch_stock,
t_restaurant_asiatisch_stock,
t_restaurant_sushi_stock,
t_restaurant_griechisch_stock,
t_restaurant_steakhouse_stock,
t_restaurant_international_stock,
t_restaurant_tuerkisch_stock,
t_fastfood_kebap_stock,
t_fastfood_burger_stock,
t_fastfood_asiatisch_stock,
t_fastfood_pizza_stock,
t_fastfood_pommesbude_stock,
t_fast_food_sonstiges_stock,
t_restaurant_sonstiges_stock,
t_friseur_stock,
t_baeckerei_stock,
t_kleidung_stock,
t_supermarkt_stock,
t_kiosk_stock,
t_florist_stock,
t_fahrrad_stock,
t_kosmetik_und_beauty_stock,
t_optiker_stock,
t_schuhe_stock,
t_buecher_stock,
t_massage_stock,
t_schmuck_stock,
t_autoreperatur_stock,
t_drogerie_stock,
t_reisen_stock,
t_mobilfunk_stock,
t_moebel_stock,
t_getraenke_stock,
t_feinkost_stock,
t_elektronik_stock,
t_boutique_stock,
t_autohaus_stock,
t_spirituosen_stock,
t_geschenke_stock,
t_postenmarkt_stock,
t_schlachter_stock,
t_waescherei_stock,
t_computer_stock,
t_spielzeug_stock,
t_copyshop_stock,
t_schneider_stock,
t_foto_stock,
t_kunst_stock,
t_suessigkeiten_stock,
t_dekoration_stock,
t_reinigung_stock,
t_beerdigung_stock,
t_sport_stock,
t_zoofachgeschaeft_stock,
t_textilgeschaeft_stock,
t_hoergeraete_stock,
t_baumarkt_stock,
t_leerstand_stock,
t_medical_stock,
t_second_hand_stock,
t_zeitung_stock,
t_eisenwarenhandlung_stock,
t_sonstiger_shop_stock,
t_baudenkmal_stock,
t_haltestelle_stock,
t_sonstiges_gebaeude_stock,
t_sonstiges_gelaende_stock,
t_sonstiges_denkmal_stock,
t_sonstiges_tourismus_stock,
t_sonstiges_sport_stock,
t_sonstiges_erholung_stock


  
  from osm_poi_features_type_piv_distcalc_bzr
  where timeslice in (201501) 
) stock_t
on ewr.zeit = stock_t.timeslice
and cast(ewr.planungsraum as int) = cast(stock_t.planungsraum as int)
left join
(select
  planungsraum,
  201412 as timeslice,

SUM(t_hostel_ytd) as t_hostel_ytd,
SUM(t_hotel_ytd) as t_hotel_ytd,
SUM(t_sonstige_ytd) as t_sonstige_ytd,
SUM(t_kunstwerk_ytd) as t_kunstwerk_ytd,
SUM(t_kunstzentrum_ytd) as t_kunstzentrum_ytd,
SUM(t_gallerie_ytd) as t_gallerie_ytd,
SUM(t_info_ytd) as t_info_ytd,
SUM(t_museum_ytd) as t_museum_ytd,
SUM(t_aussichtspunkt_ytd) as t_aussichtspunkt_ytd,
SUM(t_zoo_ytd) as t_zoo_ytd,
SUM(t_schwimmen_ytd) as t_schwimmen_ytd,
SUM(t_basketball_ytd) as t_basketball_ytd,
SUM(t_fussball_ytd) as t_fussball_ytd,
SUM(t_sportzentrum_ytd) as t_sportzentrum_ytd,
SUM(t_tischtennis_ytd) as t_tischtennis_ytd,
SUM(t_sauna_ytd) as t_sauna_ytd,
SUM(t_tennis_ytd) as t_tennis_ytd,
SUM(t_kampfsport_ytd) as t_kampfsport_ytd,
SUM(t_fitnesszentrum_ytd) as t_fitnesszentrum_ytd,
SUM(t_spielplatz_ytd) as t_spielplatz_ytd,
SUM(t_wassersport_ytd) as t_wassersport_ytd,
SUM(t_spielothek_ytd) as t_spielothek_ytd,
SUM(t_sonstige_sportarten_ytd) as t_sonstige_sportarten_ytd,
SUM(t_kindergarten_ytd) as t_kindergarten_ytd,
SUM(t_buero_ytd) as t_buero_ytd,
SUM(t_tankstelle_ytd) as t_tankstelle_ytd,
SUM(t_coworking_space_ytd) as t_coworking_space_ytd,
SUM(t_universitaet_ytd) as t_universitaet_ytd,
SUM(t_poilzei_ytd) as t_poilzei_ytd,
SUM(t_feuerwehr_ytd) as t_feuerwehr_ytd,
SUM(t_kita_ytd) as t_kita_ytd,
SUM(t_hoehere_schule_ytd) as t_hoehere_schule_ytd,
SUM(t_wochenmarkt_ytd) as t_wochenmarkt_ytd,
SUM(t_kino_ytd) as t_kino_ytd,
SUM(t_biergarten_ytd) as t_biergarten_ytd,
SUM(t_autovermietung_ytd) as t_autovermietung_ytd,
SUM(t_buecherei_ytd) as t_buecherei_ytd,
SUM(t_nachbarschaftszentrum_ytd) as t_nachbarschaftszentrum_ytd,
SUM(t_theater_ytd) as t_theater_ytd,
SUM(t_eisdiele_ytd) as t_eisdiele_ytd,
SUM(t_nachtclub_ytd) as t_nachtclub_ytd,
SUM(t_kirche_ytd) as t_kirche_ytd,
SUM(t_moschee_ytd) as t_moschee_ytd,
SUM(t_sonstige_tempel_ytd) as t_sonstige_tempel_ytd,
SUM(t_schule_ytd) as t_schule_ytd,
SUM(t_bordell_ytd) as t_bordell_ytd,
SUM(t_post_filiale_ytd) as t_post_filiale_ytd,
SUM(t_sozialeinrichtung_ytd) as t_sozialeinrichtung_ytd,
SUM(t_ladestation_ytd) as t_ladestation_ytd,
SUM(t_zahnarzt_ytd) as t_zahnarzt_ytd,
SUM(t_fahrradverleih_ytd) as t_fahrradverleih_ytd,
SUM(t_fahrschule_ytd) as t_fahrschule_ytd,
SUM(t_tierarzt_ytd) as t_tierarzt_ytd,
SUM(t_botschaft_ytd) as t_botschaft_ytd,
SUM(t_taxistand_ytd) as t_taxistand_ytd,
SUM(t_wc_ytd) as t_wc_ytd,
SUM(t_bankfiliale_ytd) as t_bankfiliale_ytd,
SUM(t_arzt_ytd) as t_arzt_ytd,
SUM(t_parkplatz_ytd) as t_parkplatz_ytd,
SUM(t_bar_ytd) as t_bar_ytd,
SUM(t_apotheke_ytd) as t_apotheke_ytd,
SUM(t_pub_ytd) as t_pub_ytd,
SUM(t_telefon_ytd) as t_telefon_ytd,
SUM(t_kaffee_ytd) as t_kaffee_ytd,
SUM(t_sonstige_cafes_ytd) as t_sonstige_cafes_ytd,
SUM(t_fahrrad_parkplatz_ytd) as t_fahrrad_parkplatz_ytd,
SUM(t_muelleimer_ytd) as t_muelleimer_ytd,
SUM(t_parkbank_ytd) as t_parkbank_ytd,
SUM(t_krankenhaus_ytd) as t_krankenhaus_ytd,
SUM(t_klinik_ytd) as t_klinik_ytd,
SUM(t_geldautomat_ytd) as t_geldautomat_ytd,
SUM(t_briefkasten_ytd) as t_briefkasten_ytd,
SUM(t_friedhof_ytd) as t_friedhof_ytd,
SUM(t_musikschule_ytd) as t_musikschule_ytd,
SUM(t_paketautomat_ytd) as t_paketautomat_ytd,
SUM(t_sonstige_automaten_ytd) as t_sonstige_automaten_ytd,
SUM(t_fahrscheinautomat_ytd) as t_fahrscheinautomat_ytd,
SUM(t_parkticketautomat_ytd) as t_parkticketautomat_ytd,
SUM(t_kotbeutelautomat_ytd) as t_kotbeutelautomat_ytd,
SUM(t_zigarettenautomat_ytd) as t_zigarettenautomat_ytd,
SUM(t_suessigkeitenautomat_ytd) as t_suessigkeitenautomat_ytd,
SUM(t_briefmarkenautomat_ytd) as t_briefmarkenautomat_ytd,
SUM(t_kondomautomat_ytd) as t_kondomautomat_ytd,
SUM(t_getraenke_und_suessigkeitenautomat_ytd) as t_getraenke_und_suessigkeitenautomat_ytd,
SUM(t_getraenkeautomat_ytd) as t_getraenkeautomat_ytd,
SUM(t_grillplatz_ytd) as t_grillplatz_ytd,
SUM(t_glascontainer_ytd) as t_glascontainer_ytd,
SUM(t_glas__und_kleidungscontainer_ytd) as t_glas__und_kleidungscontainer_ytd,
SUM(t_kleidungscontainer_ytd) as t_kleidungscontainer_ytd,
SUM(t_sonstige_container_ytd) as t_sonstige_container_ytd,
SUM(t_restaurant_italiener_ytd) as t_restaurant_italiener_ytd,
SUM(t_restaurant_deutsch_ytd) as t_restaurant_deutsch_ytd,
SUM(t_restaurant_indisch_ytd) as t_restaurant_indisch_ytd,
SUM(t_restaurant_asiatisch_ytd) as t_restaurant_asiatisch_ytd,
SUM(t_restaurant_sushi_ytd) as t_restaurant_sushi_ytd,
SUM(t_restaurant_griechisch_ytd) as t_restaurant_griechisch_ytd,
SUM(t_restaurant_steakhouse_ytd) as t_restaurant_steakhouse_ytd,
SUM(t_restaurant_international_ytd) as t_restaurant_international_ytd,
SUM(t_restaurant_tuerkisch_ytd) as t_restaurant_tuerkisch_ytd,
SUM(t_fastfood_kebap_ytd) as t_fastfood_kebap_ytd,
SUM(t_fastfood_burger_ytd) as t_fastfood_burger_ytd,
SUM(t_fastfood_asiatisch_ytd) as t_fastfood_asiatisch_ytd,
SUM(t_fastfood_pizza_ytd) as t_fastfood_pizza_ytd,
SUM(t_fastfood_pommesbude_ytd) as t_fastfood_pommesbude_ytd,
SUM(t_fast_food_sonstiges_ytd) as t_fast_food_sonstiges_ytd,
SUM(t_restaurant_sonstiges_ytd) as t_restaurant_sonstiges_ytd,
SUM(t_friseur_ytd) as t_friseur_ytd,
SUM(t_baeckerei_ytd) as t_baeckerei_ytd,
SUM(t_kleidung_ytd) as t_kleidung_ytd,
SUM(t_supermarkt_ytd) as t_supermarkt_ytd,
SUM(t_kiosk_ytd) as t_kiosk_ytd,
SUM(t_florist_ytd) as t_florist_ytd,
SUM(t_fahrrad_ytd) as t_fahrrad_ytd,
SUM(t_kosmetik_und_beauty_ytd) as t_kosmetik_und_beauty_ytd,
SUM(t_optiker_ytd) as t_optiker_ytd,
SUM(t_schuhe_ytd) as t_schuhe_ytd,
SUM(t_buecher_ytd) as t_buecher_ytd,
SUM(t_massage_ytd) as t_massage_ytd,
SUM(t_schmuck_ytd) as t_schmuck_ytd,
SUM(t_autoreperatur_ytd) as t_autoreperatur_ytd,
SUM(t_drogerie_ytd) as t_drogerie_ytd,
SUM(t_reisen_ytd) as t_reisen_ytd,
SUM(t_mobilfunk_ytd) as t_mobilfunk_ytd,
SUM(t_moebel_ytd) as t_moebel_ytd,
SUM(t_getraenke_ytd) as t_getraenke_ytd,
SUM(t_feinkost_ytd) as t_feinkost_ytd,
SUM(t_elektronik_ytd) as t_elektronik_ytd,
SUM(t_boutique_ytd) as t_boutique_ytd,
SUM(t_autohaus_ytd) as t_autohaus_ytd,
SUM(t_spirituosen_ytd) as t_spirituosen_ytd,
SUM(t_geschenke_ytd) as t_geschenke_ytd,
SUM(t_postenmarkt_ytd) as t_postenmarkt_ytd,
SUM(t_schlachter_ytd) as t_schlachter_ytd,
SUM(t_waescherei_ytd) as t_waescherei_ytd,
SUM(t_computer_ytd) as t_computer_ytd,
SUM(t_spielzeug_ytd) as t_spielzeug_ytd,
SUM(t_copyshop_ytd) as t_copyshop_ytd,
SUM(t_schneider_ytd) as t_schneider_ytd,
SUM(t_foto_ytd) as t_foto_ytd,
SUM(t_kunst_ytd) as t_kunst_ytd,
SUM(t_suessigkeiten_ytd) as t_suessigkeiten_ytd,
SUM(t_dekoration_ytd) as t_dekoration_ytd,
SUM(t_reinigung_ytd) as t_reinigung_ytd,
SUM(t_beerdigung_ytd) as t_beerdigung_ytd,
SUM(t_sport_ytd) as t_sport_ytd,
SUM(t_zoofachgeschaeft_ytd) as t_zoofachgeschaeft_ytd,
SUM(t_textilgeschaeft_ytd) as t_textilgeschaeft_ytd,
SUM(t_hoergeraete_ytd) as t_hoergeraete_ytd,
SUM(t_baumarkt_ytd) as t_baumarkt_ytd,
SUM(t_leerstand_ytd) as t_leerstand_ytd,
SUM(t_medical_ytd) as t_medical_ytd,
SUM(t_second_hand_ytd) as t_second_hand_ytd,
SUM(t_zeitung_ytd) as t_zeitung_ytd,
SUM(t_eisenwarenhandlung_ytd) as t_eisenwarenhandlung_ytd,
SUM(t_sonstiger_shop_ytd) as t_sonstiger_shop_ytd,
SUM(t_baudenkmal_ytd) as t_baudenkmal_ytd,
SUM(t_haltestelle_ytd) as t_haltestelle_ytd,
SUM(t_sonstiges_gebaeude_ytd) as t_sonstiges_gebaeude_ytd,
SUM(t_sonstiges_gelaende_ytd) as t_sonstiges_gelaende_ytd,
SUM(t_sonstiges_denkmal_ytd) as t_sonstiges_denkmal_ytd,
SUM(t_sonstiges_tourismus_ytd) as t_sonstiges_tourismus_ytd,
SUM(t_sonstiges_sport_ytd) as t_sonstiges_sport_ytd,
SUM(t_sonstiges_erholung_ytd) as t_sonstiges_erholung_ytd
  
  from osm_poi_features_type_piv_distcalc_bzr
  where timeslice in (201401, 201501)
  group by planungsraum
) dyn_t
on ewr.zeit = dyn_t.timeslice
and cast(ewr.planungsraum as int) = cast(dyn_t.planungsraum as int)

left join 
(select 
  planungsraum,
  201412 as timeslice,
  
c_uebernachtung_stock,
c_sehenswuerdigkeit_stock,
c_kultur_stock,
c_info_stock,
c_sport_stock,
c_erholung_stock,
c_zwielicht_stock,
c_bildung_stock,
c_buero_stock,
c_individual_stock,
c_hipster_stock,
c_sicherheit_stock,
c_sonstiges_stock,
c_ausgehen_stock,
c_gaststaetten_stock,
c_sozial_stock,
c_cafe_stock,
c_religioese_gebaeude_stock,
c_post_stock,
c_gesundheit_stock,
c_wc_stock,
c_bank_stock,
c_telefon_stock,
c_recycling_stock,
c_parkbank_stock,
c_briefe_und_pakete_stock,
c_friedhof_stock,
c_automaten_stock,
c_oepnv_stock,
c_restaurant_stock,
c_fast_food_stock,
c_friseur_stock,
c_essen_und_trinken_stock,
c_kleidung_stock,
c_sonstige_waren_stock,
c_werkstatt_stock,
c_kosmetik_und_beauty_stock,
c_medical_stock,
c_print_stock,
c_massage_stock,
c_drogerie_stock,
c_reisen_stock,
c_technik_stock,
c_spielzeug_und_geschenke_stock,
c_waescherei_stock,
c_kunst_stock,
c_beerdigung_stock,
c_handwerk_stock,
c_leerstand_stock,
c_sonstiger_shop_stock,
c_sonstiges_gebaeude_stock,
c_sonstiges_gelaende_stock,
c_sonstiges_tourismus_stock

  from osm_poi_features_category_piv_distcalc_bzr
  where timeslice in (201501) 
) stock_c
on ewr.zeit = stock_c.timeslice
and cast(ewr.planungsraum as int) = cast(stock_c.planungsraum as int)
left join
(select
  planungsraum,
  201412 as timeslice,
  
SUM(c_uebernachtung_ytd) as c_uebernachtung_ytd,
SUM(c_sehenswuerdigkeit_ytd) as c_sehenswuerdigkeit_ytd,
SUM(c_kultur_ytd) as c_kultur_ytd,
SUM(c_info_ytd) as c_info_ytd,
SUM(c_sport_ytd) as c_sport_ytd,
SUM(c_erholung_ytd) as c_erholung_ytd,
SUM(c_zwielicht_ytd) as c_zwielicht_ytd,
SUM(c_bildung_ytd) as c_bildung_ytd,
SUM(c_buero_ytd) as c_buero_ytd,
SUM(c_individual_ytd) as c_individual_ytd,
SUM(c_hipster_ytd) as c_hipster_ytd,
SUM(c_sicherheit_ytd) as c_sicherheit_ytd,
SUM(c_sonstiges_ytd) as c_sonstiges_ytd,
SUM(c_ausgehen_ytd) as c_ausgehen_ytd,
SUM(c_gaststaetten_ytd) as c_gaststaetten_ytd,
SUM(c_sozial_ytd) as c_sozial_ytd,
SUM(c_cafe_ytd) as c_cafe_ytd,
SUM(c_religioese_gebaeude_ytd) as c_religioese_gebaeude_ytd,
SUM(c_post_ytd) as c_post_ytd,
SUM(c_gesundheit_ytd) as c_gesundheit_ytd,
SUM(c_wc_ytd) as c_wc_ytd,
SUM(c_bank_ytd) as c_bank_ytd,
SUM(c_telefon_ytd) as c_telefon_ytd,
SUM(c_recycling_ytd) as c_recycling_ytd,
SUM(c_parkbank_ytd) as c_parkbank_ytd,
SUM(c_briefe_und_pakete_ytd) as c_briefe_und_pakete_ytd,
SUM(c_friedhof_ytd) as c_friedhof_ytd,
SUM(c_automaten_ytd) as c_automaten_ytd,
SUM(c_oepnv_ytd) as c_oepnv_ytd,
SUM(c_restaurant_ytd) as c_restaurant_ytd,
SUM(c_fast_food_ytd) as c_fast_food_ytd,
SUM(c_friseur_ytd) as c_friseur_ytd,
SUM(c_essen_und_trinken_ytd) as c_essen_und_trinken_ytd,
SUM(c_kleidung_ytd) as c_kleidung_ytd,
SUM(c_sonstige_waren_ytd) as c_sonstige_waren_ytd,
SUM(c_werkstatt_ytd) as c_werkstatt_ytd,
SUM(c_kosmetik_und_beauty_ytd) as c_kosmetik_und_beauty_ytd,
SUM(c_medical_ytd) as c_medical_ytd,
SUM(c_print_ytd) as c_print_ytd,
SUM(c_massage_ytd) as c_massage_ytd,
SUM(c_drogerie_ytd) as c_drogerie_ytd,
SUM(c_reisen_ytd) as c_reisen_ytd,
SUM(c_technik_ytd) as c_technik_ytd,
SUM(c_spielzeug_und_geschenke_ytd) as c_spielzeug_und_geschenke_ytd,
SUM(c_waescherei_ytd) as c_waescherei_ytd,
SUM(c_kunst_ytd) as c_kunst_ytd,
SUM(c_beerdigung_ytd) as c_beerdigung_ytd,
SUM(c_handwerk_ytd) as c_handwerk_ytd,
SUM(c_leerstand_ytd) as c_leerstand_ytd,
SUM(c_sonstiger_shop_ytd) as c_sonstiger_shop_ytd,
SUM(c_sonstiges_gebaeude_ytd) as c_sonstiges_gebaeude_ytd,
SUM(c_sonstiges_gelaende_ytd) as c_sonstiges_gelaende_ytd,
SUM(c_sonstiges_tourismus_ytd) as c_sonstiges_tourismus_ytd

  from osm_poi_features_category_piv_distcalc_bzr
  where timeslice in (201401, 201501)
  group by planungsraum
) dyn_c
on ewr.zeit = dyn_c.timeslice
and cast(ewr.planungsraum as int) = cast(dyn_c.planungsraum as int)

left join 
(select 
  planungsraum,
  201412 as timeslice,
  d_tourismus_stock,
  d_vergnuegung_stock,
  d_sport_und_erholung_stock,
  d_public_service_stock,
  d_buero_stock,
  d_mobilitaet_stock,
  d_sonstiges_stock,
  d_gastronomie_stock,
  d_religion_stock,
  d_oeffentlicher_raum_stock,
  d_dienstleistung_stock,
  d_waren_stock,
  d_leerstand_stock
  from osm_poi_features_domain_piv_distcalc_bzr
  where timeslice in (201501) 
) stock_d
on ewr.zeit = stock_d.timeslice
and cast(ewr.planungsraum as int) = cast(stock_d.planungsraum as int)
left join
(select
  planungsraum,
  201412 as timeslice,
  SUM(d_tourismus_ytd) as d_tourismus_ytd,
  SUM(d_vergnuegung_ytd) as d_vergnuegung_ytd,
  SUM(d_sport_und_erholung_ytd) as d_sport_und_erholung_ytd,
  SUM(d_public_service_ytd) as d_public_service_ytd,
  SUM(d_buero_ytd) as d_buero_ytd,
  SUM(d_mobilitaet_ytd) as d_mobilitaet_ytd,
  SUM(d_sonstiges_ytd) as d_sonstiges_ytd,
  SUM(d_gastronomie_ytd) as d_gastronomie_ytd,
  SUM(d_religion_ytd) as d_religion_ytd,
  SUM(d_oeffentlicher_raum_ytd) as d_oeffentlicher_raum_ytd,
  SUM(d_dienstleistung_ytd) as d_dienstleistung_ytd,
  SUM(d_waren_ytd) as d_waren_ytd,
  SUM(d_leerstand_ytd) as d_leerstand_ytd
  from osm_poi_features_domain_piv_distcalc_bzr
  where timeslice in (201401, 201501)
  group by planungsraum
) dyn_d
on ewr.zeit = dyn_d.timeslice
and cast(ewr.planungsraum as int) = cast(dyn_d.planungsraum as int)

where ewr.zeit = 201412
