drop table result_full_plr_distcalc;
create table result_full_plr_distcalc as 

select 
case 
when mss.status_index > 0.5 then "niedrig"
when mss.status_index < -0.5 then "hoch"
else "mittel"
end as status_klasse_prj,
case 
when mss.dynamik_index > 0.5 then "negativ"
when mss.dynamik_index < -0.5 then "positiv"
else "neutral"
end as dynamik_klasse_prj,
case 
when mss.status_index > 0 then "niedrig"
when mss.status_index <= 0 then "hoch"
else "mittel"
end as status_klasse_prj_bi,
case 
when mss.dynamik_index > 0 then "negativ"
when mss.dynamik_index <= 0 then "positiv"
else "neutral"
end as dynamik_klasse_prj_bi,
case 
when own_idx.sum_idx_points <= -2 then "negativ"
when own_idx.sum_idx_points >= 2 then "positiv"
else "neutral"
end as own_idx_class
,case 
when own_idx.sum_idx_points < 0 then "negativ"
when own_idx.sum_idx_points >= 0 then "positiv"
else "neutral"
end as own_idx_class_bi,
mss.raum_id
,mss.raum_desc
,mss.zeit
,mss.ew
,mss.zs1
,mss.zs2
,mss.zs3
,mss.zs4
,mss.status_summe
,mss.status_index
,mss.status_klasse
,mss.zd1
,mss.zd2
,mss.zd3
,mss.zd4
,mss.dynamik_summe
,mss.dynamik_index
,mss.dynamik_klasse
,mss.s1
,mss.s2
,mss.s3
,mss.s4
,mss.d1
,mss.d2
,mss.d3
,mss.d4
,own_idx.k11_msr_points
,own_idx.dau5_msr_points
,own_idx.dau10_msr_points
,own_idx.doering_ulbricht_idx_m_points
,own_idx.doering_ulbricht_idx_m_value
,own_idx.d2_msr_points
,own_idx.ea_msr_points
,own_idx.mh_msr_points
,own_idx.ee_18u35_msr_points
,own_idx.ee_35u45_msr_points
,own_idx.doering_ulbricht_idx_b_points
,own_idx.doering_ulbricht_idx_b_value
,own_idx.sum_idx_points
,own_idx.sum_idx_value
,ewr.ee
,ewr.dau5
,ewr.dau10
,ewr.ee_m
,ewr.ee_w
,ewr.ee_alter
,ewr.ee_u1u18
,ewr.ee_18u27
,ewr.ee_27u45
,ewr.ee_18u35
,ewr.ee_35u45
,ewr.ee_45u55
,ewr.ee_55u65
,ewr.ee_65u110
,ewr.ea
,ewr.ea_m
,ewr.ea_w
,ewr.ea_alter
,ewr.ea_u1u18
,ewr.ea_18u27
,ewr.ea_27u45
,ewr.ea_45u55
,ewr.ea_55u65
,ewr.ea_65u110
,ewr.mh
,ewr.mh_m
,ewr.mh_w
,ewr.mh_alter
,ewr.mh_u1u18
,ewr.mh_18u27
,ewr.mh_27u45
,ewr.mh_45u55
,ewr.mh_55u65
,ewr.mh_65u110
,ewr.hk_eu15
,ewr.hk_eu27
,ewr.hk_polen
,ewr.hk_ehejug
,ewr.hk_ehesu
,ewr.hk_turk
,ewr.hk_arab
,ewr.hk_sonst
,ewr.hk_nzord,


case 
when mss_prev.status_index > 0.5 then "niedrig"
when mss_prev.status_index < -0.5 then "hoch"
else "mittel"
end as prev_status_klasse_prj,
case 
when mss_prev.dynamik_index > 0.5 then "negativ"
when mss_prev.dynamik_index < -0.5 then "positiv"
else "neutral"
end as prev_dynamik_klasse_prj,
case 
when mss_prev.status_index > 0 then "niedrig"
when mss_prev.status_index <= 0 then "hoch"
else "mittel"
end as prev_status_klasse_prj_bi,
case 
when mss_prev.dynamik_index > 0 then "negativ"
when mss_prev.dynamik_index <= 0 then "positiv"
else "neutral"
end as prev_dynamik_klasse_prj_bi,
case 
when own_idx_prev.sum_idx_points <= -2 then "negativ"
when own_idx_prev.sum_idx_points >= 2 then "positiv"
else "neutral"
end as prev_own_idx_class
,case 
when own_idx_prev.sum_idx_points < 0 then "negativ"
when own_idx_prev.sum_idx_points >= 0 then "positiv"
else "neutral"
end as prev_own_idx_class_bi,
 mss_prev.raum_id         as prev_raum_id
,mss_prev.raum_desc       as prev_raum_desc
,mss_prev.zeit            as prev_zeit
,mss_prev.ew              as prev_ew
,mss_prev.zs1             as prev_zs1
,mss_prev.zs2             as prev_zs2
,mss_prev.zs3             as prev_zs3
,mss_prev.zs4             as prev_zs4
,mss_prev.status_summe    as prev_status_summe
,mss_prev.status_index    as prev_status_index
,mss_prev.status_klasse   as prev_status_klasse
,mss_prev.zd1             as prev_zd1
,mss_prev.zd2             as prev_zd2
,mss_prev.zd3             as prev_zd3
,mss_prev.zd4             as prev_zd4
,mss_prev.dynamik_summe   as prev_dynamik_summe
,mss_prev.dynamik_index   as prev_dynamik_index
,mss_prev.dynamik_klasse  as prev_dynamik_klasse
,mss_prev.s1              as prev_s1
,mss_prev.s2              as prev_s2
,mss_prev.s3              as prev_s3
,mss_prev.s4              as prev_s4
,mss_prev.d1              as prev_d1
,mss_prev.d2              as prev_d2
,mss_prev.d3              as prev_d3
,mss_prev.d4              as prev_d4
,own_idx_prev.k11_msr_points                   as prev_k11_msr_points
,own_idx_prev.dau5_msr_points                  as prev_dau5_msr_points
,own_idx_prev.dau10_msr_points                 as prev_dau10_msr_points
,own_idx_prev.doering_ulbricht_idx_m_points    as prev_doering_ulbricht_idx_m_points
,own_idx_prev.doering_ulbricht_idx_m_value     as prev_doering_ulbricht_idx_m_value
,own_idx_prev.d2_msr_points                    as prev_d2_msr_points
,own_idx_prev.ea_msr_points                    as prev_ea_msr_points
,own_idx_prev.mh_msr_points                    as prev_mh_msr_points
,own_idx_prev.ee_18u35_msr_points              as prev_ee_18u35_msr_points
,own_idx_prev.ee_35u45_msr_points              as prev_ee_35u45_msr_points
,own_idx_prev.doering_ulbricht_idx_b_points    as prev_doering_ulbricht_idx_b_points
,own_idx_prev.doering_ulbricht_idx_b_value     as prev_doering_ulbricht_idx_b_value
,own_idx_prev.sum_idx_points                   as prev_sum_idx_points
,own_idx_prev.sum_idx_value                    as prev_sum_idx_value
,ewr_prev.ee          as prev_ee
,ewr_prev.dau5        as prev_dau5
,ewr_prev.dau10       as prev_dau10
,ewr_prev.ee_m        as prev_ee_m
,ewr_prev.ee_w        as prev_ee_w
,ewr_prev.ee_alter    as prev_ee_alter
,ewr_prev.ee_u1u18    as prev_ee_u1u18
,ewr_prev.ee_18u27    as prev_ee_18u27
,ewr_prev.ee_27u45    as prev_ee_27u45
,ewr_prev.ee_18u35    as prev_ee_18u35
,ewr_prev.ee_35u45    as prev_ee_35u45
,ewr_prev.ee_45u55    as prev_ee_45u55
,ewr_prev.ee_55u65    as prev_ee_55u65
,ewr_prev.ee_65u110   as prev_ee_65u110
,ewr_prev.ea          as prev_ea
,ewr_prev.ea_m        as prev_ea_m
,ewr_prev.ea_w        as prev_ea_w
,ewr_prev.ea_alter    as prev_ea_alter
,ewr_prev.ea_u1u18    as prev_ea_u1u18
,ewr_prev.ea_18u27    as prev_ea_18u27
,ewr_prev.ea_27u45    as prev_ea_27u45
,ewr_prev.ea_45u55    as prev_ea_45u55
,ewr_prev.ea_55u65    as prev_ea_55u65
,ewr_prev.ea_65u110   as prev_ea_65u110
,ewr_prev.mh          as prev_mh
,ewr_prev.mh_m        as prev_mh_m
,ewr_prev.mh_w        as prev_mh_w
,ewr_prev.mh_alter    as prev_mh_alter
,ewr_prev.mh_u1u18    as prev_mh_u1u18
,ewr_prev.mh_18u27    as prev_mh_18u27
,ewr_prev.mh_27u45    as prev_mh_27u45
,ewr_prev.mh_45u55    as prev_mh_45u55
,ewr_prev.mh_55u65    as prev_mh_55u65
,ewr_prev.mh_65u110   as prev_mh_65u110
,ewr_prev.hk_eu15     as prev_hk_eu15
,ewr_prev.hk_eu27     as prev_hk_eu27
,ewr_prev.hk_polen    as prev_hk_polen
,ewr_prev.hk_ehejug   as prev_hk_ehejug
,ewr_prev.hk_ehesu    as prev_hk_ehesu
,ewr_prev.hk_turk     as prev_hk_turk
,ewr_prev.hk_arab     as prev_hk_arab
,ewr_prev.hk_sonst    as prev_hk_sonst
,ewr_prev.hk_nzord    as prev_hk_nzord,


coalesce((d_tourismus_stock / (ewr.ee/1000)),0) as d_tourismus_stock,
coalesce((d_vergnuegung_stock / (ewr.ee/1000)),0) as d_vergnuegung_stock,
coalesce((d_sport_und_erholung_stock / (ewr.ee/1000)),0) as d_sport_und_erholung_stock,
coalesce((d_public_service_stock / (ewr.ee/1000)),0) as d_public_service_stock,
coalesce((d_buero_stock / (ewr.ee/1000)),0) as d_buero_stock,
coalesce((d_mobilitaet_stock / (ewr.ee/1000)),0) as d_mobilitaet_stock,
coalesce((d_sonstiges_stock / (ewr.ee/1000)),0) as d_sonstiges_stock,
coalesce((d_gastronomie_stock / (ewr.ee/1000)),0) as d_gastronomie_stock,
coalesce((d_religion_stock / (ewr.ee/1000)),0) as d_religion_stock,
coalesce((d_oeffentlicher_raum_stock / (ewr.ee/1000)),0) as d_oeffentlicher_raum_stock,
coalesce((d_dienstleistung_stock / (ewr.ee/1000)),0) as d_dienstleistung_stock,
coalesce((d_waren_stock / (ewr.ee/1000)),0) as d_waren_stock,
coalesce((d_leerstand_stock / (ewr.ee/1000)),0) as d_leerstand_stock,
coalesce((d_tourismus_ytd / (ewr.ee/1000)),0) as d_tourismus_ytd,
coalesce((d_vergnuegung_ytd / (ewr.ee/1000)),0) as d_vergnuegung_ytd,
coalesce((d_sport_und_erholung_ytd / (ewr.ee/1000)),0) as d_sport_und_erholung_ytd,
coalesce((d_public_service_ytd / (ewr.ee/1000)),0) as d_public_service_ytd,
coalesce((d_buero_ytd / (ewr.ee/1000)),0) as d_buero_ytd,
coalesce((d_mobilitaet_ytd / (ewr.ee/1000)),0) as d_mobilitaet_ytd,
coalesce((d_sonstiges_ytd / (ewr.ee/1000)),0) as d_sonstiges_ytd,
coalesce((d_gastronomie_ytd / (ewr.ee/1000)),0) as d_gastronomie_ytd,
coalesce((d_religion_ytd / (ewr.ee/1000)),0) as d_religion_ytd,
coalesce((d_oeffentlicher_raum_ytd / (ewr.ee/1000)),0) as d_oeffentlicher_raum_ytd,
coalesce((d_dienstleistung_ytd / (ewr.ee/1000)),0) as d_dienstleistung_ytd,
coalesce((d_waren_ytd / (ewr.ee/1000)),0) as d_waren_ytd,
coalesce((d_leerstand_ytd / (ewr.ee/1000)),0) as d_leerstand_ytd,
coalesce((d_tourismus_new / (ewr.ee/1000)),0) as d_tourismus_new,
coalesce((d_vergnuegung_new / (ewr.ee/1000)),0) as d_vergnuegung_new,
coalesce((d_sport_und_erholung_new / (ewr.ee/1000)),0) as d_sport_und_erholung_new,
coalesce((d_public_service_new / (ewr.ee/1000)),0) as d_public_service_new,
coalesce((d_buero_new / (ewr.ee/1000)),0) as d_buero_new,
coalesce((d_mobilitaet_new / (ewr.ee/1000)),0) as d_mobilitaet_new,
coalesce((d_sonstiges_new / (ewr.ee/1000)),0) as d_sonstiges_new,
coalesce((d_gastronomie_new / (ewr.ee/1000)),0) as d_gastronomie_new,
coalesce((d_religion_new / (ewr.ee/1000)),0) as d_religion_new,
coalesce((d_oeffentlicher_raum_new / (ewr.ee/1000)),0) as d_oeffentlicher_raum_new,
coalesce((d_dienstleistung_new / (ewr.ee/1000)),0) as d_dienstleistung_new,
coalesce((d_waren_new / (ewr.ee/1000)),0) as d_waren_new,
coalesce((d_leerstand_new / (ewr.ee/1000)),0) as d_leerstand_new,


coalesce((c_uebernachtung_stock / (ewr.ee/1000)),0) as c_uebernachtung_stock,
coalesce((c_sehenswuerdigkeit_stock / (ewr.ee/1000)),0) as c_sehenswuerdigkeit_stock,
coalesce((c_kultur_stock / (ewr.ee/1000)),0) as c_kultur_stock,
coalesce((c_info_stock / (ewr.ee/1000)),0) as c_info_stock,
coalesce((c_sport_stock / (ewr.ee/1000)),0) as c_sport_stock,
coalesce((c_erholung_stock / (ewr.ee/1000)),0) as c_erholung_stock,
coalesce((c_zwielicht_stock / (ewr.ee/1000)),0) as c_zwielicht_stock,
coalesce((c_bildung_stock / (ewr.ee/1000)),0) as c_bildung_stock,
coalesce((c_buero_stock / (ewr.ee/1000)),0) as c_buero_stock,
coalesce((c_individual_stock / (ewr.ee/1000)),0) as c_individual_stock,
coalesce((c_hipster_stock / (ewr.ee/1000)),0) as c_hipster_stock,
coalesce((c_sicherheit_stock / (ewr.ee/1000)),0) as c_sicherheit_stock,
coalesce((c_sonstiges_stock / (ewr.ee/1000)),0) as c_sonstiges_stock,
coalesce((c_ausgehen_stock / (ewr.ee/1000)),0) as c_ausgehen_stock,
coalesce((c_gaststaetten_stock / (ewr.ee/1000)),0) as c_gaststaetten_stock,
coalesce((c_sozial_stock / (ewr.ee/1000)),0) as c_sozial_stock,
coalesce((c_cafe_stock / (ewr.ee/1000)),0) as c_cafe_stock,
coalesce((c_religioese_gebaeude_stock / (ewr.ee/1000)),0) as c_religioese_gebaeude_stock,
coalesce((c_post_stock / (ewr.ee/1000)),0) as c_post_stock,
coalesce((c_gesundheit_stock / (ewr.ee/1000)),0) as c_gesundheit_stock,
coalesce((c_wc_stock / (ewr.ee/1000)),0) as c_wc_stock,
coalesce((c_bank_stock / (ewr.ee/1000)),0) as c_bank_stock,
coalesce((c_telefon_stock / (ewr.ee/1000)),0) as c_telefon_stock,
coalesce((c_recycling_stock / (ewr.ee/1000)),0) as c_recycling_stock,
coalesce((c_parkbank_stock / (ewr.ee/1000)),0) as c_parkbank_stock,
coalesce((c_briefe_und_pakete_stock / (ewr.ee/1000)),0) as c_briefe_und_pakete_stock,
coalesce((c_friedhof_stock / (ewr.ee/1000)),0) as c_friedhof_stock,
coalesce((c_automaten_stock / (ewr.ee/1000)),0) as c_automaten_stock,
coalesce((c_oepnv_stock / (ewr.ee/1000)),0) as c_oepnv_stock,
coalesce((c_restaurant_stock / (ewr.ee/1000)),0) as c_restaurant_stock,
coalesce((c_fast_food_stock / (ewr.ee/1000)),0) as c_fast_food_stock,
coalesce((c_friseur_stock / (ewr.ee/1000)),0) as c_friseur_stock,
coalesce((c_essen_und_trinken_stock / (ewr.ee/1000)),0) as c_essen_und_trinken_stock,
coalesce((c_kleidung_stock / (ewr.ee/1000)),0) as c_kleidung_stock,
coalesce((c_sonstige_waren_stock / (ewr.ee/1000)),0) as c_sonstige_waren_stock,
coalesce((c_werkstatt_stock / (ewr.ee/1000)),0) as c_werkstatt_stock,
coalesce((c_kosmetik_und_beauty_stock / (ewr.ee/1000)),0) as c_kosmetik_und_beauty_stock,
coalesce((c_medical_stock / (ewr.ee/1000)),0) as c_medical_stock,
coalesce((c_print_stock / (ewr.ee/1000)),0) as c_print_stock,
coalesce((c_massage_stock / (ewr.ee/1000)),0) as c_massage_stock,
coalesce((c_drogerie_stock / (ewr.ee/1000)),0) as c_drogerie_stock,
coalesce((c_reisen_stock / (ewr.ee/1000)),0) as c_reisen_stock,
coalesce((c_technik_stock / (ewr.ee/1000)),0) as c_technik_stock,
coalesce((c_spielzeug_und_geschenke_stock / (ewr.ee/1000)),0) as c_spielzeug_und_geschenke_stock,
coalesce((c_waescherei_stock / (ewr.ee/1000)),0) as c_waescherei_stock,
coalesce((c_kunst_stock / (ewr.ee/1000)),0) as c_kunst_stock,
coalesce((c_beerdigung_stock / (ewr.ee/1000)),0) as c_beerdigung_stock,
coalesce((c_handwerk_stock / (ewr.ee/1000)),0) as c_handwerk_stock,
coalesce((c_leerstand_stock / (ewr.ee/1000)),0) as c_leerstand_stock,
coalesce((c_sonstiger_shop_stock / (ewr.ee/1000)),0) as c_sonstiger_shop_stock,
coalesce((c_sonstiges_gebaeude_stock / (ewr.ee/1000)),0) as c_sonstiges_gebaeude_stock,
coalesce((c_sonstiges_gelaende_stock / (ewr.ee/1000)),0) as c_sonstiges_gelaende_stock,
coalesce((c_sonstiges_tourismus_stock / (ewr.ee/1000)),0) as c_sonstiges_tourismus_stock,
coalesce((c_uebernachtung_ytd / (ewr.ee/1000)),0) as c_uebernachtung_ytd,
coalesce((c_sehenswuerdigkeit_ytd / (ewr.ee/1000)),0) as c_sehenswuerdigkeit_ytd,
coalesce((c_kultur_ytd / (ewr.ee/1000)),0) as c_kultur_ytd,
coalesce((c_info_ytd / (ewr.ee/1000)),0) as c_info_ytd,
coalesce((c_sport_ytd / (ewr.ee/1000)),0) as c_sport_ytd,
coalesce((c_erholung_ytd / (ewr.ee/1000)),0) as c_erholung_ytd,
coalesce((c_zwielicht_ytd / (ewr.ee/1000)),0) as c_zwielicht_ytd,
coalesce((c_bildung_ytd / (ewr.ee/1000)),0) as c_bildung_ytd,
coalesce((c_buero_ytd / (ewr.ee/1000)),0) as c_buero_ytd,
coalesce((c_individual_ytd / (ewr.ee/1000)),0) as c_individual_ytd,
coalesce((c_hipster_ytd / (ewr.ee/1000)),0) as c_hipster_ytd,
coalesce((c_sicherheit_ytd / (ewr.ee/1000)),0) as c_sicherheit_ytd,
coalesce((c_sonstiges_ytd / (ewr.ee/1000)),0) as c_sonstiges_ytd,
coalesce((c_ausgehen_ytd / (ewr.ee/1000)),0) as c_ausgehen_ytd,
coalesce((c_gaststaetten_ytd / (ewr.ee/1000)),0) as c_gaststaetten_ytd,
coalesce((c_sozial_ytd / (ewr.ee/1000)),0) as c_sozial_ytd,
coalesce((c_cafe_ytd / (ewr.ee/1000)),0) as c_cafe_ytd,
coalesce((c_religioese_gebaeude_ytd / (ewr.ee/1000)),0) as c_religioese_gebaeude_ytd,
coalesce((c_post_ytd / (ewr.ee/1000)),0) as c_post_ytd,
coalesce((c_gesundheit_ytd / (ewr.ee/1000)),0) as c_gesundheit_ytd,
coalesce((c_wc_ytd / (ewr.ee/1000)),0) as c_wc_ytd,
coalesce((c_bank_ytd / (ewr.ee/1000)),0) as c_bank_ytd,
coalesce((c_telefon_ytd / (ewr.ee/1000)),0) as c_telefon_ytd,
coalesce((c_recycling_ytd / (ewr.ee/1000)),0) as c_recycling_ytd,
coalesce((c_parkbank_ytd / (ewr.ee/1000)),0) as c_parkbank_ytd,
coalesce((c_briefe_und_pakete_ytd / (ewr.ee/1000)),0) as c_briefe_und_pakete_ytd,
coalesce((c_friedhof_ytd / (ewr.ee/1000)),0) as c_friedhof_ytd,
coalesce((c_automaten_ytd / (ewr.ee/1000)),0) as c_automaten_ytd,
coalesce((c_oepnv_ytd / (ewr.ee/1000)),0) as c_oepnv_ytd,
coalesce((c_restaurant_ytd / (ewr.ee/1000)),0) as c_restaurant_ytd,
coalesce((c_fast_food_ytd / (ewr.ee/1000)),0) as c_fast_food_ytd,
coalesce((c_friseur_ytd / (ewr.ee/1000)),0) as c_friseur_ytd,
coalesce((c_essen_und_trinken_ytd / (ewr.ee/1000)),0) as c_essen_und_trinken_ytd,
coalesce((c_kleidung_ytd / (ewr.ee/1000)),0) as c_kleidung_ytd,
coalesce((c_sonstige_waren_ytd / (ewr.ee/1000)),0) as c_sonstige_waren_ytd,
coalesce((c_werkstatt_ytd / (ewr.ee/1000)),0) as c_werkstatt_ytd,
coalesce((c_kosmetik_und_beauty_ytd / (ewr.ee/1000)),0) as c_kosmetik_und_beauty_ytd,
coalesce((c_medical_ytd / (ewr.ee/1000)),0) as c_medical_ytd,
coalesce((c_print_ytd / (ewr.ee/1000)),0) as c_print_ytd,
coalesce((c_massage_ytd / (ewr.ee/1000)),0) as c_massage_ytd,
coalesce((c_drogerie_ytd / (ewr.ee/1000)),0) as c_drogerie_ytd,
coalesce((c_reisen_ytd / (ewr.ee/1000)),0) as c_reisen_ytd,
coalesce((c_technik_ytd / (ewr.ee/1000)),0) as c_technik_ytd,
coalesce((c_spielzeug_und_geschenke_ytd / (ewr.ee/1000)),0) as c_spielzeug_und_geschenke_ytd,
coalesce((c_waescherei_ytd / (ewr.ee/1000)),0) as c_waescherei_ytd,
coalesce((c_kunst_ytd / (ewr.ee/1000)),0) as c_kunst_ytd,
coalesce((c_beerdigung_ytd / (ewr.ee/1000)),0) as c_beerdigung_ytd,
coalesce((c_handwerk_ytd / (ewr.ee/1000)),0) as c_handwerk_ytd,
coalesce((c_leerstand_ytd / (ewr.ee/1000)),0) as c_leerstand_ytd,
coalesce((c_sonstiger_shop_ytd / (ewr.ee/1000)),0) as c_sonstiger_shop_ytd,
coalesce((c_sonstiges_gebaeude_ytd / (ewr.ee/1000)),0) as c_sonstiges_gebaeude_ytd,
coalesce((c_sonstiges_gelaende_ytd / (ewr.ee/1000)),0) as c_sonstiges_gelaende_ytd,
coalesce((c_sonstiges_tourismus_ytd / (ewr.ee/1000)),0) as c_sonstiges_tourismus_ytd,
coalesce((c_uebernachtung_new / (ewr.ee/1000)),0) as c_uebernachtung_new,
coalesce((c_sehenswuerdigkeit_new / (ewr.ee/1000)),0) as c_sehenswuerdigkeit_new,
coalesce((c_kultur_new / (ewr.ee/1000)),0) as c_kultur_new,
coalesce((c_info_new / (ewr.ee/1000)),0) as c_info_new,
coalesce((c_sport_new / (ewr.ee/1000)),0) as c_sport_new,
coalesce((c_erholung_new / (ewr.ee/1000)),0) as c_erholung_new,
coalesce((c_zwielicht_new / (ewr.ee/1000)),0) as c_zwielicht_new,
coalesce((c_bildung_new / (ewr.ee/1000)),0) as c_bildung_new,
coalesce((c_buero_new / (ewr.ee/1000)),0) as c_buero_new,
coalesce((c_individual_new / (ewr.ee/1000)),0) as c_individual_new,
coalesce((c_hipster_new / (ewr.ee/1000)),0) as c_hipster_new,
coalesce((c_sicherheit_new / (ewr.ee/1000)),0) as c_sicherheit_new,
coalesce((c_sonstiges_new / (ewr.ee/1000)),0) as c_sonstiges_new,
coalesce((c_ausgehen_new / (ewr.ee/1000)),0) as c_ausgehen_new,
coalesce((c_gaststaetten_new / (ewr.ee/1000)),0) as c_gaststaetten_new,
coalesce((c_sozial_new / (ewr.ee/1000)),0) as c_sozial_new,
coalesce((c_cafe_new / (ewr.ee/1000)),0) as c_cafe_new,
coalesce((c_religioese_gebaeude_new / (ewr.ee/1000)),0) as c_religioese_gebaeude_new,
coalesce((c_post_new / (ewr.ee/1000)),0) as c_post_new,
coalesce((c_gesundheit_new / (ewr.ee/1000)),0) as c_gesundheit_new,
coalesce((c_wc_new / (ewr.ee/1000)),0) as c_wc_new,
coalesce((c_bank_new / (ewr.ee/1000)),0) as c_bank_new,
coalesce((c_telefon_new / (ewr.ee/1000)),0) as c_telefon_new,
coalesce((c_recycling_new / (ewr.ee/1000)),0) as c_recycling_new,
coalesce((c_parkbank_new / (ewr.ee/1000)),0) as c_parkbank_new,
coalesce((c_briefe_und_pakete_new / (ewr.ee/1000)),0) as c_briefe_und_pakete_new,
coalesce((c_friedhof_new / (ewr.ee/1000)),0) as c_friedhof_new,
coalesce((c_automaten_new / (ewr.ee/1000)),0) as c_automaten_new,
coalesce((c_oepnv_new / (ewr.ee/1000)),0) as c_oepnv_new,
coalesce((c_restaurant_new / (ewr.ee/1000)),0) as c_restaurant_new,
coalesce((c_fast_food_new / (ewr.ee/1000)),0) as c_fast_food_new,
coalesce((c_friseur_new / (ewr.ee/1000)),0) as c_friseur_new,
coalesce((c_essen_und_trinken_new / (ewr.ee/1000)),0) as c_essen_und_trinken_new,
coalesce((c_kleidung_new / (ewr.ee/1000)),0) as c_kleidung_new,
coalesce((c_sonstige_waren_new / (ewr.ee/1000)),0) as c_sonstige_waren_new,
coalesce((c_werkstatt_new / (ewr.ee/1000)),0) as c_werkstatt_new,
coalesce((c_kosmetik_und_beauty_new / (ewr.ee/1000)),0) as c_kosmetik_und_beauty_new,
coalesce((c_medical_new / (ewr.ee/1000)),0) as c_medical_new,
coalesce((c_print_new / (ewr.ee/1000)),0) as c_print_new,
coalesce((c_massage_new / (ewr.ee/1000)),0) as c_massage_new,
coalesce((c_drogerie_new / (ewr.ee/1000)),0) as c_drogerie_new,
coalesce((c_reisen_new / (ewr.ee/1000)),0) as c_reisen_new,
coalesce((c_technik_new / (ewr.ee/1000)),0) as c_technik_new,
coalesce((c_spielzeug_und_geschenke_new / (ewr.ee/1000)),0) as c_spielzeug_und_geschenke_new,
coalesce((c_waescherei_new / (ewr.ee/1000)),0) as c_waescherei_new,
coalesce((c_kunst_new / (ewr.ee/1000)),0) as c_kunst_new,
coalesce((c_beerdigung_new / (ewr.ee/1000)),0) as c_beerdigung_new,
coalesce((c_handwerk_new / (ewr.ee/1000)),0) as c_handwerk_new,
coalesce((c_leerstand_new / (ewr.ee/1000)),0) as c_leerstand_new,
coalesce((c_sonstiger_shop_new / (ewr.ee/1000)),0) as c_sonstiger_shop_new,
coalesce((c_sonstiges_gebaeude_new / (ewr.ee/1000)),0) as c_sonstiges_gebaeude_new,
coalesce((c_sonstiges_gelaende_new / (ewr.ee/1000)),0) as c_sonstiges_gelaende_new,
coalesce((c_sonstiges_tourismus_new / (ewr.ee/1000)),0) as c_sonstiges_tourismus_new,


coalesce((t_hostel_ytd / (ewr.ee/1000)),0) as t_hostel_ytd,
coalesce((t_hotel_ytd / (ewr.ee/1000)),0) as t_hotel_ytd,
coalesce((t_sonstige_ytd / (ewr.ee/1000)),0) as t_sonstige_ytd,
coalesce((t_kunstwerk_ytd / (ewr.ee/1000)),0) as t_kunstwerk_ytd,
coalesce((t_kunstzentrum_ytd / (ewr.ee/1000)),0) as t_kunstzentrum_ytd,
coalesce((t_gallerie_ytd / (ewr.ee/1000)),0) as t_gallerie_ytd,
coalesce((t_info_ytd / (ewr.ee/1000)),0) as t_info_ytd,
coalesce((t_museum_ytd / (ewr.ee/1000)),0) as t_museum_ytd,
coalesce((t_aussichtspunkt_ytd / (ewr.ee/1000)),0) as t_aussichtspunkt_ytd,
coalesce((t_zoo_ytd / (ewr.ee/1000)),0) as t_zoo_ytd,
coalesce((t_schwimmen_ytd / (ewr.ee/1000)),0) as t_schwimmen_ytd,
coalesce((t_basketball_ytd / (ewr.ee/1000)),0) as t_basketball_ytd,
coalesce((t_fussball_ytd / (ewr.ee/1000)),0) as t_fussball_ytd,
coalesce((t_sportzentrum_ytd / (ewr.ee/1000)),0) as t_sportzentrum_ytd,
coalesce((t_tischtennis_ytd / (ewr.ee/1000)),0) as t_tischtennis_ytd,
coalesce((t_sauna_ytd / (ewr.ee/1000)),0) as t_sauna_ytd,
coalesce((t_tennis_ytd / (ewr.ee/1000)),0) as t_tennis_ytd,
coalesce((t_kampfsport_ytd / (ewr.ee/1000)),0) as t_kampfsport_ytd,
coalesce((t_fitnesszentrum_ytd / (ewr.ee/1000)),0) as t_fitnesszentrum_ytd,
coalesce((t_spielplatz_ytd / (ewr.ee/1000)),0) as t_spielplatz_ytd,
coalesce((t_wassersport_ytd / (ewr.ee/1000)),0) as t_wassersport_ytd,
coalesce((t_spielothek_ytd / (ewr.ee/1000)),0) as t_spielothek_ytd,
coalesce((t_sonstige_sportarten_ytd / (ewr.ee/1000)),0) as t_sonstige_sportarten_ytd,
coalesce((t_kindergarten_ytd / (ewr.ee/1000)),0) as t_kindergarten_ytd,
coalesce((t_buero_ytd / (ewr.ee/1000)),0) as t_buero_ytd,
coalesce((t_tankstelle_ytd / (ewr.ee/1000)),0) as t_tankstelle_ytd,
coalesce((t_coworking_space_ytd / (ewr.ee/1000)),0) as t_coworking_space_ytd,
coalesce((t_universitaet_ytd / (ewr.ee/1000)),0) as t_universitaet_ytd,
coalesce((t_poilzei_ytd / (ewr.ee/1000)),0) as t_poilzei_ytd,
coalesce((t_feuerwehr_ytd / (ewr.ee/1000)),0) as t_feuerwehr_ytd,
coalesce((t_kita_ytd / (ewr.ee/1000)),0) as t_kita_ytd,
coalesce((t_hoehere_schule_ytd / (ewr.ee/1000)),0) as t_hoehere_schule_ytd,
coalesce((t_wochenmarkt_ytd / (ewr.ee/1000)),0) as t_wochenmarkt_ytd,
coalesce((t_kino_ytd / (ewr.ee/1000)),0) as t_kino_ytd,
coalesce((t_biergarten_ytd / (ewr.ee/1000)),0) as t_biergarten_ytd,
coalesce((t_autovermietung_ytd / (ewr.ee/1000)),0) as t_autovermietung_ytd,
coalesce((t_buecherei_ytd / (ewr.ee/1000)),0) as t_buecherei_ytd,
coalesce((t_nachbarschaftszentrum_ytd / (ewr.ee/1000)),0) as t_nachbarschaftszentrum_ytd,
coalesce((t_theater_ytd / (ewr.ee/1000)),0) as t_theater_ytd,
coalesce((t_eisdiele_ytd / (ewr.ee/1000)),0) as t_eisdiele_ytd,
coalesce((t_nachtclub_ytd / (ewr.ee/1000)),0) as t_nachtclub_ytd,
coalesce((t_kirche_ytd / (ewr.ee/1000)),0) as t_kirche_ytd,
coalesce((t_moschee_ytd / (ewr.ee/1000)),0) as t_moschee_ytd,
coalesce((t_sonstige_tempel_ytd / (ewr.ee/1000)),0) as t_sonstige_tempel_ytd,
coalesce((t_schule_ytd / (ewr.ee/1000)),0) as t_schule_ytd,
coalesce((t_bordell_ytd / (ewr.ee/1000)),0) as t_bordell_ytd,
coalesce((t_post_filiale_ytd / (ewr.ee/1000)),0) as t_post_filiale_ytd,
coalesce((t_sozialeinrichtung_ytd / (ewr.ee/1000)),0) as t_sozialeinrichtung_ytd,
coalesce((t_ladestation_ytd / (ewr.ee/1000)),0) as t_ladestation_ytd,
coalesce((t_zahnarzt_ytd / (ewr.ee/1000)),0) as t_zahnarzt_ytd,
coalesce((t_fahrradverleih_ytd / (ewr.ee/1000)),0) as t_fahrradverleih_ytd,
coalesce((t_fahrschule_ytd / (ewr.ee/1000)),0) as t_fahrschule_ytd,
coalesce((t_tierarzt_ytd / (ewr.ee/1000)),0) as t_tierarzt_ytd,
coalesce((t_botschaft_ytd / (ewr.ee/1000)),0) as t_botschaft_ytd,
coalesce((t_taxistand_ytd / (ewr.ee/1000)),0) as t_taxistand_ytd,
coalesce((t_wc_ytd / (ewr.ee/1000)),0) as t_wc_ytd,
coalesce((t_bankfiliale_ytd / (ewr.ee/1000)),0) as t_bankfiliale_ytd,
coalesce((t_arzt_ytd / (ewr.ee/1000)),0) as t_arzt_ytd,
coalesce((t_parkplatz_ytd / (ewr.ee/1000)),0) as t_parkplatz_ytd,
coalesce((t_bar_ytd / (ewr.ee/1000)),0) as t_bar_ytd,
coalesce((t_apotheke_ytd / (ewr.ee/1000)),0) as t_apotheke_ytd,
coalesce((t_pub_ytd / (ewr.ee/1000)),0) as t_pub_ytd,
coalesce((t_telefon_ytd / (ewr.ee/1000)),0) as t_telefon_ytd,
coalesce((t_kaffee_ytd / (ewr.ee/1000)),0) as t_kaffee_ytd,
coalesce((t_sonstige_cafes_ytd / (ewr.ee/1000)),0) as t_sonstige_cafes_ytd,
coalesce((t_fahrrad_parkplatz_ytd / (ewr.ee/1000)),0) as t_fahrrad_parkplatz_ytd,
coalesce((t_muelleimer_ytd / (ewr.ee/1000)),0) as t_muelleimer_ytd,
coalesce((t_parkbank_ytd / (ewr.ee/1000)),0) as t_parkbank_ytd,
coalesce((t_krankenhaus_ytd / (ewr.ee/1000)),0) as t_krankenhaus_ytd,
coalesce((t_klinik_ytd / (ewr.ee/1000)),0) as t_klinik_ytd,
coalesce((t_geldautomat_ytd / (ewr.ee/1000)),0) as t_geldautomat_ytd,
coalesce((t_briefkasten_ytd / (ewr.ee/1000)),0) as t_briefkasten_ytd,
coalesce((t_friedhof_ytd / (ewr.ee/1000)),0) as t_friedhof_ytd,
coalesce((t_musikschule_ytd / (ewr.ee/1000)),0) as t_musikschule_ytd,
coalesce((t_paketautomat_ytd / (ewr.ee/1000)),0) as t_paketautomat_ytd,
coalesce((t_sonstige_automaten_ytd / (ewr.ee/1000)),0) as t_sonstige_automaten_ytd,
coalesce((t_fahrscheinautomat_ytd / (ewr.ee/1000)),0) as t_fahrscheinautomat_ytd,
coalesce((t_parkticketautomat_ytd / (ewr.ee/1000)),0) as t_parkticketautomat_ytd,
coalesce((t_kotbeutelautomat_ytd / (ewr.ee/1000)),0) as t_kotbeutelautomat_ytd,
coalesce((t_zigarettenautomat_ytd / (ewr.ee/1000)),0) as t_zigarettenautomat_ytd,
coalesce((t_suessigkeitenautomat_ytd / (ewr.ee/1000)),0) as t_suessigkeitenautomat_ytd,
coalesce((t_briefmarkenautomat_ytd / (ewr.ee/1000)),0) as t_briefmarkenautomat_ytd,
coalesce((t_kondomautomat_ytd / (ewr.ee/1000)),0) as t_kondomautomat_ytd,
coalesce((t_getraenke_und_suessigkeitenautomat_ytd / (ewr.ee/1000)),0) as t_getraenke_und_suessigkeitenautomat_ytd,
coalesce((t_getraenkeautomat_ytd / (ewr.ee/1000)),0) as t_getraenkeautomat_ytd,
coalesce((t_grillplatz_ytd / (ewr.ee/1000)),0) as t_grillplatz_ytd,
coalesce((t_glascontainer_ytd / (ewr.ee/1000)),0) as t_glascontainer_ytd,
coalesce((t_glas__und_kleidungscontainer_ytd / (ewr.ee/1000)),0) as t_glas__und_kleidungscontainer_ytd,
coalesce((t_kleidungscontainer_ytd / (ewr.ee/1000)),0) as t_kleidungscontainer_ytd,
coalesce((t_sonstige_container_ytd / (ewr.ee/1000)),0) as t_sonstige_container_ytd,
coalesce((t_restaurant_italiener_ytd / (ewr.ee/1000)),0) as t_restaurant_italiener_ytd,
coalesce((t_restaurant_deutsch_ytd / (ewr.ee/1000)),0) as t_restaurant_deutsch_ytd,
coalesce((t_restaurant_indisch_ytd / (ewr.ee/1000)),0) as t_restaurant_indisch_ytd,
coalesce((t_restaurant_asiatisch_ytd / (ewr.ee/1000)),0) as t_restaurant_asiatisch_ytd,
coalesce((t_restaurant_sushi_ytd / (ewr.ee/1000)),0) as t_restaurant_sushi_ytd,
coalesce((t_restaurant_griechisch_ytd / (ewr.ee/1000)),0) as t_restaurant_griechisch_ytd,
coalesce((t_restaurant_steakhouse_ytd / (ewr.ee/1000)),0) as t_restaurant_steakhouse_ytd,
coalesce((t_restaurant_international_ytd / (ewr.ee/1000)),0) as t_restaurant_international_ytd,
coalesce((t_restaurant_tuerkisch_ytd / (ewr.ee/1000)),0) as t_restaurant_tuerkisch_ytd,
coalesce((t_fastfood_kebap_ytd / (ewr.ee/1000)),0) as t_fastfood_kebap_ytd,
coalesce((t_fastfood_burger_ytd / (ewr.ee/1000)),0) as t_fastfood_burger_ytd,
coalesce((t_fastfood_asiatisch_ytd / (ewr.ee/1000)),0) as t_fastfood_asiatisch_ytd,
coalesce((t_fastfood_pizza_ytd / (ewr.ee/1000)),0) as t_fastfood_pizza_ytd,
coalesce((t_fastfood_pommesbude_ytd / (ewr.ee/1000)),0) as t_fastfood_pommesbude_ytd,
coalesce((t_fast_food_sonstiges_ytd / (ewr.ee/1000)),0) as t_fast_food_sonstiges_ytd,
coalesce((t_restaurant_sonstiges_ytd / (ewr.ee/1000)),0) as t_restaurant_sonstiges_ytd,
coalesce((t_friseur_ytd / (ewr.ee/1000)),0) as t_friseur_ytd,
coalesce((t_baeckerei_ytd / (ewr.ee/1000)),0) as t_baeckerei_ytd,
coalesce((t_kleidung_ytd / (ewr.ee/1000)),0) as t_kleidung_ytd,
coalesce((t_supermarkt_ytd / (ewr.ee/1000)),0) as t_supermarkt_ytd,
coalesce((t_kiosk_ytd / (ewr.ee/1000)),0) as t_kiosk_ytd,
coalesce((t_florist_ytd / (ewr.ee/1000)),0) as t_florist_ytd,
coalesce((t_fahrrad_ytd / (ewr.ee/1000)),0) as t_fahrrad_ytd,
coalesce((t_kosmetik_und_beauty_ytd / (ewr.ee/1000)),0) as t_kosmetik_und_beauty_ytd,
coalesce((t_optiker_ytd / (ewr.ee/1000)),0) as t_optiker_ytd,
coalesce((t_schuhe_ytd / (ewr.ee/1000)),0) as t_schuhe_ytd,
coalesce((t_buecher_ytd / (ewr.ee/1000)),0) as t_buecher_ytd,
coalesce((t_massage_ytd / (ewr.ee/1000)),0) as t_massage_ytd,
coalesce((t_schmuck_ytd / (ewr.ee/1000)),0) as t_schmuck_ytd,
coalesce((t_autoreperatur_ytd / (ewr.ee/1000)),0) as t_autoreperatur_ytd,
coalesce((t_drogerie_ytd / (ewr.ee/1000)),0) as t_drogerie_ytd,
coalesce((t_reisen_ytd / (ewr.ee/1000)),0) as t_reisen_ytd,
coalesce((t_mobilfunk_ytd / (ewr.ee/1000)),0) as t_mobilfunk_ytd,
coalesce((t_moebel_ytd / (ewr.ee/1000)),0) as t_moebel_ytd,
coalesce((t_getraenke_ytd / (ewr.ee/1000)),0) as t_getraenke_ytd,
coalesce((t_feinkost_ytd / (ewr.ee/1000)),0) as t_feinkost_ytd,
coalesce((t_elektronik_ytd / (ewr.ee/1000)),0) as t_elektronik_ytd,
coalesce((t_boutique_ytd / (ewr.ee/1000)),0) as t_boutique_ytd,
coalesce((t_autohaus_ytd / (ewr.ee/1000)),0) as t_autohaus_ytd,
coalesce((t_spirituosen_ytd / (ewr.ee/1000)),0) as t_spirituosen_ytd,
coalesce((t_geschenke_ytd / (ewr.ee/1000)),0) as t_geschenke_ytd,
coalesce((t_postenmarkt_ytd / (ewr.ee/1000)),0) as t_postenmarkt_ytd,
coalesce((t_schlachter_ytd / (ewr.ee/1000)),0) as t_schlachter_ytd,
coalesce((t_waescherei_ytd / (ewr.ee/1000)),0) as t_waescherei_ytd,
coalesce((t_computer_ytd / (ewr.ee/1000)),0) as t_computer_ytd,
coalesce((t_spielzeug_ytd / (ewr.ee/1000)),0) as t_spielzeug_ytd,
coalesce((t_copyshop_ytd / (ewr.ee/1000)),0) as t_copyshop_ytd,
coalesce((t_schneider_ytd / (ewr.ee/1000)),0) as t_schneider_ytd,
coalesce((t_foto_ytd / (ewr.ee/1000)),0) as t_foto_ytd,
coalesce((t_kunst_ytd / (ewr.ee/1000)),0) as t_kunst_ytd,
coalesce((t_suessigkeiten_ytd / (ewr.ee/1000)),0) as t_suessigkeiten_ytd,
coalesce((t_dekoration_ytd / (ewr.ee/1000)),0) as t_dekoration_ytd,
coalesce((t_reinigung_ytd / (ewr.ee/1000)),0) as t_reinigung_ytd,
coalesce((t_beerdigung_ytd / (ewr.ee/1000)),0) as t_beerdigung_ytd,
coalesce((t_sport_ytd / (ewr.ee/1000)),0) as t_sport_ytd,
coalesce((t_zoofachgeschaeft_ytd / (ewr.ee/1000)),0) as t_zoofachgeschaeft_ytd,
coalesce((t_textilgeschaeft_ytd / (ewr.ee/1000)),0) as t_textilgeschaeft_ytd,
coalesce((t_hoergeraete_ytd / (ewr.ee/1000)),0) as t_hoergeraete_ytd,
coalesce((t_baumarkt_ytd / (ewr.ee/1000)),0) as t_baumarkt_ytd,
coalesce((t_leerstand_ytd / (ewr.ee/1000)),0) as t_leerstand_ytd,
coalesce((t_medical_ytd / (ewr.ee/1000)),0) as t_medical_ytd,
coalesce((t_second_hand_ytd / (ewr.ee/1000)),0) as t_second_hand_ytd,
coalesce((t_zeitung_ytd / (ewr.ee/1000)),0) as t_zeitung_ytd,
coalesce((t_eisenwarenhandlung_ytd / (ewr.ee/1000)),0) as t_eisenwarenhandlung_ytd,
coalesce((t_sonstiger_shop_ytd / (ewr.ee/1000)),0) as t_sonstiger_shop_ytd,
coalesce((t_baudenkmal_ytd / (ewr.ee/1000)),0) as t_baudenkmal_ytd,
coalesce((t_haltestelle_ytd / (ewr.ee/1000)),0) as t_haltestelle_ytd,
coalesce((t_sonstiges_gebaeude_ytd / (ewr.ee/1000)),0) as t_sonstiges_gebaeude_ytd,
coalesce((t_sonstiges_gelaende_ytd / (ewr.ee/1000)),0) as t_sonstiges_gelaende_ytd,
coalesce((t_sonstiges_denkmal_ytd / (ewr.ee/1000)),0) as t_sonstiges_denkmal_ytd,
coalesce((t_sonstiges_tourismus_ytd / (ewr.ee/1000)),0) as t_sonstiges_tourismus_ytd,
coalesce((t_sonstiges_sport_ytd / (ewr.ee/1000)),0) as t_sonstiges_sport_ytd,
coalesce((t_sonstiges_erholung_ytd / (ewr.ee/1000)),0) as t_sonstiges_erholung_ytd,
coalesce((t_hostel_stock / (ewr.ee/1000)),0) as t_hostel_stock,
coalesce((t_hotel_stock / (ewr.ee/1000)),0) as t_hotel_stock,
coalesce((t_sonstige_stock / (ewr.ee/1000)),0) as t_sonstige_stock,
coalesce((t_kunstwerk_stock / (ewr.ee/1000)),0) as t_kunstwerk_stock,
coalesce((t_kunstzentrum_stock / (ewr.ee/1000)),0) as t_kunstzentrum_stock,
coalesce((t_gallerie_stock / (ewr.ee/1000)),0) as t_gallerie_stock,
coalesce((t_info_stock / (ewr.ee/1000)),0) as t_info_stock,
coalesce((t_museum_stock / (ewr.ee/1000)),0) as t_museum_stock,
coalesce((t_aussichtspunkt_stock / (ewr.ee/1000)),0) as t_aussichtspunkt_stock,
coalesce((t_zoo_stock / (ewr.ee/1000)),0) as t_zoo_stock,
coalesce((t_schwimmen_stock / (ewr.ee/1000)),0) as t_schwimmen_stock,
coalesce((t_basketball_stock / (ewr.ee/1000)),0) as t_basketball_stock,
coalesce((t_fussball_stock / (ewr.ee/1000)),0) as t_fussball_stock,
coalesce((t_sportzentrum_stock / (ewr.ee/1000)),0) as t_sportzentrum_stock,
coalesce((t_tischtennis_stock / (ewr.ee/1000)),0) as t_tischtennis_stock,
coalesce((t_sauna_stock / (ewr.ee/1000)),0) as t_sauna_stock,
coalesce((t_tennis_stock / (ewr.ee/1000)),0) as t_tennis_stock,
coalesce((t_kampfsport_stock / (ewr.ee/1000)),0) as t_kampfsport_stock,
coalesce((t_fitnesszentrum_stock / (ewr.ee/1000)),0) as t_fitnesszentrum_stock,
coalesce((t_spielplatz_stock / (ewr.ee/1000)),0) as t_spielplatz_stock,
coalesce((t_wassersport_stock / (ewr.ee/1000)),0) as t_wassersport_stock,
coalesce((t_spielothek_stock / (ewr.ee/1000)),0) as t_spielothek_stock,
coalesce((t_sonstige_sportarten_stock / (ewr.ee/1000)),0) as t_sonstige_sportarten_stock,
coalesce((t_kindergarten_stock / (ewr.ee/1000)),0) as t_kindergarten_stock,
coalesce((t_buero_stock / (ewr.ee/1000)),0) as t_buero_stock,
coalesce((t_tankstelle_stock / (ewr.ee/1000)),0) as t_tankstelle_stock,
coalesce((t_coworking_space_stock / (ewr.ee/1000)),0) as t_coworking_space_stock,
coalesce((t_universitaet_stock / (ewr.ee/1000)),0) as t_universitaet_stock,
coalesce((t_poilzei_stock / (ewr.ee/1000)),0) as t_poilzei_stock,
coalesce((t_feuerwehr_stock / (ewr.ee/1000)),0) as t_feuerwehr_stock,
coalesce((t_kita_stock / (ewr.ee/1000)),0) as t_kita_stock,
coalesce((t_hoehere_schule_stock / (ewr.ee/1000)),0) as t_hoehere_schule_stock,
coalesce((t_wochenmarkt_stock / (ewr.ee/1000)),0) as t_wochenmarkt_stock,
coalesce((t_kino_stock / (ewr.ee/1000)),0) as t_kino_stock,
coalesce((t_biergarten_stock / (ewr.ee/1000)),0) as t_biergarten_stock,
coalesce((t_autovermietung_stock / (ewr.ee/1000)),0) as t_autovermietung_stock,
coalesce((t_buecherei_stock / (ewr.ee/1000)),0) as t_buecherei_stock,
coalesce((t_nachbarschaftszentrum_stock / (ewr.ee/1000)),0) as t_nachbarschaftszentrum_stock,
coalesce((t_theater_stock / (ewr.ee/1000)),0) as t_theater_stock,
coalesce((t_eisdiele_stock / (ewr.ee/1000)),0) as t_eisdiele_stock,
coalesce((t_nachtclub_stock / (ewr.ee/1000)),0) as t_nachtclub_stock,
coalesce((t_kirche_stock / (ewr.ee/1000)),0) as t_kirche_stock,
coalesce((t_moschee_stock / (ewr.ee/1000)),0) as t_moschee_stock,
coalesce((t_sonstige_tempel_stock / (ewr.ee/1000)),0) as t_sonstige_tempel_stock,
coalesce((t_schule_stock / (ewr.ee/1000)),0) as t_schule_stock,
coalesce((t_bordell_stock / (ewr.ee/1000)),0) as t_bordell_stock,
coalesce((t_post_filiale_stock / (ewr.ee/1000)),0) as t_post_filiale_stock,
coalesce((t_sozialeinrichtung_stock / (ewr.ee/1000)),0) as t_sozialeinrichtung_stock,
coalesce((t_ladestation_stock / (ewr.ee/1000)),0) as t_ladestation_stock,
coalesce((t_zahnarzt_stock / (ewr.ee/1000)),0) as t_zahnarzt_stock,
coalesce((t_fahrradverleih_stock / (ewr.ee/1000)),0) as t_fahrradverleih_stock,
coalesce((t_fahrschule_stock / (ewr.ee/1000)),0) as t_fahrschule_stock,
coalesce((t_tierarzt_stock / (ewr.ee/1000)),0) as t_tierarzt_stock,
coalesce((t_botschaft_stock / (ewr.ee/1000)),0) as t_botschaft_stock,
coalesce((t_taxistand_stock / (ewr.ee/1000)),0) as t_taxistand_stock,
coalesce((t_wc_stock / (ewr.ee/1000)),0) as t_wc_stock,
coalesce((t_bankfiliale_stock / (ewr.ee/1000)),0) as t_bankfiliale_stock,
coalesce((t_arzt_stock / (ewr.ee/1000)),0) as t_arzt_stock,
coalesce((t_parkplatz_stock / (ewr.ee/1000)),0) as t_parkplatz_stock,
coalesce((t_bar_stock / (ewr.ee/1000)),0) as t_bar_stock,
coalesce((t_apotheke_stock / (ewr.ee/1000)),0) as t_apotheke_stock,
coalesce((t_pub_stock / (ewr.ee/1000)),0) as t_pub_stock,
coalesce((t_telefon_stock / (ewr.ee/1000)),0) as t_telefon_stock,
coalesce((t_kaffee_stock / (ewr.ee/1000)),0) as t_kaffee_stock,
coalesce((t_sonstige_cafes_stock / (ewr.ee/1000)),0) as t_sonstige_cafes_stock,
coalesce((t_fahrrad_parkplatz_stock / (ewr.ee/1000)),0) as t_fahrrad_parkplatz_stock,
coalesce((t_muelleimer_stock / (ewr.ee/1000)),0) as t_muelleimer_stock,
coalesce((t_parkbank_stock / (ewr.ee/1000)),0) as t_parkbank_stock,
coalesce((t_krankenhaus_stock / (ewr.ee/1000)),0) as t_krankenhaus_stock,
coalesce((t_klinik_stock / (ewr.ee/1000)),0) as t_klinik_stock,
coalesce((t_geldautomat_stock / (ewr.ee/1000)),0) as t_geldautomat_stock,
coalesce((t_briefkasten_stock / (ewr.ee/1000)),0) as t_briefkasten_stock,
coalesce((t_friedhof_stock / (ewr.ee/1000)),0) as t_friedhof_stock,
coalesce((t_musikschule_stock / (ewr.ee/1000)),0) as t_musikschule_stock,
coalesce((t_paketautomat_stock / (ewr.ee/1000)),0) as t_paketautomat_stock,
coalesce((t_sonstige_automaten_stock / (ewr.ee/1000)),0) as t_sonstige_automaten_stock,
coalesce((t_fahrscheinautomat_stock / (ewr.ee/1000)),0) as t_fahrscheinautomat_stock,
coalesce((t_parkticketautomat_stock / (ewr.ee/1000)),0) as t_parkticketautomat_stock,
coalesce((t_kotbeutelautomat_stock / (ewr.ee/1000)),0) as t_kotbeutelautomat_stock,
coalesce((t_zigarettenautomat_stock / (ewr.ee/1000)),0) as t_zigarettenautomat_stock,
coalesce((t_suessigkeitenautomat_stock / (ewr.ee/1000)),0) as t_suessigkeitenautomat_stock,
coalesce((t_briefmarkenautomat_stock / (ewr.ee/1000)),0) as t_briefmarkenautomat_stock,
coalesce((t_kondomautomat_stock / (ewr.ee/1000)),0) as t_kondomautomat_stock,
coalesce((t_getraenke_und_suessigkeitenautomat_stock / (ewr.ee/1000)),0) as t_getraenke_und_suessigkeitenautomat_stock,
coalesce((t_getraenkeautomat_stock / (ewr.ee/1000)),0) as t_getraenkeautomat_stock,
coalesce((t_grillplatz_stock / (ewr.ee/1000)),0) as t_grillplatz_stock,
coalesce((t_glascontainer_stock / (ewr.ee/1000)),0) as t_glascontainer_stock,
coalesce((t_glas__und_kleidungscontainer_stock / (ewr.ee/1000)),0) as t_glas__und_kleidungscontainer_stock,
coalesce((t_kleidungscontainer_stock / (ewr.ee/1000)),0) as t_kleidungscontainer_stock,
coalesce((t_sonstige_container_stock / (ewr.ee/1000)),0) as t_sonstige_container_stock,
coalesce((t_restaurant_italiener_stock / (ewr.ee/1000)),0) as t_restaurant_italiener_stock,
coalesce((t_restaurant_deutsch_stock / (ewr.ee/1000)),0) as t_restaurant_deutsch_stock,
coalesce((t_restaurant_indisch_stock / (ewr.ee/1000)),0) as t_restaurant_indisch_stock,
coalesce((t_restaurant_asiatisch_stock / (ewr.ee/1000)),0) as t_restaurant_asiatisch_stock,
coalesce((t_restaurant_sushi_stock / (ewr.ee/1000)),0) as t_restaurant_sushi_stock,
coalesce((t_restaurant_griechisch_stock / (ewr.ee/1000)),0) as t_restaurant_griechisch_stock,
coalesce((t_restaurant_steakhouse_stock / (ewr.ee/1000)),0) as t_restaurant_steakhouse_stock,
coalesce((t_restaurant_international_stock / (ewr.ee/1000)),0) as t_restaurant_international_stock,
coalesce((t_restaurant_tuerkisch_stock / (ewr.ee/1000)),0) as t_restaurant_tuerkisch_stock,
coalesce((t_fastfood_kebap_stock / (ewr.ee/1000)),0) as t_fastfood_kebap_stock,
coalesce((t_fastfood_burger_stock / (ewr.ee/1000)),0) as t_fastfood_burger_stock,
coalesce((t_fastfood_asiatisch_stock / (ewr.ee/1000)),0) as t_fastfood_asiatisch_stock,
coalesce((t_fastfood_pizza_stock / (ewr.ee/1000)),0) as t_fastfood_pizza_stock,
coalesce((t_fastfood_pommesbude_stock / (ewr.ee/1000)),0) as t_fastfood_pommesbude_stock,
coalesce((t_fast_food_sonstiges_stock / (ewr.ee/1000)),0) as t_fast_food_sonstiges_stock,
coalesce((t_restaurant_sonstiges_stock / (ewr.ee/1000)),0) as t_restaurant_sonstiges_stock,
coalesce((t_friseur_stock / (ewr.ee/1000)),0) as t_friseur_stock,
coalesce((t_baeckerei_stock / (ewr.ee/1000)),0) as t_baeckerei_stock,
coalesce((t_kleidung_stock / (ewr.ee/1000)),0) as t_kleidung_stock,
coalesce((t_supermarkt_stock / (ewr.ee/1000)),0) as t_supermarkt_stock,
coalesce((t_kiosk_stock / (ewr.ee/1000)),0) as t_kiosk_stock,
coalesce((t_florist_stock / (ewr.ee/1000)),0) as t_florist_stock,
coalesce((t_fahrrad_stock / (ewr.ee/1000)),0) as t_fahrrad_stock,
coalesce((t_kosmetik_und_beauty_stock / (ewr.ee/1000)),0) as t_kosmetik_und_beauty_stock,
coalesce((t_optiker_stock / (ewr.ee/1000)),0) as t_optiker_stock,
coalesce((t_schuhe_stock / (ewr.ee/1000)),0) as t_schuhe_stock,
coalesce((t_buecher_stock / (ewr.ee/1000)),0) as t_buecher_stock,
coalesce((t_massage_stock / (ewr.ee/1000)),0) as t_massage_stock,
coalesce((t_schmuck_stock / (ewr.ee/1000)),0) as t_schmuck_stock,
coalesce((t_autoreperatur_stock / (ewr.ee/1000)),0) as t_autoreperatur_stock,
coalesce((t_drogerie_stock / (ewr.ee/1000)),0) as t_drogerie_stock,
coalesce((t_reisen_stock / (ewr.ee/1000)),0) as t_reisen_stock,
coalesce((t_mobilfunk_stock / (ewr.ee/1000)),0) as t_mobilfunk_stock,
coalesce((t_moebel_stock / (ewr.ee/1000)),0) as t_moebel_stock,
coalesce((t_getraenke_stock / (ewr.ee/1000)),0) as t_getraenke_stock,
coalesce((t_feinkost_stock / (ewr.ee/1000)),0) as t_feinkost_stock,
coalesce((t_elektronik_stock / (ewr.ee/1000)),0) as t_elektronik_stock,
coalesce((t_boutique_stock / (ewr.ee/1000)),0) as t_boutique_stock,
coalesce((t_autohaus_stock / (ewr.ee/1000)),0) as t_autohaus_stock,
coalesce((t_spirituosen_stock / (ewr.ee/1000)),0) as t_spirituosen_stock,
coalesce((t_geschenke_stock / (ewr.ee/1000)),0) as t_geschenke_stock,
coalesce((t_postenmarkt_stock / (ewr.ee/1000)),0) as t_postenmarkt_stock,
coalesce((t_schlachter_stock / (ewr.ee/1000)),0) as t_schlachter_stock,
coalesce((t_waescherei_stock / (ewr.ee/1000)),0) as t_waescherei_stock,
coalesce((t_computer_stock / (ewr.ee/1000)),0) as t_computer_stock,
coalesce((t_spielzeug_stock / (ewr.ee/1000)),0) as t_spielzeug_stock,
coalesce((t_copyshop_stock / (ewr.ee/1000)),0) as t_copyshop_stock,
coalesce((t_schneider_stock / (ewr.ee/1000)),0) as t_schneider_stock,
coalesce((t_foto_stock / (ewr.ee/1000)),0) as t_foto_stock,
coalesce((t_kunst_stock / (ewr.ee/1000)),0) as t_kunst_stock,
coalesce((t_suessigkeiten_stock / (ewr.ee/1000)),0) as t_suessigkeiten_stock,
coalesce((t_dekoration_stock / (ewr.ee/1000)),0) as t_dekoration_stock,
coalesce((t_reinigung_stock / (ewr.ee/1000)),0) as t_reinigung_stock,
coalesce((t_beerdigung_stock / (ewr.ee/1000)),0) as t_beerdigung_stock,
coalesce((t_sport_stock / (ewr.ee/1000)),0) as t_sport_stock,
coalesce((t_zoofachgeschaeft_stock / (ewr.ee/1000)),0) as t_zoofachgeschaeft_stock,
coalesce((t_textilgeschaeft_stock / (ewr.ee/1000)),0) as t_textilgeschaeft_stock,
coalesce((t_hoergeraete_stock / (ewr.ee/1000)),0) as t_hoergeraete_stock,
coalesce((t_baumarkt_stock / (ewr.ee/1000)),0) as t_baumarkt_stock,
coalesce((t_leerstand_stock / (ewr.ee/1000)),0) as t_leerstand_stock,
coalesce((t_medical_stock / (ewr.ee/1000)),0) as t_medical_stock,
coalesce((t_second_hand_stock / (ewr.ee/1000)),0) as t_second_hand_stock,
coalesce((t_zeitung_stock / (ewr.ee/1000)),0) as t_zeitung_stock,
coalesce((t_eisenwarenhandlung_stock / (ewr.ee/1000)),0) as t_eisenwarenhandlung_stock,
coalesce((t_sonstiger_shop_stock / (ewr.ee/1000)),0) as t_sonstiger_shop_stock,
coalesce((t_baudenkmal_stock / (ewr.ee/1000)),0) as t_baudenkmal_stock,
coalesce((t_haltestelle_stock / (ewr.ee/1000)),0) as t_haltestelle_stock,
coalesce((t_sonstiges_gebaeude_stock / (ewr.ee/1000)),0) as t_sonstiges_gebaeude_stock,
coalesce((t_sonstiges_gelaende_stock / (ewr.ee/1000)),0) as t_sonstiges_gelaende_stock,
coalesce((t_sonstiges_denkmal_stock / (ewr.ee/1000)),0) as t_sonstiges_denkmal_stock,
coalesce((t_sonstiges_tourismus_stock / (ewr.ee/1000)),0) as t_sonstiges_tourismus_stock,
coalesce((t_sonstiges_sport_stock / (ewr.ee/1000)),0) as t_sonstiges_sport_stock,
coalesce((t_sonstiges_erholung_stock / (ewr.ee/1000)),0) as t_sonstiges_erholung_stock,
coalesce((t_hostel_new / (ewr.ee/1000)),0) as t_hostel_new,
coalesce((t_hotel_new / (ewr.ee/1000)),0) as t_hotel_new,
coalesce((t_sonstige_new / (ewr.ee/1000)),0) as t_sonstige_new,
coalesce((t_kunstwerk_new / (ewr.ee/1000)),0) as t_kunstwerk_new,
coalesce((t_kunstzentrum_new / (ewr.ee/1000)),0) as t_kunstzentrum_new,
coalesce((t_gallerie_new / (ewr.ee/1000)),0) as t_gallerie_new,
coalesce((t_info_new / (ewr.ee/1000)),0) as t_info_new,
coalesce((t_museum_new / (ewr.ee/1000)),0) as t_museum_new,
coalesce((t_aussichtspunkt_new / (ewr.ee/1000)),0) as t_aussichtspunkt_new,
coalesce((t_zoo_new / (ewr.ee/1000)),0) as t_zoo_new,
coalesce((t_schwimmen_new / (ewr.ee/1000)),0) as t_schwimmen_new,
coalesce((t_basketball_new / (ewr.ee/1000)),0) as t_basketball_new,
coalesce((t_fussball_new / (ewr.ee/1000)),0) as t_fussball_new,
coalesce((t_sportzentrum_new / (ewr.ee/1000)),0) as t_sportzentrum_new,
coalesce((t_tischtennis_new / (ewr.ee/1000)),0) as t_tischtennis_new,
coalesce((t_sauna_new / (ewr.ee/1000)),0) as t_sauna_new,
coalesce((t_tennis_new / (ewr.ee/1000)),0) as t_tennis_new,
coalesce((t_kampfsport_new / (ewr.ee/1000)),0) as t_kampfsport_new,
coalesce((t_fitnesszentrum_new / (ewr.ee/1000)),0) as t_fitnesszentrum_new,
coalesce((t_spielplatz_new / (ewr.ee/1000)),0) as t_spielplatz_new,
coalesce((t_wassersport_new / (ewr.ee/1000)),0) as t_wassersport_new,
coalesce((t_spielothek_new / (ewr.ee/1000)),0) as t_spielothek_new,
coalesce((t_sonstige_sportarten_new / (ewr.ee/1000)),0) as t_sonstige_sportarten_new,
coalesce((t_kindergarten_new / (ewr.ee/1000)),0) as t_kindergarten_new,
coalesce((t_buero_new / (ewr.ee/1000)),0) as t_buero_new,
coalesce((t_tankstelle_new / (ewr.ee/1000)),0) as t_tankstelle_new,
coalesce((t_coworking_space_new / (ewr.ee/1000)),0) as t_coworking_space_new,
coalesce((t_universitaet_new / (ewr.ee/1000)),0) as t_universitaet_new,
coalesce((t_poilzei_new / (ewr.ee/1000)),0) as t_poilzei_new,
coalesce((t_feuerwehr_new / (ewr.ee/1000)),0) as t_feuerwehr_new,
coalesce((t_kita_new / (ewr.ee/1000)),0) as t_kita_new,
coalesce((t_hoehere_schule_new / (ewr.ee/1000)),0) as t_hoehere_schule_new,
coalesce((t_wochenmarkt_new / (ewr.ee/1000)),0) as t_wochenmarkt_new,
coalesce((t_kino_new / (ewr.ee/1000)),0) as t_kino_new,
coalesce((t_biergarten_new / (ewr.ee/1000)),0) as t_biergarten_new,
coalesce((t_autovermietung_new / (ewr.ee/1000)),0) as t_autovermietung_new,
coalesce((t_buecherei_new / (ewr.ee/1000)),0) as t_buecherei_new,
coalesce((t_nachbarschaftszentrum_new / (ewr.ee/1000)),0) as t_nachbarschaftszentrum_new,
coalesce((t_theater_new / (ewr.ee/1000)),0) as t_theater_new,
coalesce((t_eisdiele_new / (ewr.ee/1000)),0) as t_eisdiele_new,
coalesce((t_nachtclub_new / (ewr.ee/1000)),0) as t_nachtclub_new,
coalesce((t_kirche_new / (ewr.ee/1000)),0) as t_kirche_new,
coalesce((t_moschee_new / (ewr.ee/1000)),0) as t_moschee_new,
coalesce((t_sonstige_tempel_new / (ewr.ee/1000)),0) as t_sonstige_tempel_new,
coalesce((t_schule_new / (ewr.ee/1000)),0) as t_schule_new,
coalesce((t_bordell_new / (ewr.ee/1000)),0) as t_bordell_new,
coalesce((t_post_filiale_new / (ewr.ee/1000)),0) as t_post_filiale_new,
coalesce((t_sozialeinrichtung_new / (ewr.ee/1000)),0) as t_sozialeinrichtung_new,
coalesce((t_ladestation_new / (ewr.ee/1000)),0) as t_ladestation_new,
coalesce((t_zahnarzt_new / (ewr.ee/1000)),0) as t_zahnarzt_new,
coalesce((t_fahrradverleih_new / (ewr.ee/1000)),0) as t_fahrradverleih_new,
coalesce((t_fahrschule_new / (ewr.ee/1000)),0) as t_fahrschule_new,
coalesce((t_tierarzt_new / (ewr.ee/1000)),0) as t_tierarzt_new,
coalesce((t_botschaft_new / (ewr.ee/1000)),0) as t_botschaft_new,
coalesce((t_taxistand_new / (ewr.ee/1000)),0) as t_taxistand_new,
coalesce((t_wc_new / (ewr.ee/1000)),0) as t_wc_new,
coalesce((t_bankfiliale_new / (ewr.ee/1000)),0) as t_bankfiliale_new,
coalesce((t_arzt_new / (ewr.ee/1000)),0) as t_arzt_new,
coalesce((t_parkplatz_new / (ewr.ee/1000)),0) as t_parkplatz_new,
coalesce((t_bar_new / (ewr.ee/1000)),0) as t_bar_new,
coalesce((t_apotheke_new / (ewr.ee/1000)),0) as t_apotheke_new,
coalesce((t_pub_new / (ewr.ee/1000)),0) as t_pub_new,
coalesce((t_telefon_new / (ewr.ee/1000)),0) as t_telefon_new,
coalesce((t_kaffee_new / (ewr.ee/1000)),0) as t_kaffee_new,
coalesce((t_sonstige_cafes_new / (ewr.ee/1000)),0) as t_sonstige_cafes_new,
coalesce((t_fahrrad_parkplatz_new / (ewr.ee/1000)),0) as t_fahrrad_parkplatz_new,
coalesce((t_muelleimer_new / (ewr.ee/1000)),0) as t_muelleimer_new,
coalesce((t_parkbank_new / (ewr.ee/1000)),0) as t_parkbank_new,
coalesce((t_krankenhaus_new / (ewr.ee/1000)),0) as t_krankenhaus_new,
coalesce((t_klinik_new / (ewr.ee/1000)),0) as t_klinik_new,
coalesce((t_geldautomat_new / (ewr.ee/1000)),0) as t_geldautomat_new,
coalesce((t_briefkasten_new / (ewr.ee/1000)),0) as t_briefkasten_new,
coalesce((t_friedhof_new / (ewr.ee/1000)),0) as t_friedhof_new,
coalesce((t_musikschule_new / (ewr.ee/1000)),0) as t_musikschule_new,
coalesce((t_paketautomat_new / (ewr.ee/1000)),0) as t_paketautomat_new,
coalesce((t_sonstige_automaten_new / (ewr.ee/1000)),0) as t_sonstige_automaten_new,
coalesce((t_fahrscheinautomat_new / (ewr.ee/1000)),0) as t_fahrscheinautomat_new,
coalesce((t_parkticketautomat_new / (ewr.ee/1000)),0) as t_parkticketautomat_new,
coalesce((t_kotbeutelautomat_new / (ewr.ee/1000)),0) as t_kotbeutelautomat_new,
coalesce((t_zigarettenautomat_new / (ewr.ee/1000)),0) as t_zigarettenautomat_new,
coalesce((t_suessigkeitenautomat_new / (ewr.ee/1000)),0) as t_suessigkeitenautomat_new,
coalesce((t_briefmarkenautomat_new / (ewr.ee/1000)),0) as t_briefmarkenautomat_new,
coalesce((t_kondomautomat_new / (ewr.ee/1000)),0) as t_kondomautomat_new,
coalesce((t_getraenke_und_suessigkeitenautomat_new / (ewr.ee/1000)),0) as t_getraenke_und_suessigkeitenautomat_new,
coalesce((t_getraenkeautomat_new / (ewr.ee/1000)),0) as t_getraenkeautomat_new,
coalesce((t_grillplatz_new / (ewr.ee/1000)),0) as t_grillplatz_new,
coalesce((t_glascontainer_new / (ewr.ee/1000)),0) as t_glascontainer_new,
coalesce((t_glas__und_kleidungscontainer_new / (ewr.ee/1000)),0) as t_glas__und_kleidungscontainer_new,
coalesce((t_kleidungscontainer_new / (ewr.ee/1000)),0) as t_kleidungscontainer_new,
coalesce((t_sonstige_container_new / (ewr.ee/1000)),0) as t_sonstige_container_new,
coalesce((t_restaurant_italiener_new / (ewr.ee/1000)),0) as t_restaurant_italiener_new,
coalesce((t_restaurant_deutsch_new / (ewr.ee/1000)),0) as t_restaurant_deutsch_new,
coalesce((t_restaurant_indisch_new / (ewr.ee/1000)),0) as t_restaurant_indisch_new,
coalesce((t_restaurant_asiatisch_new / (ewr.ee/1000)),0) as t_restaurant_asiatisch_new,
coalesce((t_restaurant_sushi_new / (ewr.ee/1000)),0) as t_restaurant_sushi_new,
coalesce((t_restaurant_griechisch_new / (ewr.ee/1000)),0) as t_restaurant_griechisch_new,
coalesce((t_restaurant_steakhouse_new / (ewr.ee/1000)),0) as t_restaurant_steakhouse_new,
coalesce((t_restaurant_international_new / (ewr.ee/1000)),0) as t_restaurant_international_new,
coalesce((t_restaurant_tuerkisch_new / (ewr.ee/1000)),0) as t_restaurant_tuerkisch_new,
coalesce((t_fastfood_kebap_new / (ewr.ee/1000)),0) as t_fastfood_kebap_new,
coalesce((t_fastfood_burger_new / (ewr.ee/1000)),0) as t_fastfood_burger_new,
coalesce((t_fastfood_asiatisch_new / (ewr.ee/1000)),0) as t_fastfood_asiatisch_new,
coalesce((t_fastfood_pizza_new / (ewr.ee/1000)),0) as t_fastfood_pizza_new,
coalesce((t_fastfood_pommesbude_new / (ewr.ee/1000)),0) as t_fastfood_pommesbude_new,
coalesce((t_fast_food_sonstiges_new / (ewr.ee/1000)),0) as t_fast_food_sonstiges_new,
coalesce((t_restaurant_sonstiges_new / (ewr.ee/1000)),0) as t_restaurant_sonstiges_new,
coalesce((t_friseur_new / (ewr.ee/1000)),0) as t_friseur_new,
coalesce((t_baeckerei_new / (ewr.ee/1000)),0) as t_baeckerei_new,
coalesce((t_kleidung_new / (ewr.ee/1000)),0) as t_kleidung_new,
coalesce((t_supermarkt_new / (ewr.ee/1000)),0) as t_supermarkt_new,
coalesce((t_kiosk_new / (ewr.ee/1000)),0) as t_kiosk_new,
coalesce((t_florist_new / (ewr.ee/1000)),0) as t_florist_new,
coalesce((t_fahrrad_new / (ewr.ee/1000)),0) as t_fahrrad_new,
coalesce((t_kosmetik_und_beauty_new / (ewr.ee/1000)),0) as t_kosmetik_und_beauty_new,
coalesce((t_optiker_new / (ewr.ee/1000)),0) as t_optiker_new,
coalesce((t_schuhe_new / (ewr.ee/1000)),0) as t_schuhe_new,
coalesce((t_buecher_new / (ewr.ee/1000)),0) as t_buecher_new,
coalesce((t_massage_new / (ewr.ee/1000)),0) as t_massage_new,
coalesce((t_schmuck_new / (ewr.ee/1000)),0) as t_schmuck_new,
coalesce((t_autoreperatur_new / (ewr.ee/1000)),0) as t_autoreperatur_new,
coalesce((t_drogerie_new / (ewr.ee/1000)),0) as t_drogerie_new,
coalesce((t_reisen_new / (ewr.ee/1000)),0) as t_reisen_new,
coalesce((t_mobilfunk_new / (ewr.ee/1000)),0) as t_mobilfunk_new,
coalesce((t_moebel_new / (ewr.ee/1000)),0) as t_moebel_new,
coalesce((t_getraenke_new / (ewr.ee/1000)),0) as t_getraenke_new,
coalesce((t_feinkost_new / (ewr.ee/1000)),0) as t_feinkost_new,
coalesce((t_elektronik_new / (ewr.ee/1000)),0) as t_elektronik_new,
coalesce((t_boutique_new / (ewr.ee/1000)),0) as t_boutique_new,
coalesce((t_autohaus_new / (ewr.ee/1000)),0) as t_autohaus_new,
coalesce((t_spirituosen_new / (ewr.ee/1000)),0) as t_spirituosen_new,
coalesce((t_geschenke_new / (ewr.ee/1000)),0) as t_geschenke_new,
coalesce((t_postenmarkt_new / (ewr.ee/1000)),0) as t_postenmarkt_new,
coalesce((t_schlachter_new / (ewr.ee/1000)),0) as t_schlachter_new,
coalesce((t_waescherei_new / (ewr.ee/1000)),0) as t_waescherei_new,
coalesce((t_computer_new / (ewr.ee/1000)),0) as t_computer_new,
coalesce((t_spielzeug_new / (ewr.ee/1000)),0) as t_spielzeug_new,
coalesce((t_copyshop_new / (ewr.ee/1000)),0) as t_copyshop_new,
coalesce((t_schneider_new / (ewr.ee/1000)),0) as t_schneider_new,
coalesce((t_foto_new / (ewr.ee/1000)),0) as t_foto_new,
coalesce((t_kunst_new / (ewr.ee/1000)),0) as t_kunst_new,
coalesce((t_suessigkeiten_new / (ewr.ee/1000)),0) as t_suessigkeiten_new,
coalesce((t_dekoration_new / (ewr.ee/1000)),0) as t_dekoration_new,
coalesce((t_reinigung_new / (ewr.ee/1000)),0) as t_reinigung_new,
coalesce((t_beerdigung_new / (ewr.ee/1000)),0) as t_beerdigung_new,
coalesce((t_sport_new / (ewr.ee/1000)),0) as t_sport_new,
coalesce((t_zoofachgeschaeft_new / (ewr.ee/1000)),0) as t_zoofachgeschaeft_new,
coalesce((t_textilgeschaeft_new / (ewr.ee/1000)),0) as t_textilgeschaeft_new,
coalesce((t_hoergeraete_new / (ewr.ee/1000)),0) as t_hoergeraete_new,
coalesce((t_baumarkt_new / (ewr.ee/1000)),0) as t_baumarkt_new,
coalesce((t_leerstand_new / (ewr.ee/1000)),0) as t_leerstand_new,
coalesce((t_medical_new / (ewr.ee/1000)),0) as t_medical_new,
coalesce((t_second_hand_new / (ewr.ee/1000)),0) as t_second_hand_new,
coalesce((t_zeitung_new / (ewr.ee/1000)),0) as t_zeitung_new,
coalesce((t_eisenwarenhandlung_new / (ewr.ee/1000)),0) as t_eisenwarenhandlung_new,
coalesce((t_sonstiger_shop_new / (ewr.ee/1000)),0) as t_sonstiger_shop_new,
coalesce((t_baudenkmal_new / (ewr.ee/1000)),0) as t_baudenkmal_new,
coalesce((t_haltestelle_new / (ewr.ee/1000)),0) as t_haltestelle_new,
coalesce((t_sonstiges_gebaeude_new / (ewr.ee/1000)),0) as t_sonstiges_gebaeude_new,
coalesce((t_sonstiges_gelaende_new / (ewr.ee/1000)),0) as t_sonstiges_gelaende_new,
coalesce((t_sonstiges_denkmal_new / (ewr.ee/1000)),0) as t_sonstiges_denkmal_new,
coalesce((t_sonstiges_tourismus_new / (ewr.ee/1000)),0) as t_sonstiges_tourismus_new,
coalesce((t_sonstiges_sport_new / (ewr.ee/1000)),0) as t_sonstiges_sport_new,
coalesce((t_sonstiges_erholung_new / (ewr.ee/1000)),0) as t_sonstiges_erholung_new,

--prev_stock
coalesce(( prev_d_tourismus_stock             / (ewr_prev.ee/1000)),0) as prev_d_tourismus_stock            ,
coalesce(( prev_d_vergnuegung_stock           / (ewr_prev.ee/1000)),0) as prev_d_vergnuegung_stock          ,
coalesce(( prev_d_sport_und_erholung_stock    / (ewr_prev.ee/1000)),0) as prev_d_sport_und_erholung_stock   ,
coalesce(( prev_d_public_service_stock        / (ewr_prev.ee/1000)),0) as prev_d_public_service_stock       ,
coalesce(( prev_d_buero_stock                 / (ewr_prev.ee/1000)),0) as prev_d_buero_stock                ,
coalesce(( prev_d_mobilitaet_stock            / (ewr_prev.ee/1000)),0) as prev_d_mobilitaet_stock           ,
coalesce(( prev_d_sonstiges_stock             / (ewr_prev.ee/1000)),0) as prev_d_sonstiges_stock            ,
coalesce(( prev_d_gastronomie_stock           / (ewr_prev.ee/1000)),0) as prev_d_gastronomie_stock          ,
coalesce(( prev_d_religion_stock              / (ewr_prev.ee/1000)),0) as prev_d_religion_stock             ,
coalesce(( prev_d_oeffentlicher_raum_stock    / (ewr_prev.ee/1000)),0) as prev_d_oeffentlicher_raum_stock   ,
coalesce(( prev_d_dienstleistung_stock        / (ewr_prev.ee/1000)),0) as prev_d_dienstleistung_stock       ,
coalesce(( prev_d_waren_stock                 / (ewr_prev.ee/1000)),0) as prev_d_waren_stock                ,
coalesce(( prev_d_leerstand_stock             / (ewr_prev.ee/1000)),0) as prev_d_leerstand_stock            ,
coalesce(( prev_c_uebernachtung_stock                / (ewr_prev.ee/1000)),0) as prev_c_uebernachtung_stock               ,
coalesce(( prev_c_sehenswuerdigkeit_stock            / (ewr_prev.ee/1000)),0) as prev_c_sehenswuerdigkeit_stock           ,
coalesce(( prev_c_kultur_stock                       / (ewr_prev.ee/1000)),0) as prev_c_kultur_stock                      ,
coalesce(( prev_c_info_stock                         / (ewr_prev.ee/1000)),0) as prev_c_info_stock                        ,
coalesce(( prev_c_sport_stock                        / (ewr_prev.ee/1000)),0) as prev_c_sport_stock                       ,
coalesce(( prev_c_erholung_stock                     / (ewr_prev.ee/1000)),0) as prev_c_erholung_stock                    ,
coalesce(( prev_c_zwielicht_stock                    / (ewr_prev.ee/1000)),0) as prev_c_zwielicht_stock                   ,
coalesce(( prev_c_bildung_stock                      / (ewr_prev.ee/1000)),0) as prev_c_bildung_stock                     ,
coalesce(( prev_c_buero_stock                        / (ewr_prev.ee/1000)),0) as prev_c_buero_stock                       ,
coalesce(( prev_c_individual_stock                   / (ewr_prev.ee/1000)),0) as prev_c_individual_stock                  ,
coalesce(( prev_c_hipster_stock                      / (ewr_prev.ee/1000)),0) as prev_c_hipster_stock                     ,
coalesce(( prev_c_sicherheit_stock                   / (ewr_prev.ee/1000)),0) as prev_c_sicherheit_stock                  ,
coalesce(( prev_c_sonstiges_stock                    / (ewr_prev.ee/1000)),0) as prev_c_sonstiges_stock                   ,
coalesce(( prev_c_ausgehen_stock                     / (ewr_prev.ee/1000)),0) as prev_c_ausgehen_stock                    ,
coalesce(( prev_c_gaststaetten_stock                 / (ewr_prev.ee/1000)),0) as prev_c_gaststaetten_stock                ,
coalesce(( prev_c_sozial_stock                       / (ewr_prev.ee/1000)),0) as prev_c_sozial_stock                      ,
coalesce(( prev_c_cafe_stock                         / (ewr_prev.ee/1000)),0) as prev_c_cafe_stock                        ,
coalesce(( prev_c_religioese_gebaeude_stock          / (ewr_prev.ee/1000)),0) as prev_c_religioese_gebaeude_stock         ,
coalesce(( prev_c_post_stock                         / (ewr_prev.ee/1000)),0) as prev_c_post_stock                        ,
coalesce(( prev_c_gesundheit_stock                   / (ewr_prev.ee/1000)),0) as prev_c_gesundheit_stock                  ,
coalesce(( prev_c_wc_stock                           / (ewr_prev.ee/1000)),0) as prev_c_wc_stock                          ,
coalesce(( prev_c_bank_stock                         / (ewr_prev.ee/1000)),0) as prev_c_bank_stock                        ,
coalesce(( prev_c_telefon_stock                      / (ewr_prev.ee/1000)),0) as prev_c_telefon_stock                     ,
coalesce(( prev_c_recycling_stock                    / (ewr_prev.ee/1000)),0) as prev_c_recycling_stock                   ,
coalesce(( prev_c_parkbank_stock                     / (ewr_prev.ee/1000)),0) as prev_c_parkbank_stock                    ,
coalesce(( prev_c_briefe_und_pakete_stock            / (ewr_prev.ee/1000)),0) as prev_c_briefe_und_pakete_stock           ,
coalesce(( prev_c_friedhof_stock                     / (ewr_prev.ee/1000)),0) as prev_c_friedhof_stock                    ,
coalesce(( prev_c_automaten_stock                    / (ewr_prev.ee/1000)),0) as prev_c_automaten_stock                   ,
coalesce(( prev_c_oepnv_stock                        / (ewr_prev.ee/1000)),0) as prev_c_oepnv_stock                       ,
coalesce(( prev_c_restaurant_stock                   / (ewr_prev.ee/1000)),0) as prev_c_restaurant_stock                  ,
coalesce(( prev_c_fast_food_stock                    / (ewr_prev.ee/1000)),0) as prev_c_fast_food_stock                   ,
coalesce(( prev_c_friseur_stock                      / (ewr_prev.ee/1000)),0) as prev_c_friseur_stock                     ,
coalesce(( prev_c_essen_und_trinken_stock            / (ewr_prev.ee/1000)),0) as prev_c_essen_und_trinken_stock           ,
coalesce(( prev_c_kleidung_stock                     / (ewr_prev.ee/1000)),0) as prev_c_kleidung_stock                    ,
coalesce(( prev_c_sonstige_waren_stock               / (ewr_prev.ee/1000)),0) as prev_c_sonstige_waren_stock              ,
coalesce(( prev_c_werkstatt_stock                    / (ewr_prev.ee/1000)),0) as prev_c_werkstatt_stock                   ,
coalesce(( prev_c_kosmetik_und_beauty_stock          / (ewr_prev.ee/1000)),0) as prev_c_kosmetik_und_beauty_stock         ,
coalesce(( prev_c_medical_stock                      / (ewr_prev.ee/1000)),0) as prev_c_medical_stock                     ,
coalesce(( prev_c_print_stock                        / (ewr_prev.ee/1000)),0) as prev_c_print_stock                       ,
coalesce(( prev_c_massage_stock                      / (ewr_prev.ee/1000)),0) as prev_c_massage_stock                     ,
coalesce(( prev_c_drogerie_stock                     / (ewr_prev.ee/1000)),0) as prev_c_drogerie_stock                    ,
coalesce(( prev_c_reisen_stock                       / (ewr_prev.ee/1000)),0) as prev_c_reisen_stock                      ,
coalesce(( prev_c_technik_stock                      / (ewr_prev.ee/1000)),0) as prev_c_technik_stock                     ,
coalesce(( prev_c_spielzeug_und_geschenke_stock      / (ewr_prev.ee/1000)),0) as prev_c_spielzeug_und_geschenke_stock     ,
coalesce(( prev_c_waescherei_stock                   / (ewr_prev.ee/1000)),0) as prev_c_waescherei_stock                  ,
coalesce(( prev_c_kunst_stock                        / (ewr_prev.ee/1000)),0) as prev_c_kunst_stock                       ,
coalesce(( prev_c_beerdigung_stock                   / (ewr_prev.ee/1000)),0) as prev_c_beerdigung_stock                  ,
coalesce(( prev_c_handwerk_stock                     / (ewr_prev.ee/1000)),0) as prev_c_handwerk_stock                    ,
coalesce(( prev_c_leerstand_stock                    / (ewr_prev.ee/1000)),0) as prev_c_leerstand_stock                   ,
coalesce(( prev_c_sonstiger_shop_stock               / (ewr_prev.ee/1000)),0) as prev_c_sonstiger_shop_stock              ,
coalesce(( prev_c_sonstiges_gebaeude_stock           / (ewr_prev.ee/1000)),0) as prev_c_sonstiges_gebaeude_stock          ,
coalesce(( prev_c_sonstiges_gelaende_stock           / (ewr_prev.ee/1000)),0) as prev_c_sonstiges_gelaende_stock          ,
coalesce(( prev_c_sonstiges_tourismus_stock          / (ewr_prev.ee/1000)),0) as prev_c_sonstiges_tourismus_stock         ,
coalesce(( prev_t_hostel_stock                              / (ewr_prev.ee/1000)),0) as prev_t_hostel_stock                                     ,
coalesce(( prev_t_hotel_stock                               / (ewr_prev.ee/1000)),0) as prev_t_hotel_stock                                      ,
coalesce(( prev_t_sonstige_stock                            / (ewr_prev.ee/1000)),0) as prev_t_sonstige_stock                                   ,
coalesce(( prev_t_kunstwerk_stock                           / (ewr_prev.ee/1000)),0) as prev_t_kunstwerk_stock                                  ,
coalesce(( prev_t_kunstzentrum_stock                        / (ewr_prev.ee/1000)),0) as prev_t_kunstzentrum_stock                               ,
coalesce(( prev_t_gallerie_stock                            / (ewr_prev.ee/1000)),0) as prev_t_gallerie_stock                                   ,
coalesce(( prev_t_info_stock                                / (ewr_prev.ee/1000)),0) as prev_t_info_stock                                       ,
coalesce(( prev_t_museum_stock                              / (ewr_prev.ee/1000)),0) as prev_t_museum_stock                                     ,
coalesce(( prev_t_aussichtspunkt_stock                      / (ewr_prev.ee/1000)),0) as prev_t_aussichtspunkt_stock                             ,
coalesce(( prev_t_zoo_stock                                 / (ewr_prev.ee/1000)),0) as prev_t_zoo_stock                                        ,
coalesce(( prev_t_schwimmen_stock                           / (ewr_prev.ee/1000)),0) as prev_t_schwimmen_stock                                  ,
coalesce(( prev_t_basketball_stock                          / (ewr_prev.ee/1000)),0) as prev_t_basketball_stock                                 ,
coalesce(( prev_t_fussball_stock                            / (ewr_prev.ee/1000)),0) as prev_t_fussball_stock                                   ,
coalesce(( prev_t_sportzentrum_stock                        / (ewr_prev.ee/1000)),0) as prev_t_sportzentrum_stock                               ,
coalesce(( prev_t_tischtennis_stock                         / (ewr_prev.ee/1000)),0) as prev_t_tischtennis_stock                                ,
coalesce(( prev_t_sauna_stock                               / (ewr_prev.ee/1000)),0) as prev_t_sauna_stock                                      ,
coalesce(( prev_t_tennis_stock                              / (ewr_prev.ee/1000)),0) as prev_t_tennis_stock                                     ,
coalesce(( prev_t_kampfsport_stock                          / (ewr_prev.ee/1000)),0) as prev_t_kampfsport_stock                                 ,
coalesce(( prev_t_fitnesszentrum_stock                      / (ewr_prev.ee/1000)),0) as prev_t_fitnesszentrum_stock                             ,
coalesce(( prev_t_spielplatz_stock                          / (ewr_prev.ee/1000)),0) as prev_t_spielplatz_stock                                 ,
coalesce(( prev_t_wassersport_stock                         / (ewr_prev.ee/1000)),0) as prev_t_wassersport_stock                                ,
coalesce(( prev_t_spielothek_stock                          / (ewr_prev.ee/1000)),0) as prev_t_spielothek_stock                                 ,
coalesce(( prev_t_sonstige_sportarten_stock                 / (ewr_prev.ee/1000)),0) as prev_t_sonstige_sportarten_stock                        ,
coalesce(( prev_t_kindergarten_stock                        / (ewr_prev.ee/1000)),0) as prev_t_kindergarten_stock                               ,
coalesce(( prev_t_buero_stock                               / (ewr_prev.ee/1000)),0) as prev_t_buero_stock                                      ,
coalesce(( prev_t_tankstelle_stock                          / (ewr_prev.ee/1000)),0) as prev_t_tankstelle_stock                                 ,
coalesce(( prev_t_coworking_space_stock                     / (ewr_prev.ee/1000)),0) as prev_t_coworking_space_stock                            ,
coalesce(( prev_t_universitaet_stock                        / (ewr_prev.ee/1000)),0) as prev_t_universitaet_stock                               ,
coalesce(( prev_t_poilzei_stock                             / (ewr_prev.ee/1000)),0) as prev_t_poilzei_stock                                    ,
coalesce(( prev_t_feuerwehr_stock                           / (ewr_prev.ee/1000)),0) as prev_t_feuerwehr_stock                                  ,
coalesce(( prev_t_kita_stock                                / (ewr_prev.ee/1000)),0) as prev_t_kita_stock                                       ,
coalesce(( prev_t_hoehere_schule_stock                      / (ewr_prev.ee/1000)),0) as prev_t_hoehere_schule_stock                             ,
coalesce(( prev_t_wochenmarkt_stock                         / (ewr_prev.ee/1000)),0) as prev_t_wochenmarkt_stock                                ,
coalesce(( prev_t_kino_stock                                / (ewr_prev.ee/1000)),0) as prev_t_kino_stock                                       ,
coalesce(( prev_t_biergarten_stock                          / (ewr_prev.ee/1000)),0) as prev_t_biergarten_stock                                 ,
coalesce(( prev_t_autovermietung_stock                      / (ewr_prev.ee/1000)),0) as prev_t_autovermietung_stock                             ,
coalesce(( prev_t_buecherei_stock                           / (ewr_prev.ee/1000)),0) as prev_t_buecherei_stock                                  ,
coalesce(( prev_t_nachbarschaftszentrum_stock               / (ewr_prev.ee/1000)),0) as prev_t_nachbarschaftszentrum_stock                      ,
coalesce(( prev_t_theater_stock                             / (ewr_prev.ee/1000)),0) as prev_t_theater_stock                                    ,
coalesce(( prev_t_eisdiele_stock                            / (ewr_prev.ee/1000)),0) as prev_t_eisdiele_stock                                   ,
coalesce(( prev_t_nachtclub_stock                           / (ewr_prev.ee/1000)),0) as prev_t_nachtclub_stock                                  ,
coalesce(( prev_t_kirche_stock                              / (ewr_prev.ee/1000)),0) as prev_t_kirche_stock                                     ,
coalesce(( prev_t_moschee_stock                             / (ewr_prev.ee/1000)),0) as prev_t_moschee_stock                                    ,
coalesce(( prev_t_sonstige_tempel_stock                     / (ewr_prev.ee/1000)),0) as prev_t_sonstige_tempel_stock                            ,
coalesce(( prev_t_schule_stock                              / (ewr_prev.ee/1000)),0) as prev_t_schule_stock                                     ,
coalesce(( prev_t_bordell_stock                             / (ewr_prev.ee/1000)),0) as prev_t_bordell_stock                                    ,
coalesce(( prev_t_post_filiale_stock                        / (ewr_prev.ee/1000)),0) as prev_t_post_filiale_stock                               ,
coalesce(( prev_t_sozialeinrichtung_stock                   / (ewr_prev.ee/1000)),0) as prev_t_sozialeinrichtung_stock                          ,
coalesce(( prev_t_ladestation_stock                         / (ewr_prev.ee/1000)),0) as prev_t_ladestation_stock                                ,
coalesce(( prev_t_zahnarzt_stock                            / (ewr_prev.ee/1000)),0) as prev_t_zahnarzt_stock                                   ,
coalesce(( prev_t_fahrradverleih_stock                      / (ewr_prev.ee/1000)),0) as prev_t_fahrradverleih_stock                             ,
coalesce(( prev_t_fahrschule_stock                          / (ewr_prev.ee/1000)),0) as prev_t_fahrschule_stock                                 ,
coalesce(( prev_t_tierarzt_stock                            / (ewr_prev.ee/1000)),0) as prev_t_tierarzt_stock                                   ,
coalesce(( prev_t_botschaft_stock                           / (ewr_prev.ee/1000)),0) as prev_t_botschaft_stock                                  ,
coalesce(( prev_t_taxistand_stock                           / (ewr_prev.ee/1000)),0) as prev_t_taxistand_stock                                  ,
coalesce(( prev_t_wc_stock                                  / (ewr_prev.ee/1000)),0) as prev_t_wc_stock                                         ,
coalesce(( prev_t_bankfiliale_stock                         / (ewr_prev.ee/1000)),0) as prev_t_bankfiliale_stock                                ,
coalesce(( prev_t_arzt_stock                                / (ewr_prev.ee/1000)),0) as prev_t_arzt_stock                                       ,
coalesce(( prev_t_parkplatz_stock                           / (ewr_prev.ee/1000)),0) as prev_t_parkplatz_stock                                  ,
coalesce(( prev_t_bar_stock                                 / (ewr_prev.ee/1000)),0) as prev_t_bar_stock                                        ,
coalesce(( prev_t_apotheke_stock                            / (ewr_prev.ee/1000)),0) as prev_t_apotheke_stock                                   ,
coalesce(( prev_t_pub_stock                                 / (ewr_prev.ee/1000)),0) as prev_t_pub_stock                                        ,
coalesce(( prev_t_telefon_stock                             / (ewr_prev.ee/1000)),0) as prev_t_telefon_stock                                    ,
coalesce(( prev_t_kaffee_stock                              / (ewr_prev.ee/1000)),0) as prev_t_kaffee_stock                                     ,
coalesce(( prev_t_sonstige_cafes_stock                      / (ewr_prev.ee/1000)),0) as prev_t_sonstige_cafes_stock                             ,
coalesce(( prev_t_fahrrad_parkplatz_stock                   / (ewr_prev.ee/1000)),0) as prev_t_fahrrad_parkplatz_stock                          ,
coalesce(( prev_t_muelleimer_stock                          / (ewr_prev.ee/1000)),0) as prev_t_muelleimer_stock                                 ,
coalesce(( prev_t_parkbank_stock                            / (ewr_prev.ee/1000)),0) as prev_t_parkbank_stock                                   ,
coalesce(( prev_t_krankenhaus_stock                         / (ewr_prev.ee/1000)),0) as prev_t_krankenhaus_stock                                ,
coalesce(( prev_t_klinik_stock                              / (ewr_prev.ee/1000)),0) as prev_t_klinik_stock                                     ,
coalesce(( prev_t_geldautomat_stock                         / (ewr_prev.ee/1000)),0) as prev_t_geldautomat_stock                                ,
coalesce(( prev_t_briefkasten_stock                         / (ewr_prev.ee/1000)),0) as prev_t_briefkasten_stock                                ,
coalesce(( prev_t_friedhof_stock                            / (ewr_prev.ee/1000)),0) as prev_t_friedhof_stock                                   ,
coalesce(( prev_t_musikschule_stock                         / (ewr_prev.ee/1000)),0) as prev_t_musikschule_stock                                ,
coalesce(( prev_t_paketautomat_stock                        / (ewr_prev.ee/1000)),0) as prev_t_paketautomat_stock                               ,
coalesce(( prev_t_sonstige_automaten_stock                  / (ewr_prev.ee/1000)),0) as prev_t_sonstige_automaten_stock                         ,
coalesce(( prev_t_fahrscheinautomat_stock                   / (ewr_prev.ee/1000)),0) as prev_t_fahrscheinautomat_stock                          ,
coalesce(( prev_t_parkticketautomat_stock                   / (ewr_prev.ee/1000)),0) as prev_t_parkticketautomat_stock                          ,
coalesce(( prev_t_kotbeutelautomat_stock                    / (ewr_prev.ee/1000)),0) as prev_t_kotbeutelautomat_stock                           ,
coalesce(( prev_t_zigarettenautomat_stock                   / (ewr_prev.ee/1000)),0) as prev_t_zigarettenautomat_stock                          ,
coalesce(( prev_t_suessigkeitenautomat_stock                / (ewr_prev.ee/1000)),0) as prev_t_suessigkeitenautomat_stock                       ,
coalesce(( prev_t_briefmarkenautomat_stock                  / (ewr_prev.ee/1000)),0) as prev_t_briefmarkenautomat_stock                         ,
coalesce(( prev_t_kondomautomat_stock                       / (ewr_prev.ee/1000)),0) as prev_t_kondomautomat_stock                              ,
coalesce(( prev_t_getraenke_und_suessigkeitenautomat_stock  / (ewr_prev.ee/1000)),0) as prev_t_getraenke_und_suessigkeitenautomat_stock         ,
coalesce(( prev_t_getraenkeautomat_stock                    / (ewr_prev.ee/1000)),0) as prev_t_getraenkeautomat_stock                           ,
coalesce(( prev_t_grillplatz_stock                          / (ewr_prev.ee/1000)),0) as prev_t_grillplatz_stock                                 ,
coalesce(( prev_t_glascontainer_stock                       / (ewr_prev.ee/1000)),0) as prev_t_glascontainer_stock                              ,
coalesce(( prev_t_glas__und_kleidungscontainer_stock        / (ewr_prev.ee/1000)),0) as prev_t_glas__und_kleidungscontainer_stock               ,
coalesce(( prev_t_kleidungscontainer_stock                  / (ewr_prev.ee/1000)),0) as prev_t_kleidungscontainer_stock                         ,
coalesce(( prev_t_sonstige_container_stock                  / (ewr_prev.ee/1000)),0) as prev_t_sonstige_container_stock                         ,
coalesce(( prev_t_restaurant_italiener_stock                / (ewr_prev.ee/1000)),0) as prev_t_restaurant_italiener_stock                       ,
coalesce(( prev_t_restaurant_deutsch_stock                  / (ewr_prev.ee/1000)),0) as prev_t_restaurant_deutsch_stock                         ,
coalesce(( prev_t_restaurant_indisch_stock                  / (ewr_prev.ee/1000)),0) as prev_t_restaurant_indisch_stock                         ,
coalesce(( prev_t_restaurant_asiatisch_stock                / (ewr_prev.ee/1000)),0) as prev_t_restaurant_asiatisch_stock                       ,
coalesce(( prev_t_restaurant_sushi_stock                    / (ewr_prev.ee/1000)),0) as prev_t_restaurant_sushi_stock                           ,
coalesce(( prev_t_restaurant_griechisch_stock               / (ewr_prev.ee/1000)),0) as prev_t_restaurant_griechisch_stock                      ,
coalesce(( prev_t_restaurant_steakhouse_stock               / (ewr_prev.ee/1000)),0) as prev_t_restaurant_steakhouse_stock                      ,
coalesce(( prev_t_restaurant_international_stock            / (ewr_prev.ee/1000)),0) as prev_t_restaurant_international_stock                   ,
coalesce(( prev_t_restaurant_tuerkisch_stock                / (ewr_prev.ee/1000)),0) as prev_t_restaurant_tuerkisch_stock                       ,
coalesce(( prev_t_fastfood_kebap_stock                      / (ewr_prev.ee/1000)),0) as prev_t_fastfood_kebap_stock                             ,
coalesce(( prev_t_fastfood_burger_stock                     / (ewr_prev.ee/1000)),0) as prev_t_fastfood_burger_stock                            ,
coalesce(( prev_t_fastfood_asiatisch_stock                  / (ewr_prev.ee/1000)),0) as prev_t_fastfood_asiatisch_stock                         ,
coalesce(( prev_t_fastfood_pizza_stock                      / (ewr_prev.ee/1000)),0) as prev_t_fastfood_pizza_stock                             ,
coalesce(( prev_t_fastfood_pommesbude_stock                 / (ewr_prev.ee/1000)),0) as prev_t_fastfood_pommesbude_stock                        ,
coalesce(( prev_t_fast_food_sonstiges_stock                 / (ewr_prev.ee/1000)),0) as prev_t_fast_food_sonstiges_stock                        ,
coalesce(( prev_t_restaurant_sonstiges_stock                / (ewr_prev.ee/1000)),0) as prev_t_restaurant_sonstiges_stock                       ,
coalesce(( prev_t_friseur_stock                             / (ewr_prev.ee/1000)),0) as prev_t_friseur_stock                                    ,
coalesce(( prev_t_baeckerei_stock                           / (ewr_prev.ee/1000)),0) as prev_t_baeckerei_stock                                  ,
coalesce(( prev_t_kleidung_stock                            / (ewr_prev.ee/1000)),0) as prev_t_kleidung_stock                                   ,
coalesce(( prev_t_supermarkt_stock                          / (ewr_prev.ee/1000)),0) as prev_t_supermarkt_stock                                 ,
coalesce(( prev_t_kiosk_stock                               / (ewr_prev.ee/1000)),0) as prev_t_kiosk_stock                                      ,
coalesce(( prev_t_florist_stock                             / (ewr_prev.ee/1000)),0) as prev_t_florist_stock                                    ,
coalesce(( prev_t_fahrrad_stock                             / (ewr_prev.ee/1000)),0) as prev_t_fahrrad_stock                                    ,
coalesce(( prev_t_kosmetik_und_beauty_stock                 / (ewr_prev.ee/1000)),0) as prev_t_kosmetik_und_beauty_stock                        ,
coalesce(( prev_t_optiker_stock                             / (ewr_prev.ee/1000)),0) as prev_t_optiker_stock                                    ,
coalesce(( prev_t_schuhe_stock                              / (ewr_prev.ee/1000)),0) as prev_t_schuhe_stock                                     ,
coalesce(( prev_t_buecher_stock                             / (ewr_prev.ee/1000)),0) as prev_t_buecher_stock                                    ,
coalesce(( prev_t_massage_stock                             / (ewr_prev.ee/1000)),0) as prev_t_massage_stock                                    ,
coalesce(( prev_t_schmuck_stock                             / (ewr_prev.ee/1000)),0) as prev_t_schmuck_stock                                    ,
coalesce(( prev_t_autoreperatur_stock                       / (ewr_prev.ee/1000)),0) as prev_t_autoreperatur_stock                              ,
coalesce(( prev_t_drogerie_stock                            / (ewr_prev.ee/1000)),0) as prev_t_drogerie_stock                                   ,
coalesce(( prev_t_reisen_stock                              / (ewr_prev.ee/1000)),0) as prev_t_reisen_stock                                     ,
coalesce(( prev_t_mobilfunk_stock                           / (ewr_prev.ee/1000)),0) as prev_t_mobilfunk_stock                                  ,
coalesce(( prev_t_moebel_stock                              / (ewr_prev.ee/1000)),0) as prev_t_moebel_stock                                     ,
coalesce(( prev_t_getraenke_stock                           / (ewr_prev.ee/1000)),0) as prev_t_getraenke_stock                                  ,
coalesce(( prev_t_feinkost_stock                            / (ewr_prev.ee/1000)),0) as prev_t_feinkost_stock                                   ,
coalesce(( prev_t_elektronik_stock                          / (ewr_prev.ee/1000)),0) as prev_t_elektronik_stock                                 ,
coalesce(( prev_t_boutique_stock                            / (ewr_prev.ee/1000)),0) as prev_t_boutique_stock                                   ,
coalesce(( prev_t_autohaus_stock                            / (ewr_prev.ee/1000)),0) as prev_t_autohaus_stock                                   ,
coalesce(( prev_t_spirituosen_stock                         / (ewr_prev.ee/1000)),0) as prev_t_spirituosen_stock                                ,
coalesce(( prev_t_geschenke_stock                           / (ewr_prev.ee/1000)),0) as prev_t_geschenke_stock                                  ,
coalesce(( prev_t_postenmarkt_stock                         / (ewr_prev.ee/1000)),0) as prev_t_postenmarkt_stock                                ,
coalesce(( prev_t_schlachter_stock                          / (ewr_prev.ee/1000)),0) as prev_t_schlachter_stock                                 ,
coalesce(( prev_t_waescherei_stock                          / (ewr_prev.ee/1000)),0) as prev_t_waescherei_stock                                 ,
coalesce(( prev_t_computer_stock                            / (ewr_prev.ee/1000)),0) as prev_t_computer_stock                                   ,
coalesce(( prev_t_spielzeug_stock                           / (ewr_prev.ee/1000)),0) as prev_t_spielzeug_stock                                  ,
coalesce(( prev_t_copyshop_stock                            / (ewr_prev.ee/1000)),0) as prev_t_copyshop_stock                                   ,
coalesce(( prev_t_schneider_stock                           / (ewr_prev.ee/1000)),0) as prev_t_schneider_stock                                  ,
coalesce(( prev_t_foto_stock                                / (ewr_prev.ee/1000)),0) as prev_t_foto_stock                                       ,
coalesce(( prev_t_kunst_stock                               / (ewr_prev.ee/1000)),0) as prev_t_kunst_stock                                      ,
coalesce(( prev_t_suessigkeiten_stock                       / (ewr_prev.ee/1000)),0) as prev_t_suessigkeiten_stock                              ,
coalesce(( prev_t_dekoration_stock                          / (ewr_prev.ee/1000)),0) as prev_t_dekoration_stock                                 ,
coalesce(( prev_t_reinigung_stock                           / (ewr_prev.ee/1000)),0) as prev_t_reinigung_stock                                  ,
coalesce(( prev_t_beerdigung_stock                          / (ewr_prev.ee/1000)),0) as prev_t_beerdigung_stock                                 ,
coalesce(( prev_t_sport_stock                               / (ewr_prev.ee/1000)),0) as prev_t_sport_stock                                      ,
coalesce(( prev_t_zoofachgeschaeft_stock                    / (ewr_prev.ee/1000)),0) as prev_t_zoofachgeschaeft_stock                           ,
coalesce(( prev_t_textilgeschaeft_stock                     / (ewr_prev.ee/1000)),0) as prev_t_textilgeschaeft_stock                            ,
coalesce(( prev_t_hoergeraete_stock                         / (ewr_prev.ee/1000)),0) as prev_t_hoergeraete_stock                                ,
coalesce(( prev_t_baumarkt_stock                            / (ewr_prev.ee/1000)),0) as prev_t_baumarkt_stock                                   ,
coalesce(( prev_t_leerstand_stock                           / (ewr_prev.ee/1000)),0) as prev_t_leerstand_stock                                  ,
coalesce(( prev_t_medical_stock                             / (ewr_prev.ee/1000)),0) as prev_t_medical_stock                                    ,
coalesce(( prev_t_second_hand_stock                         / (ewr_prev.ee/1000)),0) as prev_t_second_hand_stock                                ,
coalesce(( prev_t_zeitung_stock                             / (ewr_prev.ee/1000)),0) as prev_t_zeitung_stock                                    ,
coalesce(( prev_t_eisenwarenhandlung_stock                  / (ewr_prev.ee/1000)),0) as prev_t_eisenwarenhandlung_stock                         ,
coalesce(( prev_t_sonstiger_shop_stock                      / (ewr_prev.ee/1000)),0) as prev_t_sonstiger_shop_stock                             ,
coalesce(( prev_t_baudenkmal_stock                          / (ewr_prev.ee/1000)),0) as prev_t_baudenkmal_stock                                 ,
coalesce(( prev_t_haltestelle_stock                         / (ewr_prev.ee/1000)),0) as prev_t_haltestelle_stock                                ,
coalesce(( prev_t_sonstiges_gebaeude_stock                  / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_gebaeude_stock                         ,
coalesce(( prev_t_sonstiges_gelaende_stock                  / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_gelaende_stock                         ,
coalesce(( prev_t_sonstiges_denkmal_stock                   / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_denkmal_stock                          ,
coalesce(( prev_t_sonstiges_tourismus_stock                 / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_tourismus_stock                        ,
coalesce(( prev_t_sonstiges_sport_stock                     / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_sport_stock                            ,
coalesce(( prev_t_sonstiges_erholung_stock                  / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_erholung_stock                         ,

coalesce(( prev_d_tourismus_new             / (ewr_prev.ee/1000)),0) as prev_d_tourismus_new            ,
coalesce(( prev_d_vergnuegung_new           / (ewr_prev.ee/1000)),0) as prev_d_vergnuegung_new          ,
coalesce(( prev_d_sport_und_erholung_new    / (ewr_prev.ee/1000)),0) as prev_d_sport_und_erholung_new   ,
coalesce(( prev_d_public_service_new        / (ewr_prev.ee/1000)),0) as prev_d_public_service_new       ,
coalesce(( prev_d_buero_new                 / (ewr_prev.ee/1000)),0) as prev_d_buero_new                ,
coalesce(( prev_d_mobilitaet_new            / (ewr_prev.ee/1000)),0) as prev_d_mobilitaet_new           ,
coalesce(( prev_d_sonstiges_new             / (ewr_prev.ee/1000)),0) as prev_d_sonstiges_new            ,
coalesce(( prev_d_gastronomie_new           / (ewr_prev.ee/1000)),0) as prev_d_gastronomie_new          ,
coalesce(( prev_d_religion_new              / (ewr_prev.ee/1000)),0) as prev_d_religion_new             ,
coalesce(( prev_d_oeffentlicher_raum_new    / (ewr_prev.ee/1000)),0) as prev_d_oeffentlicher_raum_new   ,
coalesce(( prev_d_dienstleistung_new        / (ewr_prev.ee/1000)),0) as prev_d_dienstleistung_new       ,
coalesce(( prev_d_waren_new                 / (ewr_prev.ee/1000)),0) as prev_d_waren_new                ,
coalesce(( prev_d_leerstand_new             / (ewr_prev.ee/1000)),0) as prev_d_leerstand_new            ,
coalesce(( prev_c_uebernachtung_new                / (ewr_prev.ee/1000)),0) as prev_c_uebernachtung_new               ,
coalesce(( prev_c_sehenswuerdigkeit_new            / (ewr_prev.ee/1000)),0) as prev_c_sehenswuerdigkeit_new           ,
coalesce(( prev_c_kultur_new                       / (ewr_prev.ee/1000)),0) as prev_c_kultur_new                      ,
coalesce(( prev_c_info_new                         / (ewr_prev.ee/1000)),0) as prev_c_info_new                        ,
coalesce(( prev_c_sport_new                        / (ewr_prev.ee/1000)),0) as prev_c_sport_new                       ,
coalesce(( prev_c_erholung_new                     / (ewr_prev.ee/1000)),0) as prev_c_erholung_new                    ,
coalesce(( prev_c_zwielicht_new                    / (ewr_prev.ee/1000)),0) as prev_c_zwielicht_new                   ,
coalesce(( prev_c_bildung_new                      / (ewr_prev.ee/1000)),0) as prev_c_bildung_new                     ,
coalesce(( prev_c_buero_new                        / (ewr_prev.ee/1000)),0) as prev_c_buero_new                       ,
coalesce(( prev_c_individual_new                   / (ewr_prev.ee/1000)),0) as prev_c_individual_new                  ,
coalesce(( prev_c_hipster_new                      / (ewr_prev.ee/1000)),0) as prev_c_hipster_new                     ,
coalesce(( prev_c_sicherheit_new                   / (ewr_prev.ee/1000)),0) as prev_c_sicherheit_new                  ,
coalesce(( prev_c_sonstiges_new                    / (ewr_prev.ee/1000)),0) as prev_c_sonstiges_new                   ,
coalesce(( prev_c_ausgehen_new                     / (ewr_prev.ee/1000)),0) as prev_c_ausgehen_new                    ,
coalesce(( prev_c_gaststaetten_new                 / (ewr_prev.ee/1000)),0) as prev_c_gaststaetten_new                ,
coalesce(( prev_c_sozial_new                       / (ewr_prev.ee/1000)),0) as prev_c_sozial_new                      ,
coalesce(( prev_c_cafe_new                         / (ewr_prev.ee/1000)),0) as prev_c_cafe_new                        ,
coalesce(( prev_c_religioese_gebaeude_new          / (ewr_prev.ee/1000)),0) as prev_c_religioese_gebaeude_new         ,
coalesce(( prev_c_post_new                         / (ewr_prev.ee/1000)),0) as prev_c_post_new                        ,
coalesce(( prev_c_gesundheit_new                   / (ewr_prev.ee/1000)),0) as prev_c_gesundheit_new                  ,
coalesce(( prev_c_wc_new                           / (ewr_prev.ee/1000)),0) as prev_c_wc_new                          ,
coalesce(( prev_c_bank_new                         / (ewr_prev.ee/1000)),0) as prev_c_bank_new                        ,
coalesce(( prev_c_telefon_new                      / (ewr_prev.ee/1000)),0) as prev_c_telefon_new                     ,
coalesce(( prev_c_recycling_new                    / (ewr_prev.ee/1000)),0) as prev_c_recycling_new                   ,
coalesce(( prev_c_parkbank_new                     / (ewr_prev.ee/1000)),0) as prev_c_parkbank_new                    ,
coalesce(( prev_c_briefe_und_pakete_new            / (ewr_prev.ee/1000)),0) as prev_c_briefe_und_pakete_new           ,
coalesce(( prev_c_friedhof_new                     / (ewr_prev.ee/1000)),0) as prev_c_friedhof_new                    ,
coalesce(( prev_c_automaten_new                    / (ewr_prev.ee/1000)),0) as prev_c_automaten_new                   ,
coalesce(( prev_c_oepnv_new                        / (ewr_prev.ee/1000)),0) as prev_c_oepnv_new                       ,
coalesce(( prev_c_restaurant_new                   / (ewr_prev.ee/1000)),0) as prev_c_restaurant_new                  ,
coalesce(( prev_c_fast_food_new                    / (ewr_prev.ee/1000)),0) as prev_c_fast_food_new                   ,
coalesce(( prev_c_friseur_new                      / (ewr_prev.ee/1000)),0) as prev_c_friseur_new                     ,
coalesce(( prev_c_essen_und_trinken_new            / (ewr_prev.ee/1000)),0) as prev_c_essen_und_trinken_new           ,
coalesce(( prev_c_kleidung_new                     / (ewr_prev.ee/1000)),0) as prev_c_kleidung_new                    ,
coalesce(( prev_c_sonstige_waren_new               / (ewr_prev.ee/1000)),0) as prev_c_sonstige_waren_new              ,
coalesce(( prev_c_werkstatt_new                    / (ewr_prev.ee/1000)),0) as prev_c_werkstatt_new                   ,
coalesce(( prev_c_kosmetik_und_beauty_new          / (ewr_prev.ee/1000)),0) as prev_c_kosmetik_und_beauty_new         ,
coalesce(( prev_c_medical_new                      / (ewr_prev.ee/1000)),0) as prev_c_medical_new                     ,
coalesce(( prev_c_print_new                        / (ewr_prev.ee/1000)),0) as prev_c_print_new                       ,
coalesce(( prev_c_massage_new                      / (ewr_prev.ee/1000)),0) as prev_c_massage_new                     ,
coalesce(( prev_c_drogerie_new                     / (ewr_prev.ee/1000)),0) as prev_c_drogerie_new                    ,
coalesce(( prev_c_reisen_new                       / (ewr_prev.ee/1000)),0) as prev_c_reisen_new                      ,
coalesce(( prev_c_technik_new                      / (ewr_prev.ee/1000)),0) as prev_c_technik_new                     ,
coalesce(( prev_c_spielzeug_und_geschenke_new      / (ewr_prev.ee/1000)),0) as prev_c_spielzeug_und_geschenke_new     ,
coalesce(( prev_c_waescherei_new                   / (ewr_prev.ee/1000)),0) as prev_c_waescherei_new                  ,
coalesce(( prev_c_kunst_new                        / (ewr_prev.ee/1000)),0) as prev_c_kunst_new                       ,
coalesce(( prev_c_beerdigung_new                   / (ewr_prev.ee/1000)),0) as prev_c_beerdigung_new                  ,
coalesce(( prev_c_handwerk_new                     / (ewr_prev.ee/1000)),0) as prev_c_handwerk_new                    ,
coalesce(( prev_c_leerstand_new                    / (ewr_prev.ee/1000)),0) as prev_c_leerstand_new                   ,
coalesce(( prev_c_sonstiger_shop_new               / (ewr_prev.ee/1000)),0) as prev_c_sonstiger_shop_new              ,
coalesce(( prev_c_sonstiges_gebaeude_new           / (ewr_prev.ee/1000)),0) as prev_c_sonstiges_gebaeude_new          ,
coalesce(( prev_c_sonstiges_gelaende_new           / (ewr_prev.ee/1000)),0) as prev_c_sonstiges_gelaende_new          ,
coalesce(( prev_c_sonstiges_tourismus_new          / (ewr_prev.ee/1000)),0) as prev_c_sonstiges_tourismus_new         ,
coalesce(( prev_t_hostel_new                              / (ewr_prev.ee/1000)),0) as prev_t_hostel_new                                     ,
coalesce(( prev_t_hotel_new                               / (ewr_prev.ee/1000)),0) as prev_t_hotel_new                                      ,
coalesce(( prev_t_sonstige_new                            / (ewr_prev.ee/1000)),0) as prev_t_sonstige_new                                   ,
coalesce(( prev_t_kunstwerk_new                           / (ewr_prev.ee/1000)),0) as prev_t_kunstwerk_new                                  ,
coalesce(( prev_t_kunstzentrum_new                        / (ewr_prev.ee/1000)),0) as prev_t_kunstzentrum_new                               ,
coalesce(( prev_t_gallerie_new                            / (ewr_prev.ee/1000)),0) as prev_t_gallerie_new                                   ,
coalesce(( prev_t_info_new                                / (ewr_prev.ee/1000)),0) as prev_t_info_new                                       ,
coalesce(( prev_t_museum_new                              / (ewr_prev.ee/1000)),0) as prev_t_museum_new                                     ,
coalesce(( prev_t_aussichtspunkt_new                      / (ewr_prev.ee/1000)),0) as prev_t_aussichtspunkt_new                             ,
coalesce(( prev_t_zoo_new                                 / (ewr_prev.ee/1000)),0) as prev_t_zoo_new                                        ,
coalesce(( prev_t_schwimmen_new                           / (ewr_prev.ee/1000)),0) as prev_t_schwimmen_new                                  ,
coalesce(( prev_t_basketball_new                          / (ewr_prev.ee/1000)),0) as prev_t_basketball_new                                 ,
coalesce(( prev_t_fussball_new                            / (ewr_prev.ee/1000)),0) as prev_t_fussball_new                                   ,
coalesce(( prev_t_sportzentrum_new                        / (ewr_prev.ee/1000)),0) as prev_t_sportzentrum_new                               ,
coalesce(( prev_t_tischtennis_new                         / (ewr_prev.ee/1000)),0) as prev_t_tischtennis_new                                ,
coalesce(( prev_t_sauna_new                               / (ewr_prev.ee/1000)),0) as prev_t_sauna_new                                      ,
coalesce(( prev_t_tennis_new                              / (ewr_prev.ee/1000)),0) as prev_t_tennis_new                                     ,
coalesce(( prev_t_kampfsport_new                          / (ewr_prev.ee/1000)),0) as prev_t_kampfsport_new                                 ,
coalesce(( prev_t_fitnesszentrum_new                      / (ewr_prev.ee/1000)),0) as prev_t_fitnesszentrum_new                             ,
coalesce(( prev_t_spielplatz_new                          / (ewr_prev.ee/1000)),0) as prev_t_spielplatz_new                                 ,
coalesce(( prev_t_wassersport_new                         / (ewr_prev.ee/1000)),0) as prev_t_wassersport_new                                ,
coalesce(( prev_t_spielothek_new                          / (ewr_prev.ee/1000)),0) as prev_t_spielothek_new                                 ,
coalesce(( prev_t_sonstige_sportarten_new                 / (ewr_prev.ee/1000)),0) as prev_t_sonstige_sportarten_new                        ,
coalesce(( prev_t_kindergarten_new                        / (ewr_prev.ee/1000)),0) as prev_t_kindergarten_new                               ,
coalesce(( prev_t_buero_new                               / (ewr_prev.ee/1000)),0) as prev_t_buero_new                                      ,
coalesce(( prev_t_tankstelle_new                          / (ewr_prev.ee/1000)),0) as prev_t_tankstelle_new                                 ,
coalesce(( prev_t_coworking_space_new                     / (ewr_prev.ee/1000)),0) as prev_t_coworking_space_new                            ,
coalesce(( prev_t_universitaet_new                        / (ewr_prev.ee/1000)),0) as prev_t_universitaet_new                               ,
coalesce(( prev_t_poilzei_new                             / (ewr_prev.ee/1000)),0) as prev_t_poilzei_new                                    ,
coalesce(( prev_t_feuerwehr_new                           / (ewr_prev.ee/1000)),0) as prev_t_feuerwehr_new                                  ,
coalesce(( prev_t_kita_new                                / (ewr_prev.ee/1000)),0) as prev_t_kita_new                                       ,
coalesce(( prev_t_hoehere_schule_new                      / (ewr_prev.ee/1000)),0) as prev_t_hoehere_schule_new                             ,
coalesce(( prev_t_wochenmarkt_new                         / (ewr_prev.ee/1000)),0) as prev_t_wochenmarkt_new                                ,
coalesce(( prev_t_kino_new                                / (ewr_prev.ee/1000)),0) as prev_t_kino_new                                       ,
coalesce(( prev_t_biergarten_new                          / (ewr_prev.ee/1000)),0) as prev_t_biergarten_new                                 ,
coalesce(( prev_t_autovermietung_new                      / (ewr_prev.ee/1000)),0) as prev_t_autovermietung_new                             ,
coalesce(( prev_t_buecherei_new                           / (ewr_prev.ee/1000)),0) as prev_t_buecherei_new                                  ,
coalesce(( prev_t_nachbarschaftszentrum_new               / (ewr_prev.ee/1000)),0) as prev_t_nachbarschaftszentrum_new                      ,
coalesce(( prev_t_theater_new                             / (ewr_prev.ee/1000)),0) as prev_t_theater_new                                    ,
coalesce(( prev_t_eisdiele_new                            / (ewr_prev.ee/1000)),0) as prev_t_eisdiele_new                                   ,
coalesce(( prev_t_nachtclub_new                           / (ewr_prev.ee/1000)),0) as prev_t_nachtclub_new                                  ,
coalesce(( prev_t_kirche_new                              / (ewr_prev.ee/1000)),0) as prev_t_kirche_new                                     ,
coalesce(( prev_t_moschee_new                             / (ewr_prev.ee/1000)),0) as prev_t_moschee_new                                    ,
coalesce(( prev_t_sonstige_tempel_new                     / (ewr_prev.ee/1000)),0) as prev_t_sonstige_tempel_new                            ,
coalesce(( prev_t_schule_new                              / (ewr_prev.ee/1000)),0) as prev_t_schule_new                                     ,
coalesce(( prev_t_bordell_new                             / (ewr_prev.ee/1000)),0) as prev_t_bordell_new                                    ,
coalesce(( prev_t_post_filiale_new                        / (ewr_prev.ee/1000)),0) as prev_t_post_filiale_new                               ,
coalesce(( prev_t_sozialeinrichtung_new                   / (ewr_prev.ee/1000)),0) as prev_t_sozialeinrichtung_new                          ,
coalesce(( prev_t_ladestation_new                         / (ewr_prev.ee/1000)),0) as prev_t_ladestation_new                                ,
coalesce(( prev_t_zahnarzt_new                            / (ewr_prev.ee/1000)),0) as prev_t_zahnarzt_new                                   ,
coalesce(( prev_t_fahrradverleih_new                      / (ewr_prev.ee/1000)),0) as prev_t_fahrradverleih_new                             ,
coalesce(( prev_t_fahrschule_new                          / (ewr_prev.ee/1000)),0) as prev_t_fahrschule_new                                 ,
coalesce(( prev_t_tierarzt_new                            / (ewr_prev.ee/1000)),0) as prev_t_tierarzt_new                                   ,
coalesce(( prev_t_botschaft_new                           / (ewr_prev.ee/1000)),0) as prev_t_botschaft_new                                  ,
coalesce(( prev_t_taxistand_new                           / (ewr_prev.ee/1000)),0) as prev_t_taxistand_new                                  ,
coalesce(( prev_t_wc_new                                  / (ewr_prev.ee/1000)),0) as prev_t_wc_new                                         ,
coalesce(( prev_t_bankfiliale_new                         / (ewr_prev.ee/1000)),0) as prev_t_bankfiliale_new                                ,
coalesce(( prev_t_arzt_new                                / (ewr_prev.ee/1000)),0) as prev_t_arzt_new                                       ,
coalesce(( prev_t_parkplatz_new                           / (ewr_prev.ee/1000)),0) as prev_t_parkplatz_new                                  ,
coalesce(( prev_t_bar_new                                 / (ewr_prev.ee/1000)),0) as prev_t_bar_new                                        ,
coalesce(( prev_t_apotheke_new                            / (ewr_prev.ee/1000)),0) as prev_t_apotheke_new                                   ,
coalesce(( prev_t_pub_new                                 / (ewr_prev.ee/1000)),0) as prev_t_pub_new                                        ,
coalesce(( prev_t_telefon_new                             / (ewr_prev.ee/1000)),0) as prev_t_telefon_new                                    ,
coalesce(( prev_t_kaffee_new                              / (ewr_prev.ee/1000)),0) as prev_t_kaffee_new                                     ,
coalesce(( prev_t_sonstige_cafes_new                      / (ewr_prev.ee/1000)),0) as prev_t_sonstige_cafes_new                             ,
coalesce(( prev_t_fahrrad_parkplatz_new                   / (ewr_prev.ee/1000)),0) as prev_t_fahrrad_parkplatz_new                          ,
coalesce(( prev_t_muelleimer_new                          / (ewr_prev.ee/1000)),0) as prev_t_muelleimer_new                                 ,
coalesce(( prev_t_parkbank_new                            / (ewr_prev.ee/1000)),0) as prev_t_parkbank_new                                   ,
coalesce(( prev_t_krankenhaus_new                         / (ewr_prev.ee/1000)),0) as prev_t_krankenhaus_new                                ,
coalesce(( prev_t_klinik_new                              / (ewr_prev.ee/1000)),0) as prev_t_klinik_new                                     ,
coalesce(( prev_t_geldautomat_new                         / (ewr_prev.ee/1000)),0) as prev_t_geldautomat_new                                ,
coalesce(( prev_t_briefkasten_new                         / (ewr_prev.ee/1000)),0) as prev_t_briefkasten_new                                ,
coalesce(( prev_t_friedhof_new                            / (ewr_prev.ee/1000)),0) as prev_t_friedhof_new                                   ,
coalesce(( prev_t_musikschule_new                         / (ewr_prev.ee/1000)),0) as prev_t_musikschule_new                                ,
coalesce(( prev_t_paketautomat_new                        / (ewr_prev.ee/1000)),0) as prev_t_paketautomat_new                               ,
coalesce(( prev_t_sonstige_automaten_new                  / (ewr_prev.ee/1000)),0) as prev_t_sonstige_automaten_new                         ,
coalesce(( prev_t_fahrscheinautomat_new                   / (ewr_prev.ee/1000)),0) as prev_t_fahrscheinautomat_new                          ,
coalesce(( prev_t_parkticketautomat_new                   / (ewr_prev.ee/1000)),0) as prev_t_parkticketautomat_new                          ,
coalesce(( prev_t_kotbeutelautomat_new                    / (ewr_prev.ee/1000)),0) as prev_t_kotbeutelautomat_new                           ,
coalesce(( prev_t_zigarettenautomat_new                   / (ewr_prev.ee/1000)),0) as prev_t_zigarettenautomat_new                          ,
coalesce(( prev_t_suessigkeitenautomat_new                / (ewr_prev.ee/1000)),0) as prev_t_suessigkeitenautomat_new                       ,
coalesce(( prev_t_briefmarkenautomat_new                  / (ewr_prev.ee/1000)),0) as prev_t_briefmarkenautomat_new                         ,
coalesce(( prev_t_kondomautomat_new                       / (ewr_prev.ee/1000)),0) as prev_t_kondomautomat_new                              ,
coalesce(( prev_t_getraenke_und_suessigkeitenautomat_new  / (ewr_prev.ee/1000)),0) as prev_t_getraenke_und_suessigkeitenautomat_new         ,
coalesce(( prev_t_getraenkeautomat_new                    / (ewr_prev.ee/1000)),0) as prev_t_getraenkeautomat_new                           ,
coalesce(( prev_t_grillplatz_new                          / (ewr_prev.ee/1000)),0) as prev_t_grillplatz_new                                 ,
coalesce(( prev_t_glascontainer_new                       / (ewr_prev.ee/1000)),0) as prev_t_glascontainer_new                              ,
coalesce(( prev_t_glas__und_kleidungscontainer_new        / (ewr_prev.ee/1000)),0) as prev_t_glas__und_kleidungscontainer_new               ,
coalesce(( prev_t_kleidungscontainer_new                  / (ewr_prev.ee/1000)),0) as prev_t_kleidungscontainer_new                         ,
coalesce(( prev_t_sonstige_container_new                  / (ewr_prev.ee/1000)),0) as prev_t_sonstige_container_new                         ,
coalesce(( prev_t_restaurant_italiener_new                / (ewr_prev.ee/1000)),0) as prev_t_restaurant_italiener_new                       ,
coalesce(( prev_t_restaurant_deutsch_new                  / (ewr_prev.ee/1000)),0) as prev_t_restaurant_deutsch_new                         ,
coalesce(( prev_t_restaurant_indisch_new                  / (ewr_prev.ee/1000)),0) as prev_t_restaurant_indisch_new                         ,
coalesce(( prev_t_restaurant_asiatisch_new                / (ewr_prev.ee/1000)),0) as prev_t_restaurant_asiatisch_new                       ,
coalesce(( prev_t_restaurant_sushi_new                    / (ewr_prev.ee/1000)),0) as prev_t_restaurant_sushi_new                           ,
coalesce(( prev_t_restaurant_griechisch_new               / (ewr_prev.ee/1000)),0) as prev_t_restaurant_griechisch_new                      ,
coalesce(( prev_t_restaurant_steakhouse_new               / (ewr_prev.ee/1000)),0) as prev_t_restaurant_steakhouse_new                      ,
coalesce(( prev_t_restaurant_international_new            / (ewr_prev.ee/1000)),0) as prev_t_restaurant_international_new                   ,
coalesce(( prev_t_restaurant_tuerkisch_new                / (ewr_prev.ee/1000)),0) as prev_t_restaurant_tuerkisch_new                       ,
coalesce(( prev_t_fastfood_kebap_new                      / (ewr_prev.ee/1000)),0) as prev_t_fastfood_kebap_new                             ,
coalesce(( prev_t_fastfood_burger_new                     / (ewr_prev.ee/1000)),0) as prev_t_fastfood_burger_new                            ,
coalesce(( prev_t_fastfood_asiatisch_new                  / (ewr_prev.ee/1000)),0) as prev_t_fastfood_asiatisch_new                         ,
coalesce(( prev_t_fastfood_pizza_new                      / (ewr_prev.ee/1000)),0) as prev_t_fastfood_pizza_new                             ,
coalesce(( prev_t_fastfood_pommesbude_new                 / (ewr_prev.ee/1000)),0) as prev_t_fastfood_pommesbude_new                        ,
coalesce(( prev_t_fast_food_sonstiges_new                 / (ewr_prev.ee/1000)),0) as prev_t_fast_food_sonstiges_new                        ,
coalesce(( prev_t_restaurant_sonstiges_new                / (ewr_prev.ee/1000)),0) as prev_t_restaurant_sonstiges_new                       ,
coalesce(( prev_t_friseur_new                             / (ewr_prev.ee/1000)),0) as prev_t_friseur_new                                    ,
coalesce(( prev_t_baeckerei_new                           / (ewr_prev.ee/1000)),0) as prev_t_baeckerei_new                                  ,
coalesce(( prev_t_kleidung_new                            / (ewr_prev.ee/1000)),0) as prev_t_kleidung_new                                   ,
coalesce(( prev_t_supermarkt_new                          / (ewr_prev.ee/1000)),0) as prev_t_supermarkt_new                                 ,
coalesce(( prev_t_kiosk_new                               / (ewr_prev.ee/1000)),0) as prev_t_kiosk_new                                      ,
coalesce(( prev_t_florist_new                             / (ewr_prev.ee/1000)),0) as prev_t_florist_new                                    ,
coalesce(( prev_t_fahrrad_new                             / (ewr_prev.ee/1000)),0) as prev_t_fahrrad_new                                    ,
coalesce(( prev_t_kosmetik_und_beauty_new                 / (ewr_prev.ee/1000)),0) as prev_t_kosmetik_und_beauty_new                        ,
coalesce(( prev_t_optiker_new                             / (ewr_prev.ee/1000)),0) as prev_t_optiker_new                                    ,
coalesce(( prev_t_schuhe_new                              / (ewr_prev.ee/1000)),0) as prev_t_schuhe_new                                     ,
coalesce(( prev_t_buecher_new                             / (ewr_prev.ee/1000)),0) as prev_t_buecher_new                                    ,
coalesce(( prev_t_massage_new                             / (ewr_prev.ee/1000)),0) as prev_t_massage_new                                    ,
coalesce(( prev_t_schmuck_new                             / (ewr_prev.ee/1000)),0) as prev_t_schmuck_new                                    ,
coalesce(( prev_t_autoreperatur_new                       / (ewr_prev.ee/1000)),0) as prev_t_autoreperatur_new                              ,
coalesce(( prev_t_drogerie_new                            / (ewr_prev.ee/1000)),0) as prev_t_drogerie_new                                   ,
coalesce(( prev_t_reisen_new                              / (ewr_prev.ee/1000)),0) as prev_t_reisen_new                                     ,
coalesce(( prev_t_mobilfunk_new                           / (ewr_prev.ee/1000)),0) as prev_t_mobilfunk_new                                  ,
coalesce(( prev_t_moebel_new                              / (ewr_prev.ee/1000)),0) as prev_t_moebel_new                                     ,
coalesce(( prev_t_getraenke_new                           / (ewr_prev.ee/1000)),0) as prev_t_getraenke_new                                  ,
coalesce(( prev_t_feinkost_new                            / (ewr_prev.ee/1000)),0) as prev_t_feinkost_new                                   ,
coalesce(( prev_t_elektronik_new                          / (ewr_prev.ee/1000)),0) as prev_t_elektronik_new                                 ,
coalesce(( prev_t_boutique_new                            / (ewr_prev.ee/1000)),0) as prev_t_boutique_new                                   ,
coalesce(( prev_t_autohaus_new                            / (ewr_prev.ee/1000)),0) as prev_t_autohaus_new                                   ,
coalesce(( prev_t_spirituosen_new                         / (ewr_prev.ee/1000)),0) as prev_t_spirituosen_new                                ,
coalesce(( prev_t_geschenke_new                           / (ewr_prev.ee/1000)),0) as prev_t_geschenke_new                                  ,
coalesce(( prev_t_postenmarkt_new                         / (ewr_prev.ee/1000)),0) as prev_t_postenmarkt_new                                ,
coalesce(( prev_t_schlachter_new                          / (ewr_prev.ee/1000)),0) as prev_t_schlachter_new                                 ,
coalesce(( prev_t_waescherei_new                          / (ewr_prev.ee/1000)),0) as prev_t_waescherei_new                                 ,
coalesce(( prev_t_computer_new                            / (ewr_prev.ee/1000)),0) as prev_t_computer_new                                   ,
coalesce(( prev_t_spielzeug_new                           / (ewr_prev.ee/1000)),0) as prev_t_spielzeug_new                                  ,
coalesce(( prev_t_copyshop_new                            / (ewr_prev.ee/1000)),0) as prev_t_copyshop_new                                   ,
coalesce(( prev_t_schneider_new                           / (ewr_prev.ee/1000)),0) as prev_t_schneider_new                                  ,
coalesce(( prev_t_foto_new                                / (ewr_prev.ee/1000)),0) as prev_t_foto_new                                       ,
coalesce(( prev_t_kunst_new                               / (ewr_prev.ee/1000)),0) as prev_t_kunst_new                                      ,
coalesce(( prev_t_suessigkeiten_new                       / (ewr_prev.ee/1000)),0) as prev_t_suessigkeiten_new                              ,
coalesce(( prev_t_dekoration_new                          / (ewr_prev.ee/1000)),0) as prev_t_dekoration_new                                 ,
coalesce(( prev_t_reinigung_new                           / (ewr_prev.ee/1000)),0) as prev_t_reinigung_new                                  ,
coalesce(( prev_t_beerdigung_new                          / (ewr_prev.ee/1000)),0) as prev_t_beerdigung_new                                 ,
coalesce(( prev_t_sport_new                               / (ewr_prev.ee/1000)),0) as prev_t_sport_new                                      ,
coalesce(( prev_t_zoofachgeschaeft_new                    / (ewr_prev.ee/1000)),0) as prev_t_zoofachgeschaeft_new                           ,
coalesce(( prev_t_textilgeschaeft_new                     / (ewr_prev.ee/1000)),0) as prev_t_textilgeschaeft_new                            ,
coalesce(( prev_t_hoergeraete_new                         / (ewr_prev.ee/1000)),0) as prev_t_hoergeraete_new                                ,
coalesce(( prev_t_baumarkt_new                            / (ewr_prev.ee/1000)),0) as prev_t_baumarkt_new                                   ,
coalesce(( prev_t_leerstand_new                           / (ewr_prev.ee/1000)),0) as prev_t_leerstand_new                                  ,
coalesce(( prev_t_medical_new                             / (ewr_prev.ee/1000)),0) as prev_t_medical_new                                    ,
coalesce(( prev_t_second_hand_new                         / (ewr_prev.ee/1000)),0) as prev_t_second_hand_new                                ,
coalesce(( prev_t_zeitung_new                             / (ewr_prev.ee/1000)),0) as prev_t_zeitung_new                                    ,
coalesce(( prev_t_eisenwarenhandlung_new                  / (ewr_prev.ee/1000)),0) as prev_t_eisenwarenhandlung_new                         ,
coalesce(( prev_t_sonstiger_shop_new                      / (ewr_prev.ee/1000)),0) as prev_t_sonstiger_shop_new                             ,
coalesce(( prev_t_baudenkmal_new                          / (ewr_prev.ee/1000)),0) as prev_t_baudenkmal_new                                 ,
coalesce(( prev_t_haltestelle_new                         / (ewr_prev.ee/1000)),0) as prev_t_haltestelle_new                                ,
coalesce(( prev_t_sonstiges_gebaeude_new                  / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_gebaeude_new                         ,
coalesce(( prev_t_sonstiges_gelaende_new                  / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_gelaende_new                         ,
coalesce(( prev_t_sonstiges_denkmal_new                   / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_denkmal_new                          ,
coalesce(( prev_t_sonstiges_tourismus_new                 / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_tourismus_new                        ,
coalesce(( prev_t_sonstiges_sport_new                     / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_sport_new                            ,
coalesce(( prev_t_sonstiges_erholung_new                  / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_erholung_new                         ,

coalesce(( prev_d_tourismus_ytd            / (ewr_prev.ee/1000)),0) as prev_d_tourismus_ytd           ,
coalesce(( prev_d_vergnuegung_ytd          / (ewr_prev.ee/1000)),0) as prev_d_vergnuegung_ytd         ,
coalesce(( prev_d_sport_und_erholung_ytd   / (ewr_prev.ee/1000)),0) as prev_d_sport_und_erholung_ytd  ,
coalesce(( prev_d_public_service_ytd       / (ewr_prev.ee/1000)),0) as prev_d_public_service_ytd      ,
coalesce(( prev_d_buero_ytd                / (ewr_prev.ee/1000)),0) as prev_d_buero_ytd               ,
coalesce(( prev_d_mobilitaet_ytd           / (ewr_prev.ee/1000)),0) as prev_d_mobilitaet_ytd          ,
coalesce(( prev_d_sonstiges_ytd            / (ewr_prev.ee/1000)),0) as prev_d_sonstiges_ytd           ,
coalesce(( prev_d_gastronomie_ytd          / (ewr_prev.ee/1000)),0) as prev_d_gastronomie_ytd         ,
coalesce(( prev_d_religion_ytd             / (ewr_prev.ee/1000)),0) as prev_d_religion_ytd            ,
coalesce(( prev_d_oeffentlicher_raum_ytd   / (ewr_prev.ee/1000)),0) as prev_d_oeffentlicher_raum_ytd  ,
coalesce(( prev_d_dienstleistung_ytd       / (ewr_prev.ee/1000)),0) as prev_d_dienstleistung_ytd      ,
coalesce(( prev_d_waren_ytd                / (ewr_prev.ee/1000)),0) as prev_d_waren_ytd               ,
coalesce(( prev_d_leerstand_ytd            / (ewr_prev.ee/1000)),0) as prev_d_leerstand_ytd           ,
coalesce(( prev_c_uebernachtung_ytd               / (ewr_prev.ee/1000)),0) as prev_c_uebernachtung_ytd              ,
coalesce(( prev_c_sehenswuerdigkeit_ytd           / (ewr_prev.ee/1000)),0) as prev_c_sehenswuerdigkeit_ytd          ,
coalesce(( prev_c_kultur_ytd                      / (ewr_prev.ee/1000)),0) as prev_c_kultur_ytd                     ,
coalesce(( prev_c_info_ytd                        / (ewr_prev.ee/1000)),0) as prev_c_info_ytd                       ,
coalesce(( prev_c_sport_ytd                       / (ewr_prev.ee/1000)),0) as prev_c_sport_ytd                      ,
coalesce(( prev_c_erholung_ytd                    / (ewr_prev.ee/1000)),0) as prev_c_erholung_ytd                   ,
coalesce(( prev_c_zwielicht_ytd                   / (ewr_prev.ee/1000)),0) as prev_c_zwielicht_ytd                  ,
coalesce(( prev_c_bildung_ytd                     / (ewr_prev.ee/1000)),0) as prev_c_bildung_ytd                    ,
coalesce(( prev_c_buero_ytd                       / (ewr_prev.ee/1000)),0) as prev_c_buero_ytd                      ,
coalesce(( prev_c_individual_ytd                  / (ewr_prev.ee/1000)),0) as prev_c_individual_ytd                 ,
coalesce(( prev_c_hipster_ytd                     / (ewr_prev.ee/1000)),0) as prev_c_hipster_ytd                    ,
coalesce(( prev_c_sicherheit_ytd                  / (ewr_prev.ee/1000)),0) as prev_c_sicherheit_ytd                 ,
coalesce(( prev_c_sonstiges_ytd                   / (ewr_prev.ee/1000)),0) as prev_c_sonstiges_ytd                  ,
coalesce(( prev_c_ausgehen_ytd                    / (ewr_prev.ee/1000)),0) as prev_c_ausgehen_ytd                   ,
coalesce(( prev_c_gaststaetten_ytd                / (ewr_prev.ee/1000)),0) as prev_c_gaststaetten_ytd               ,
coalesce(( prev_c_sozial_ytd                      / (ewr_prev.ee/1000)),0) as prev_c_sozial_ytd                     ,
coalesce(( prev_c_cafe_ytd                        / (ewr_prev.ee/1000)),0) as prev_c_cafe_ytd                       ,
coalesce(( prev_c_religioese_gebaeude_ytd         / (ewr_prev.ee/1000)),0) as prev_c_religioese_gebaeude_ytd        ,
coalesce(( prev_c_post_ytd                        / (ewr_prev.ee/1000)),0) as prev_c_post_ytd                       ,
coalesce(( prev_c_gesundheit_ytd                  / (ewr_prev.ee/1000)),0) as prev_c_gesundheit_ytd                 ,
coalesce(( prev_c_wc_ytd                          / (ewr_prev.ee/1000)),0) as prev_c_wc_ytd                         ,
coalesce(( prev_c_bank_ytd                        / (ewr_prev.ee/1000)),0) as prev_c_bank_ytd                       ,
coalesce(( prev_c_telefon_ytd                     / (ewr_prev.ee/1000)),0) as prev_c_telefon_ytd                    ,
coalesce(( prev_c_recycling_ytd                   / (ewr_prev.ee/1000)),0) as prev_c_recycling_ytd                  ,
coalesce(( prev_c_parkbank_ytd                    / (ewr_prev.ee/1000)),0) as prev_c_parkbank_ytd                   ,
coalesce(( prev_c_briefe_und_pakete_ytd           / (ewr_prev.ee/1000)),0) as prev_c_briefe_und_pakete_ytd          ,
coalesce(( prev_c_friedhof_ytd                    / (ewr_prev.ee/1000)),0) as prev_c_friedhof_ytd                   ,
coalesce(( prev_c_automaten_ytd                   / (ewr_prev.ee/1000)),0) as prev_c_automaten_ytd                  ,
coalesce(( prev_c_oepnv_ytd                       / (ewr_prev.ee/1000)),0) as prev_c_oepnv_ytd                      ,
coalesce(( prev_c_restaurant_ytd                  / (ewr_prev.ee/1000)),0) as prev_c_restaurant_ytd                 ,
coalesce(( prev_c_fast_food_ytd                   / (ewr_prev.ee/1000)),0) as prev_c_fast_food_ytd                  ,
coalesce(( prev_c_friseur_ytd                     / (ewr_prev.ee/1000)),0) as prev_c_friseur_ytd                    ,
coalesce(( prev_c_essen_und_trinken_ytd           / (ewr_prev.ee/1000)),0) as prev_c_essen_und_trinken_ytd          ,
coalesce(( prev_c_kleidung_ytd                    / (ewr_prev.ee/1000)),0) as prev_c_kleidung_ytd                   ,
coalesce(( prev_c_sonstige_waren_ytd              / (ewr_prev.ee/1000)),0) as prev_c_sonstige_waren_ytd             ,
coalesce(( prev_c_werkstatt_ytd                   / (ewr_prev.ee/1000)),0) as prev_c_werkstatt_ytd                  ,
coalesce(( prev_c_kosmetik_und_beauty_ytd         / (ewr_prev.ee/1000)),0) as prev_c_kosmetik_und_beauty_ytd        ,
coalesce(( prev_c_medical_ytd                     / (ewr_prev.ee/1000)),0) as prev_c_medical_ytd                    ,
coalesce(( prev_c_print_ytd                       / (ewr_prev.ee/1000)),0) as prev_c_print_ytd                      ,
coalesce(( prev_c_massage_ytd                     / (ewr_prev.ee/1000)),0) as prev_c_massage_ytd                    ,
coalesce(( prev_c_drogerie_ytd                    / (ewr_prev.ee/1000)),0) as prev_c_drogerie_ytd                   ,
coalesce(( prev_c_reisen_ytd                      / (ewr_prev.ee/1000)),0) as prev_c_reisen_ytd                     ,
coalesce(( prev_c_technik_ytd                     / (ewr_prev.ee/1000)),0) as prev_c_technik_ytd                    ,
coalesce(( prev_c_spielzeug_und_geschenke_ytd     / (ewr_prev.ee/1000)),0) as prev_c_spielzeug_und_geschenke_ytd    ,
coalesce(( prev_c_waescherei_ytd                  / (ewr_prev.ee/1000)),0) as prev_c_waescherei_ytd                 ,
coalesce(( prev_c_kunst_ytd                       / (ewr_prev.ee/1000)),0) as prev_c_kunst_ytd                      ,
coalesce(( prev_c_beerdigung_ytd                  / (ewr_prev.ee/1000)),0) as prev_c_beerdigung_ytd                 ,
coalesce(( prev_c_handwerk_ytd                    / (ewr_prev.ee/1000)),0) as prev_c_handwerk_ytd                   ,
coalesce(( prev_c_leerstand_ytd                   / (ewr_prev.ee/1000)),0) as prev_c_leerstand_ytd                  ,
coalesce(( prev_c_sonstiger_shop_ytd              / (ewr_prev.ee/1000)),0) as prev_c_sonstiger_shop_ytd             ,
coalesce(( prev_c_sonstiges_gebaeude_ytd          / (ewr_prev.ee/1000)),0) as prev_c_sonstiges_gebaeude_ytd         ,
coalesce(( prev_c_sonstiges_gelaende_ytd          / (ewr_prev.ee/1000)),0) as prev_c_sonstiges_gelaende_ytd         ,
coalesce(( prev_c_sonstiges_tourismus_ytd         / (ewr_prev.ee/1000)),0) as prev_c_sonstiges_tourismus_ytd        ,
coalesce(( prev_t_hostel_ytd                             / (ewr_prev.ee/1000)),0) as prev_t_hostel_ytd                                    ,
coalesce(( prev_t_hotel_ytd                              / (ewr_prev.ee/1000)),0) as prev_t_hotel_ytd                                     ,
coalesce(( prev_t_sonstige_ytd                           / (ewr_prev.ee/1000)),0) as prev_t_sonstige_ytd                                  ,
coalesce(( prev_t_kunstwerk_ytd                          / (ewr_prev.ee/1000)),0) as prev_t_kunstwerk_ytd                                 ,
coalesce(( prev_t_kunstzentrum_ytd                       / (ewr_prev.ee/1000)),0) as prev_t_kunstzentrum_ytd                              ,
coalesce(( prev_t_gallerie_ytd                           / (ewr_prev.ee/1000)),0) as prev_t_gallerie_ytd                                  ,
coalesce(( prev_t_info_ytd                               / (ewr_prev.ee/1000)),0) as prev_t_info_ytd                                      ,
coalesce(( prev_t_museum_ytd                             / (ewr_prev.ee/1000)),0) as prev_t_museum_ytd                                    ,
coalesce(( prev_t_aussichtspunkt_ytd                     / (ewr_prev.ee/1000)),0) as prev_t_aussichtspunkt_ytd                            ,
coalesce(( prev_t_zoo_ytd                                / (ewr_prev.ee/1000)),0) as prev_t_zoo_ytd                                       ,
coalesce(( prev_t_schwimmen_ytd                          / (ewr_prev.ee/1000)),0) as prev_t_schwimmen_ytd                                 ,
coalesce(( prev_t_basketball_ytd                         / (ewr_prev.ee/1000)),0) as prev_t_basketball_ytd                                ,
coalesce(( prev_t_fussball_ytd                           / (ewr_prev.ee/1000)),0) as prev_t_fussball_ytd                                  ,
coalesce(( prev_t_sportzentrum_ytd                       / (ewr_prev.ee/1000)),0) as prev_t_sportzentrum_ytd                              ,
coalesce(( prev_t_tischtennis_ytd                        / (ewr_prev.ee/1000)),0) as prev_t_tischtennis_ytd                               ,
coalesce(( prev_t_sauna_ytd                              / (ewr_prev.ee/1000)),0) as prev_t_sauna_ytd                                     ,
coalesce(( prev_t_tennis_ytd                             / (ewr_prev.ee/1000)),0) as prev_t_tennis_ytd                                    ,
coalesce(( prev_t_kampfsport_ytd                         / (ewr_prev.ee/1000)),0) as prev_t_kampfsport_ytd                                ,
coalesce(( prev_t_fitnesszentrum_ytd                     / (ewr_prev.ee/1000)),0) as prev_t_fitnesszentrum_ytd                            ,
coalesce(( prev_t_spielplatz_ytd                         / (ewr_prev.ee/1000)),0) as prev_t_spielplatz_ytd                                ,
coalesce(( prev_t_wassersport_ytd                        / (ewr_prev.ee/1000)),0) as prev_t_wassersport_ytd                               ,
coalesce(( prev_t_spielothek_ytd                         / (ewr_prev.ee/1000)),0) as prev_t_spielothek_ytd                                ,
coalesce(( prev_t_sonstige_sportarten_ytd                / (ewr_prev.ee/1000)),0) as prev_t_sonstige_sportarten_ytd                       ,
coalesce(( prev_t_kindergarten_ytd                       / (ewr_prev.ee/1000)),0) as prev_t_kindergarten_ytd                              ,
coalesce(( prev_t_buero_ytd                              / (ewr_prev.ee/1000)),0) as prev_t_buero_ytd                                     ,
coalesce(( prev_t_tankstelle_ytd                         / (ewr_prev.ee/1000)),0) as prev_t_tankstelle_ytd                                ,
coalesce(( prev_t_coworking_space_ytd                    / (ewr_prev.ee/1000)),0) as prev_t_coworking_space_ytd                           ,
coalesce(( prev_t_universitaet_ytd                       / (ewr_prev.ee/1000)),0) as prev_t_universitaet_ytd                              ,
coalesce(( prev_t_poilzei_ytd                            / (ewr_prev.ee/1000)),0) as prev_t_poilzei_ytd                                   ,
coalesce(( prev_t_feuerwehr_ytd                          / (ewr_prev.ee/1000)),0) as prev_t_feuerwehr_ytd                                 ,
coalesce(( prev_t_kita_ytd                               / (ewr_prev.ee/1000)),0) as prev_t_kita_ytd                                      ,
coalesce(( prev_t_hoehere_schule_ytd                     / (ewr_prev.ee/1000)),0) as prev_t_hoehere_schule_ytd                            ,
coalesce(( prev_t_wochenmarkt_ytd                        / (ewr_prev.ee/1000)),0) as prev_t_wochenmarkt_ytd                               ,
coalesce(( prev_t_kino_ytd                               / (ewr_prev.ee/1000)),0) as prev_t_kino_ytd                                      ,
coalesce(( prev_t_biergarten_ytd                         / (ewr_prev.ee/1000)),0) as prev_t_biergarten_ytd                                ,
coalesce(( prev_t_autovermietung_ytd                     / (ewr_prev.ee/1000)),0) as prev_t_autovermietung_ytd                            ,
coalesce(( prev_t_buecherei_ytd                          / (ewr_prev.ee/1000)),0) as prev_t_buecherei_ytd                                 ,
coalesce(( prev_t_nachbarschaftszentrum_ytd              / (ewr_prev.ee/1000)),0) as prev_t_nachbarschaftszentrum_ytd                     ,
coalesce(( prev_t_theater_ytd                            / (ewr_prev.ee/1000)),0) as prev_t_theater_ytd                                   ,
coalesce(( prev_t_eisdiele_ytd                           / (ewr_prev.ee/1000)),0) as prev_t_eisdiele_ytd                                  ,
coalesce(( prev_t_nachtclub_ytd                          / (ewr_prev.ee/1000)),0) as prev_t_nachtclub_ytd                                 ,
coalesce(( prev_t_kirche_ytd                             / (ewr_prev.ee/1000)),0) as prev_t_kirche_ytd                                    ,
coalesce(( prev_t_moschee_ytd                            / (ewr_prev.ee/1000)),0) as prev_t_moschee_ytd                                   ,
coalesce(( prev_t_sonstige_tempel_ytd                    / (ewr_prev.ee/1000)),0) as prev_t_sonstige_tempel_ytd                           ,
coalesce(( prev_t_schule_ytd                             / (ewr_prev.ee/1000)),0) as prev_t_schule_ytd                                    ,
coalesce(( prev_t_bordell_ytd                            / (ewr_prev.ee/1000)),0) as prev_t_bordell_ytd                                   ,
coalesce(( prev_t_post_filiale_ytd                       / (ewr_prev.ee/1000)),0) as prev_t_post_filiale_ytd                              ,
coalesce(( prev_t_sozialeinrichtung_ytd                  / (ewr_prev.ee/1000)),0) as prev_t_sozialeinrichtung_ytd                         ,
coalesce(( prev_t_ladestation_ytd                        / (ewr_prev.ee/1000)),0) as prev_t_ladestation_ytd                               ,
coalesce(( prev_t_zahnarzt_ytd                           / (ewr_prev.ee/1000)),0) as prev_t_zahnarzt_ytd                                  ,
coalesce(( prev_t_fahrradverleih_ytd                     / (ewr_prev.ee/1000)),0) as prev_t_fahrradverleih_ytd                            ,
coalesce(( prev_t_fahrschule_ytd                         / (ewr_prev.ee/1000)),0) as prev_t_fahrschule_ytd                                ,
coalesce(( prev_t_tierarzt_ytd                           / (ewr_prev.ee/1000)),0) as prev_t_tierarzt_ytd                                  ,
coalesce(( prev_t_botschaft_ytd                          / (ewr_prev.ee/1000)),0) as prev_t_botschaft_ytd                                 ,
coalesce(( prev_t_taxistand_ytd                          / (ewr_prev.ee/1000)),0) as prev_t_taxistand_ytd                                 ,
coalesce(( prev_t_wc_ytd                                 / (ewr_prev.ee/1000)),0) as prev_t_wc_ytd                                        ,
coalesce(( prev_t_bankfiliale_ytd                        / (ewr_prev.ee/1000)),0) as prev_t_bankfiliale_ytd                               ,
coalesce(( prev_t_arzt_ytd                               / (ewr_prev.ee/1000)),0) as prev_t_arzt_ytd                                      ,
coalesce(( prev_t_parkplatz_ytd                          / (ewr_prev.ee/1000)),0) as prev_t_parkplatz_ytd                                 ,
coalesce(( prev_t_bar_ytd                                / (ewr_prev.ee/1000)),0) as prev_t_bar_ytd                                       ,
coalesce(( prev_t_apotheke_ytd                           / (ewr_prev.ee/1000)),0) as prev_t_apotheke_ytd                                  ,
coalesce(( prev_t_pub_ytd                                / (ewr_prev.ee/1000)),0) as prev_t_pub_ytd                                       ,
coalesce(( prev_t_telefon_ytd                            / (ewr_prev.ee/1000)),0) as prev_t_telefon_ytd                                   ,
coalesce(( prev_t_kaffee_ytd                             / (ewr_prev.ee/1000)),0) as prev_t_kaffee_ytd                                    ,
coalesce(( prev_t_sonstige_cafes_ytd                     / (ewr_prev.ee/1000)),0) as prev_t_sonstige_cafes_ytd                            ,
coalesce(( prev_t_fahrrad_parkplatz_ytd                  / (ewr_prev.ee/1000)),0) as prev_t_fahrrad_parkplatz_ytd                         ,
coalesce(( prev_t_muelleimer_ytd                         / (ewr_prev.ee/1000)),0) as prev_t_muelleimer_ytd                                ,
coalesce(( prev_t_parkbank_ytd                           / (ewr_prev.ee/1000)),0) as prev_t_parkbank_ytd                                  ,
coalesce(( prev_t_krankenhaus_ytd                        / (ewr_prev.ee/1000)),0) as prev_t_krankenhaus_ytd                               ,
coalesce(( prev_t_klinik_ytd                             / (ewr_prev.ee/1000)),0) as prev_t_klinik_ytd                                    ,
coalesce(( prev_t_geldautomat_ytd                        / (ewr_prev.ee/1000)),0) as prev_t_geldautomat_ytd                               ,
coalesce(( prev_t_briefkasten_ytd                        / (ewr_prev.ee/1000)),0) as prev_t_briefkasten_ytd                               ,
coalesce(( prev_t_friedhof_ytd                           / (ewr_prev.ee/1000)),0) as prev_t_friedhof_ytd                                  ,
coalesce(( prev_t_musikschule_ytd                        / (ewr_prev.ee/1000)),0) as prev_t_musikschule_ytd                               ,
coalesce(( prev_t_paketautomat_ytd                       / (ewr_prev.ee/1000)),0) as prev_t_paketautomat_ytd                              ,
coalesce(( prev_t_sonstige_automaten_ytd                 / (ewr_prev.ee/1000)),0) as prev_t_sonstige_automaten_ytd                        ,
coalesce(( prev_t_fahrscheinautomat_ytd                  / (ewr_prev.ee/1000)),0) as prev_t_fahrscheinautomat_ytd                         ,
coalesce(( prev_t_parkticketautomat_ytd                  / (ewr_prev.ee/1000)),0) as prev_t_parkticketautomat_ytd                         ,
coalesce(( prev_t_kotbeutelautomat_ytd                   / (ewr_prev.ee/1000)),0) as prev_t_kotbeutelautomat_ytd                          ,
coalesce(( prev_t_zigarettenautomat_ytd                  / (ewr_prev.ee/1000)),0) as prev_t_zigarettenautomat_ytd                         ,
coalesce(( prev_t_suessigkeitenautomat_ytd               / (ewr_prev.ee/1000)),0) as prev_t_suessigkeitenautomat_ytd                      ,
coalesce(( prev_t_briefmarkenautomat_ytd                 / (ewr_prev.ee/1000)),0) as prev_t_briefmarkenautomat_ytd                        ,
coalesce(( prev_t_kondomautomat_ytd                      / (ewr_prev.ee/1000)),0) as prev_t_kondomautomat_ytd                             ,
coalesce(( prev_t_getraenke_und_suessigkeitenautomat_ytd / (ewr_prev.ee/1000)),0) as prev_t_getraenke_und_suessigkeitenautomat_ytd        ,
coalesce(( prev_t_getraenkeautomat_ytd                   / (ewr_prev.ee/1000)),0) as prev_t_getraenkeautomat_ytd                          ,
coalesce(( prev_t_grillplatz_ytd                         / (ewr_prev.ee/1000)),0) as prev_t_grillplatz_ytd                                ,
coalesce(( prev_t_glascontainer_ytd                      / (ewr_prev.ee/1000)),0) as prev_t_glascontainer_ytd                             ,
coalesce(( prev_t_glas__und_kleidungscontainer_ytd       / (ewr_prev.ee/1000)),0) as prev_t_glas__und_kleidungscontainer_ytd              ,
coalesce(( prev_t_kleidungscontainer_ytd                 / (ewr_prev.ee/1000)),0) as prev_t_kleidungscontainer_ytd                        ,
coalesce(( prev_t_sonstige_container_ytd                 / (ewr_prev.ee/1000)),0) as prev_t_sonstige_container_ytd                        ,
coalesce(( prev_t_restaurant_italiener_ytd               / (ewr_prev.ee/1000)),0) as prev_t_restaurant_italiener_ytd                      ,
coalesce(( prev_t_restaurant_deutsch_ytd                 / (ewr_prev.ee/1000)),0) as prev_t_restaurant_deutsch_ytd                        ,
coalesce(( prev_t_restaurant_indisch_ytd                 / (ewr_prev.ee/1000)),0) as prev_t_restaurant_indisch_ytd                        ,
coalesce(( prev_t_restaurant_asiatisch_ytd               / (ewr_prev.ee/1000)),0) as prev_t_restaurant_asiatisch_ytd                      ,
coalesce(( prev_t_restaurant_sushi_ytd                   / (ewr_prev.ee/1000)),0) as prev_t_restaurant_sushi_ytd                          ,
coalesce(( prev_t_restaurant_griechisch_ytd              / (ewr_prev.ee/1000)),0) as prev_t_restaurant_griechisch_ytd                     ,
coalesce(( prev_t_restaurant_steakhouse_ytd              / (ewr_prev.ee/1000)),0) as prev_t_restaurant_steakhouse_ytd                     ,
coalesce(( prev_t_restaurant_international_ytd           / (ewr_prev.ee/1000)),0) as prev_t_restaurant_international_ytd                  ,
coalesce(( prev_t_restaurant_tuerkisch_ytd               / (ewr_prev.ee/1000)),0) as prev_t_restaurant_tuerkisch_ytd                      ,
coalesce(( prev_t_fastfood_kebap_ytd                     / (ewr_prev.ee/1000)),0) as prev_t_fastfood_kebap_ytd                            ,
coalesce(( prev_t_fastfood_burger_ytd                    / (ewr_prev.ee/1000)),0) as prev_t_fastfood_burger_ytd                           ,
coalesce(( prev_t_fastfood_asiatisch_ytd                 / (ewr_prev.ee/1000)),0) as prev_t_fastfood_asiatisch_ytd                        ,
coalesce(( prev_t_fastfood_pizza_ytd                     / (ewr_prev.ee/1000)),0) as prev_t_fastfood_pizza_ytd                            ,
coalesce(( prev_t_fastfood_pommesbude_ytd                / (ewr_prev.ee/1000)),0) as prev_t_fastfood_pommesbude_ytd                       ,
coalesce(( prev_t_fast_food_sonstiges_ytd                / (ewr_prev.ee/1000)),0) as prev_t_fast_food_sonstiges_ytd                       ,
coalesce(( prev_t_restaurant_sonstiges_ytd               / (ewr_prev.ee/1000)),0) as prev_t_restaurant_sonstiges_ytd                      ,
coalesce(( prev_t_friseur_ytd                            / (ewr_prev.ee/1000)),0) as prev_t_friseur_ytd                                   ,
coalesce(( prev_t_baeckerei_ytd                          / (ewr_prev.ee/1000)),0) as prev_t_baeckerei_ytd                                 ,
coalesce(( prev_t_kleidung_ytd                           / (ewr_prev.ee/1000)),0) as prev_t_kleidung_ytd                                  ,
coalesce(( prev_t_supermarkt_ytd                         / (ewr_prev.ee/1000)),0) as prev_t_supermarkt_ytd                                ,
coalesce(( prev_t_kiosk_ytd                              / (ewr_prev.ee/1000)),0) as prev_t_kiosk_ytd                                     ,
coalesce(( prev_t_florist_ytd                            / (ewr_prev.ee/1000)),0) as prev_t_florist_ytd                                   ,
coalesce(( prev_t_fahrrad_ytd                            / (ewr_prev.ee/1000)),0) as prev_t_fahrrad_ytd                                   ,
coalesce(( prev_t_kosmetik_und_beauty_ytd                / (ewr_prev.ee/1000)),0) as prev_t_kosmetik_und_beauty_ytd                       ,
coalesce(( prev_t_optiker_ytd                            / (ewr_prev.ee/1000)),0) as prev_t_optiker_ytd                                   ,
coalesce(( prev_t_schuhe_ytd                             / (ewr_prev.ee/1000)),0) as prev_t_schuhe_ytd                                    ,
coalesce(( prev_t_buecher_ytd                            / (ewr_prev.ee/1000)),0) as prev_t_buecher_ytd                                   ,
coalesce(( prev_t_massage_ytd                            / (ewr_prev.ee/1000)),0) as prev_t_massage_ytd                                   ,
coalesce(( prev_t_schmuck_ytd                            / (ewr_prev.ee/1000)),0) as prev_t_schmuck_ytd                                   ,
coalesce(( prev_t_autoreperatur_ytd                      / (ewr_prev.ee/1000)),0) as prev_t_autoreperatur_ytd                             ,
coalesce(( prev_t_drogerie_ytd                           / (ewr_prev.ee/1000)),0) as prev_t_drogerie_ytd                                  ,
coalesce(( prev_t_reisen_ytd                             / (ewr_prev.ee/1000)),0) as prev_t_reisen_ytd                                    ,
coalesce(( prev_t_mobilfunk_ytd                          / (ewr_prev.ee/1000)),0) as prev_t_mobilfunk_ytd                                 ,
coalesce(( prev_t_moebel_ytd                             / (ewr_prev.ee/1000)),0) as prev_t_moebel_ytd                                    ,
coalesce(( prev_t_getraenke_ytd                          / (ewr_prev.ee/1000)),0) as prev_t_getraenke_ytd                                 ,
coalesce(( prev_t_feinkost_ytd                           / (ewr_prev.ee/1000)),0) as prev_t_feinkost_ytd                                  ,
coalesce(( prev_t_elektronik_ytd                         / (ewr_prev.ee/1000)),0) as prev_t_elektronik_ytd                                ,
coalesce(( prev_t_boutique_ytd                           / (ewr_prev.ee/1000)),0) as prev_t_boutique_ytd                                  ,
coalesce(( prev_t_autohaus_ytd                           / (ewr_prev.ee/1000)),0) as prev_t_autohaus_ytd                                  ,
coalesce(( prev_t_spirituosen_ytd                        / (ewr_prev.ee/1000)),0) as prev_t_spirituosen_ytd                               ,
coalesce(( prev_t_geschenke_ytd                          / (ewr_prev.ee/1000)),0) as prev_t_geschenke_ytd                                 ,
coalesce(( prev_t_postenmarkt_ytd                        / (ewr_prev.ee/1000)),0) as prev_t_postenmarkt_ytd                               ,
coalesce(( prev_t_schlachter_ytd                         / (ewr_prev.ee/1000)),0) as prev_t_schlachter_ytd                                ,
coalesce(( prev_t_waescherei_ytd                         / (ewr_prev.ee/1000)),0) as prev_t_waescherei_ytd                                ,
coalesce(( prev_t_computer_ytd                           / (ewr_prev.ee/1000)),0) as prev_t_computer_ytd                                  ,
coalesce(( prev_t_spielzeug_ytd                          / (ewr_prev.ee/1000)),0) as prev_t_spielzeug_ytd                                 ,
coalesce(( prev_t_copyshop_ytd                           / (ewr_prev.ee/1000)),0) as prev_t_copyshop_ytd                                  ,
coalesce(( prev_t_schneider_ytd                          / (ewr_prev.ee/1000)),0) as prev_t_schneider_ytd                                 ,
coalesce(( prev_t_foto_ytd                               / (ewr_prev.ee/1000)),0) as prev_t_foto_ytd                                      ,
coalesce(( prev_t_kunst_ytd                              / (ewr_prev.ee/1000)),0) as prev_t_kunst_ytd                                     ,
coalesce(( prev_t_suessigkeiten_ytd                      / (ewr_prev.ee/1000)),0) as prev_t_suessigkeiten_ytd                             ,
coalesce(( prev_t_dekoration_ytd                         / (ewr_prev.ee/1000)),0) as prev_t_dekoration_ytd                                ,
coalesce(( prev_t_reinigung_ytd                          / (ewr_prev.ee/1000)),0) as prev_t_reinigung_ytd                                 ,
coalesce(( prev_t_beerdigung_ytd                         / (ewr_prev.ee/1000)),0) as prev_t_beerdigung_ytd                                ,
coalesce(( prev_t_sport_ytd                              / (ewr_prev.ee/1000)),0) as prev_t_sport_ytd                                     ,
coalesce(( prev_t_zoofachgeschaeft_ytd                   / (ewr_prev.ee/1000)),0) as prev_t_zoofachgeschaeft_ytd                          ,
coalesce(( prev_t_textilgeschaeft_ytd                    / (ewr_prev.ee/1000)),0) as prev_t_textilgeschaeft_ytd                           ,
coalesce(( prev_t_hoergeraete_ytd                        / (ewr_prev.ee/1000)),0) as prev_t_hoergeraete_ytd                               ,
coalesce(( prev_t_baumarkt_ytd                           / (ewr_prev.ee/1000)),0) as prev_t_baumarkt_ytd                                  ,
coalesce(( prev_t_leerstand_ytd                          / (ewr_prev.ee/1000)),0) as prev_t_leerstand_ytd                                 ,
coalesce(( prev_t_medical_ytd                            / (ewr_prev.ee/1000)),0) as prev_t_medical_ytd                                   ,
coalesce(( prev_t_second_hand_ytd                        / (ewr_prev.ee/1000)),0) as prev_t_second_hand_ytd                               ,
coalesce(( prev_t_zeitung_ytd                            / (ewr_prev.ee/1000)),0) as prev_t_zeitung_ytd                                   ,
coalesce(( prev_t_eisenwarenhandlung_ytd                 / (ewr_prev.ee/1000)),0) as prev_t_eisenwarenhandlung_ytd                        ,
coalesce(( prev_t_sonstiger_shop_ytd                     / (ewr_prev.ee/1000)),0) as prev_t_sonstiger_shop_ytd                            ,
coalesce(( prev_t_baudenkmal_ytd                         / (ewr_prev.ee/1000)),0) as prev_t_baudenkmal_ytd                                ,
coalesce(( prev_t_haltestelle_ytd                        / (ewr_prev.ee/1000)),0) as prev_t_haltestelle_ytd                               ,
coalesce(( prev_t_sonstiges_gebaeude_ytd                 / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_gebaeude_ytd                        ,
coalesce(( prev_t_sonstiges_gelaende_ytd                 / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_gelaende_ytd                        ,
coalesce(( prev_t_sonstiges_denkmal_ytd                  / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_denkmal_ytd                         ,
coalesce(( prev_t_sonstiges_tourismus_ytd                / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_tourismus_ytd                       ,
coalesce(( prev_t_sonstiges_sport_ytd                    / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_sport_ytd                           ,
coalesce(( prev_t_sonstiges_erholung_ytd                 / (ewr_prev.ee/1000)),0) as prev_t_sonstiges_erholung_ytd                        ,

--OFFERING ADVANTAGE
oa_total_d_tourismus_stock,
oa_total_d_vergnuegung_stock,
oa_total_d_sport_und_erholung_stock,
oa_total_d_public_service_stock,
oa_total_d_buero_stock,
oa_total_d_mobilitaet_stock,
oa_total_d_sonstiges_stock,
oa_total_d_gastronomie_stock,
oa_total_d_religion_stock,
oa_total_d_oeffentlicher_raum_stock,
oa_total_d_dienstleistung_stock,
oa_total_d_waren_stock,
oa_total_d_leerstand_stock,
oa_gastro_c_fast_food_stock                  ,
oa_gastro_c_restaurant_stock                 ,
oa_gastro_c_cafe_stock                       ,
oa_gastro_t_restaurant_italiener_stock            ,
oa_gastro_t_restaurant_deutsch_stock              ,
oa_gastro_t_restaurant_indisch_stock              ,
oa_gastro_t_restaurant_asiatisch_stock            ,
oa_gastro_t_restaurant_sushi_stock                ,
oa_gastro_t_restaurant_griechisch_stock           ,
oa_gastro_t_restaurant_steakhouse_stock           ,
oa_gastro_t_restaurant_international_stock        ,
oa_gastro_t_restaurant_tuerkisch_stock            ,
oa_gastro_t_restaurant_sonstiges_stock            ,
oa_gastro_t_eisdiele_stock                        ,
oa_gastro_t_sonstige_cafes_stock                  ,
oa_gastro_t_kaffee_stock                          ,
oa_gastro_t_fastfood_kebap_stock                  ,
oa_gastro_t_fastfood_burger_stock                 ,
oa_gastro_t_fastfood_asiatisch_stock              ,
oa_gastro_t_fastfood_pizza_stock                  ,
oa_gastro_t_fastfood_pommesbude_stock             ,
oa_gastro_t_fast_food_sonstiges_stock             ,
oa_dl_c_friseur_stock                             ,
oa_dl_c_kosmetik_und_beauty_stock                 ,
oa_dl_c_massage_stock                             ,
oa_dl_c_reisen_stock                              ,
oa_dl_c_waescherei_stock                          ,
oa_dl_c_beerdigung_stock                          ,
oa_pubserv_c_bildung_stock                        ,
oa_pubserv_c_sicherheit_stock                     ,
oa_pubserv_c_sonstiges_stock                      ,
oa_pubserv_c_sozial_stock                         ,
oa_pubserv_c_gesundheit_stock                     ,
oa_pubserv_c_bank_stock                           ,
oa_waren_c_essen_und_trinken_stock                ,
oa_waren_c_kleidung_stock                         ,
oa_waren_c_sonstige_waren_stock                   ,
oa_waren_c_werkstatt_stock                        ,
oa_waren_c_medical_stock                          ,
oa_waren_c_print_stock                            ,
oa_waren_c_drogerie_stock                         ,
oa_waren_c_technik_stock                          ,
oa_waren_c_spielzeug_und_geschenke_stock          ,
oa_waren_c_kunst_stock                            ,
oa_waren_c_handwerk_stock                         ,
oa_waren_c_sonstiger_shop_stock                   ,
oa_vergnuegung_t_kunstzentrum_stock               ,
oa_vergnuegung_t_gallerie_stock                   ,
oa_vergnuegung_t_museum_stock                     ,
oa_vergnuegung_t_zoo_stock                        ,
oa_vergnuegung_t_spielothek_stock                 ,
oa_vergnuegung_t_kino_stock                       ,
oa_vergnuegung_t_biergarten_stock                 ,
oa_vergnuegung_t_theater_stock                    ,
oa_vergnuegung_t_nachtclub_stock                  ,
oa_vergnuegung_t_bordell_stock                    ,
oa_vergnuegung_t_bar_stock                        ,
oa_vergnuegung_t_pub_stock                        ,
oa_sport_t_schwimmen_stock                        ,
oa_sport_t_basketball_stock                       ,
oa_sport_t_fussball_stock                         ,
oa_sport_t_sportzentrum_stock                     ,
oa_sport_t_tischtennis_stock                      ,
oa_sport_t_sauna_stock                            ,
oa_sport_t_tennis_stock                           ,
oa_sport_t_kampfsport_stock                       ,
oa_sport_t_fitnesszentrum_stock                   ,
oa_sport_t_spielplatz_stock                       ,
oa_sport_t_wassersport_stock                      ,
oa_sport_t_sonstige_sportarten_stock              ,
oa_sport_t_sonstiges_sport_stock                  ,
oa_sport_t_sonstiges_erholung_stock               ,


prev_oa_total_d_tourismus_stock                   ,
prev_oa_total_d_vergnuegung_stock                 ,
prev_oa_total_d_sport_und_erholung_stock          ,
prev_oa_total_d_public_service_stock              ,
prev_oa_total_d_buero_stock                       ,
prev_oa_total_d_mobilitaet_stock                  ,
prev_oa_total_d_sonstiges_stock                   ,
prev_oa_total_d_gastronomie_stock                 ,
prev_oa_total_d_religion_stock                    ,
prev_oa_total_d_oeffentlicher_raum_stock          ,
prev_oa_total_d_dienstleistung_stock              ,
prev_oa_total_d_waren_stock                       ,
prev_oa_total_d_leerstand_stock                   ,
prev_oa_gastro_c_fast_food_stock                  ,
prev_oa_gastro_c_restaurant_stock                 ,
prev_oa_gastro_c_cafe_stock                       ,
prev_oa_gastro_t_restaurant_italiener_stock       ,
prev_oa_gastro_t_restaurant_deutsch_stock         ,
prev_oa_gastro_t_restaurant_indisch_stock         ,
prev_oa_gastro_t_restaurant_asiatisch_stock       ,
prev_oa_gastro_t_restaurant_sushi_stock           ,
prev_oa_gastro_t_restaurant_griechisch_stock      ,
prev_oa_gastro_t_restaurant_steakhouse_stock      ,
prev_oa_gastro_t_restaurant_international_stock   ,
prev_oa_gastro_t_restaurant_tuerkisch_stock       ,
prev_oa_gastro_t_restaurant_sonstiges_stock       ,
prev_oa_gastro_t_eisdiele_stock                   ,
prev_oa_gastro_t_sonstige_cafes_stock             ,
prev_oa_gastro_t_kaffee_stock                     ,
prev_oa_gastro_t_fastfood_kebap_stock             ,
prev_oa_gastro_t_fastfood_burger_stock            ,
prev_oa_gastro_t_fastfood_asiatisch_stock         ,
prev_oa_gastro_t_fastfood_pizza_stock             ,
prev_oa_gastro_t_fastfood_pommesbude_stock        ,
prev_oa_gastro_t_fast_food_sonstiges_stock        ,
prev_oa_dl_c_friseur_stock                        ,
prev_oa_dl_c_kosmetik_und_beauty_stock            ,
prev_oa_dl_c_massage_stock                        ,
prev_oa_dl_c_reisen_stock                         ,
prev_oa_dl_c_waescherei_stock                     ,
prev_oa_dl_c_beerdigung_stock                     ,
prev_oa_pubserv_c_bildung_stock                   ,
prev_oa_pubserv_c_sicherheit_stock                ,
prev_oa_pubserv_c_sonstiges_stock                 ,
prev_oa_pubserv_c_sozial_stock                    ,
prev_oa_pubserv_c_gesundheit_stock                ,
prev_oa_pubserv_c_bank_stock                      ,
prev_oa_waren_c_essen_und_trinken_stock           ,
prev_oa_waren_c_kleidung_stock                    ,
prev_oa_waren_c_sonstige_waren_stock              ,
prev_oa_waren_c_werkstatt_stock                   ,
prev_oa_waren_c_medical_stock                     ,
prev_oa_waren_c_print_stock                       ,
prev_oa_waren_c_drogerie_stock                    ,
prev_oa_waren_c_technik_stock                     ,
prev_oa_waren_c_spielzeug_und_geschenke_stock     ,
prev_oa_waren_c_kunst_stock                       ,
prev_oa_waren_c_handwerk_stock                    ,
prev_oa_waren_c_sonstiger_shop_stock              ,
prev_oa_vergnuegung_t_kunstzentrum_stock          ,
prev_oa_vergnuegung_t_gallerie_stock              ,
prev_oa_vergnuegung_t_museum_stock                ,
prev_oa_vergnuegung_t_zoo_stock                   ,
prev_oa_vergnuegung_t_spielothek_stock            ,
prev_oa_vergnuegung_t_kino_stock                  ,
prev_oa_vergnuegung_t_biergarten_stock            ,
prev_oa_vergnuegung_t_theater_stock               ,
prev_oa_vergnuegung_t_nachtclub_stock             ,
prev_oa_vergnuegung_t_bordell_stock               ,
prev_oa_vergnuegung_t_bar_stock                   ,
prev_oa_vergnuegung_t_pub_stock                   ,
prev_oa_sport_t_schwimmen_stock                   ,
prev_oa_sport_t_basketball_stock                  ,
prev_oa_sport_t_fussball_stock                    ,
prev_oa_sport_t_sportzentrum_stock                ,
prev_oa_sport_t_tischtennis_stock                 ,
prev_oa_sport_t_sauna_stock                       ,
prev_oa_sport_t_tennis_stock                      ,
prev_oa_sport_t_kampfsport_stock                  ,
prev_oa_sport_t_fitnesszentrum_stock              ,
prev_oa_sport_t_spielplatz_stock                  ,
prev_oa_sport_t_wassersport_stock                 ,
prev_oa_sport_t_sonstige_sportarten_stock         ,
prev_oa_sport_t_sonstiges_sport_stock             ,
prev_oa_sport_t_sonstiges_erholung_stock          
  
from lor_ewr_einwohnergewichtet_tb ewr 
join lor_mss_idx mss 
on ewr.zeit = mss.zeit 
and cast(ewr.planungsraum as int) = mss.raum_id

join lor_own_idx_plr_tb own_idx 
on ewr.zeit = own_idx.jahr 
and cast(ewr.planungsraum as int) = cast(own_idx.raum_id as int)

left join lor_ewr_einwohnergewichtet_tb ewr_prev 
on ewr.zeit-200 = ewr_prev.zeit 
and ewr.planungsraum = ewr_prev.planungsraum

left join lor_mss_idx mss_prev 
on ewr.zeit-200 = mss_prev.zeit 
and cast(ewr.planungsraum as int) = mss_prev.raum_id

left join lor_own_idx_plr_tb own_idx_prev
on ewr.zeit-200 = own_idx_prev.jahr 
and cast(ewr.planungsraum as int) = cast(own_idx_prev.raum_id as int)

left join 
(select 
  planungsraum,
  201612 as timeslice, 
  coalesce(oa_total_d_tourismus_stock                   ,0) as  oa_total_d_tourismus_stock                   ,
  coalesce(oa_total_d_vergnuegung_stock                 ,0) as  oa_total_d_vergnuegung_stock                 ,
  coalesce(oa_total_d_sport_und_erholung_stock          ,0) as  oa_total_d_sport_und_erholung_stock          ,
  coalesce(oa_total_d_public_service_stock              ,0) as  oa_total_d_public_service_stock              ,
  coalesce(oa_total_d_buero_stock                       ,0) as  oa_total_d_buero_stock                       ,
  coalesce(oa_total_d_mobilitaet_stock                  ,0) as  oa_total_d_mobilitaet_stock                  ,
  coalesce(oa_total_d_sonstiges_stock                   ,0) as  oa_total_d_sonstiges_stock                   ,
  coalesce(oa_total_d_gastronomie_stock                 ,0) as  oa_total_d_gastronomie_stock                 ,
  coalesce(oa_total_d_religion_stock                    ,0) as  oa_total_d_religion_stock                    ,
  coalesce(oa_total_d_oeffentlicher_raum_stock          ,0) as  oa_total_d_oeffentlicher_raum_stock          ,
  coalesce(oa_total_d_dienstleistung_stock              ,0) as  oa_total_d_dienstleistung_stock              ,
  coalesce(oa_total_d_waren_stock                       ,0) as  oa_total_d_waren_stock                       ,
  coalesce(oa_total_d_leerstand_stock                   ,0) as  oa_total_d_leerstand_stock                   ,
  coalesce(oa_gastro_c_fast_food_stock                  ,0) as  oa_gastro_c_fast_food_stock                  ,
  coalesce(oa_gastro_c_restaurant_stock                 ,0) as  oa_gastro_c_restaurant_stock                 ,
  coalesce(oa_gastro_c_cafe_stock                       ,0) as  oa_gastro_c_cafe_stock                       ,
  coalesce(oa_gastro_t_restaurant_italiener_stock       ,0) as  oa_gastro_t_restaurant_italiener_stock       ,
  coalesce(oa_gastro_t_restaurant_deutsch_stock         ,0) as  oa_gastro_t_restaurant_deutsch_stock         ,
  coalesce(oa_gastro_t_restaurant_indisch_stock         ,0) as  oa_gastro_t_restaurant_indisch_stock         ,
  coalesce(oa_gastro_t_restaurant_asiatisch_stock       ,0) as  oa_gastro_t_restaurant_asiatisch_stock       ,
  coalesce(oa_gastro_t_restaurant_sushi_stock           ,0) as  oa_gastro_t_restaurant_sushi_stock           ,
  coalesce(oa_gastro_t_restaurant_griechisch_stock      ,0) as  oa_gastro_t_restaurant_griechisch_stock      ,
  coalesce(oa_gastro_t_restaurant_steakhouse_stock      ,0) as  oa_gastro_t_restaurant_steakhouse_stock      ,
  coalesce(oa_gastro_t_restaurant_international_stock   ,0) as  oa_gastro_t_restaurant_international_stock   ,
  coalesce(oa_gastro_t_restaurant_tuerkisch_stock       ,0) as  oa_gastro_t_restaurant_tuerkisch_stock       ,
  coalesce(oa_gastro_t_restaurant_sonstiges_stock       ,0) as  oa_gastro_t_restaurant_sonstiges_stock       ,
  coalesce(oa_gastro_t_eisdiele_stock                   ,0) as  oa_gastro_t_eisdiele_stock                   ,
  coalesce(oa_gastro_t_sonstige_cafes_stock             ,0) as  oa_gastro_t_sonstige_cafes_stock             ,
  coalesce(oa_gastro_t_kaffee_stock                     ,0) as  oa_gastro_t_kaffee_stock                     ,
  coalesce(oa_gastro_t_fastfood_kebap_stock             ,0) as  oa_gastro_t_fastfood_kebap_stock             ,
  coalesce(oa_gastro_t_fastfood_burger_stock            ,0) as  oa_gastro_t_fastfood_burger_stock            ,
  coalesce(oa_gastro_t_fastfood_asiatisch_stock         ,0) as  oa_gastro_t_fastfood_asiatisch_stock         ,
  coalesce(oa_gastro_t_fastfood_pizza_stock             ,0) as  oa_gastro_t_fastfood_pizza_stock             ,
  coalesce(oa_gastro_t_fastfood_pommesbude_stock        ,0) as  oa_gastro_t_fastfood_pommesbude_stock        ,
  coalesce(oa_gastro_t_fast_food_sonstiges_stock        ,0) as  oa_gastro_t_fast_food_sonstiges_stock        ,
  coalesce(oa_dl_c_friseur_stock                        ,0) as  oa_dl_c_friseur_stock                        ,
  coalesce(oa_dl_c_kosmetik_und_beauty_stock            ,0) as  oa_dl_c_kosmetik_und_beauty_stock            ,
  coalesce(oa_dl_c_massage_stock                        ,0) as  oa_dl_c_massage_stock                        ,
  coalesce(oa_dl_c_reisen_stock                         ,0) as  oa_dl_c_reisen_stock                         ,
  coalesce(oa_dl_c_waescherei_stock                     ,0) as  oa_dl_c_waescherei_stock                     ,
  coalesce(oa_dl_c_beerdigung_stock                     ,0) as  oa_dl_c_beerdigung_stock                     ,
  coalesce(oa_pubserv_c_bildung_stock                   ,0) as  oa_pubserv_c_bildung_stock                   ,
  coalesce(oa_pubserv_c_sicherheit_stock                ,0) as  oa_pubserv_c_sicherheit_stock                ,
  coalesce(oa_pubserv_c_sonstiges_stock                 ,0) as  oa_pubserv_c_sonstiges_stock                 ,
  coalesce(oa_pubserv_c_sozial_stock                    ,0) as  oa_pubserv_c_sozial_stock                    ,
  coalesce(oa_pubserv_c_gesundheit_stock                ,0) as  oa_pubserv_c_gesundheit_stock                ,
  coalesce(oa_pubserv_c_bank_stock                      ,0) as  oa_pubserv_c_bank_stock                      ,
  coalesce(oa_waren_c_essen_und_trinken_stock           ,0) as  oa_waren_c_essen_und_trinken_stock           ,
  coalesce(oa_waren_c_kleidung_stock                    ,0) as  oa_waren_c_kleidung_stock                    ,
  coalesce(oa_waren_c_sonstige_waren_stock              ,0) as  oa_waren_c_sonstige_waren_stock              ,
  coalesce(oa_waren_c_werkstatt_stock                   ,0) as  oa_waren_c_werkstatt_stock                   ,
  coalesce(oa_waren_c_medical_stock                     ,0) as  oa_waren_c_medical_stock                     ,
  coalesce(oa_waren_c_print_stock                       ,0) as  oa_waren_c_print_stock                       ,
  coalesce(oa_waren_c_drogerie_stock                    ,0) as  oa_waren_c_drogerie_stock                    ,
  coalesce(oa_waren_c_technik_stock                     ,0) as  oa_waren_c_technik_stock                     ,
  coalesce(oa_waren_c_spielzeug_und_geschenke_stock     ,0) as  oa_waren_c_spielzeug_und_geschenke_stock     ,
  coalesce(oa_waren_c_kunst_stock                       ,0) as  oa_waren_c_kunst_stock                       ,
  coalesce(oa_waren_c_handwerk_stock                    ,0) as  oa_waren_c_handwerk_stock                    ,
  coalesce(oa_waren_c_sonstiger_shop_stock              ,0) as  oa_waren_c_sonstiger_shop_stock              ,
  coalesce(oa_vergnuegung_t_kunstzentrum_stock          ,0) as  oa_vergnuegung_t_kunstzentrum_stock          ,
  coalesce(oa_vergnuegung_t_gallerie_stock              ,0) as  oa_vergnuegung_t_gallerie_stock              ,
  coalesce(oa_vergnuegung_t_museum_stock                ,0) as  oa_vergnuegung_t_museum_stock                ,
  coalesce(oa_vergnuegung_t_zoo_stock                   ,0) as  oa_vergnuegung_t_zoo_stock                   ,
  coalesce(oa_vergnuegung_t_spielothek_stock            ,0) as  oa_vergnuegung_t_spielothek_stock            ,
  coalesce(oa_vergnuegung_t_kino_stock                  ,0) as  oa_vergnuegung_t_kino_stock                  ,
  coalesce(oa_vergnuegung_t_biergarten_stock            ,0) as  oa_vergnuegung_t_biergarten_stock            ,
  coalesce(oa_vergnuegung_t_theater_stock               ,0) as  oa_vergnuegung_t_theater_stock               ,
  coalesce(oa_vergnuegung_t_nachtclub_stock             ,0) as  oa_vergnuegung_t_nachtclub_stock             ,
  coalesce(oa_vergnuegung_t_bordell_stock               ,0) as  oa_vergnuegung_t_bordell_stock               ,
  coalesce(oa_vergnuegung_t_bar_stock                   ,0) as  oa_vergnuegung_t_bar_stock                   ,
  coalesce(oa_vergnuegung_t_pub_stock                   ,0) as  oa_vergnuegung_t_pub_stock                   ,
  coalesce(oa_sport_t_schwimmen_stock                   ,0) as  oa_sport_t_schwimmen_stock                   ,
  coalesce(oa_sport_t_basketball_stock                  ,0) as  oa_sport_t_basketball_stock                  ,
  coalesce(oa_sport_t_fussball_stock                    ,0) as  oa_sport_t_fussball_stock                    ,
  coalesce(oa_sport_t_sportzentrum_stock                ,0) as  oa_sport_t_sportzentrum_stock                ,
  coalesce(oa_sport_t_tischtennis_stock                 ,0) as  oa_sport_t_tischtennis_stock                 ,
  coalesce(oa_sport_t_sauna_stock                       ,0) as  oa_sport_t_sauna_stock                       ,
  coalesce(oa_sport_t_tennis_stock                      ,0) as  oa_sport_t_tennis_stock                      ,
  coalesce(oa_sport_t_kampfsport_stock                  ,0) as  oa_sport_t_kampfsport_stock                  ,
  coalesce(oa_sport_t_fitnesszentrum_stock              ,0) as  oa_sport_t_fitnesszentrum_stock              ,
  coalesce(oa_sport_t_spielplatz_stock                  ,0) as  oa_sport_t_spielplatz_stock                  ,
  coalesce(oa_sport_t_wassersport_stock                 ,0) as  oa_sport_t_wassersport_stock                 ,
  coalesce(oa_sport_t_sonstige_sportarten_stock         ,0) as  oa_sport_t_sonstige_sportarten_stock         ,
  coalesce(oa_sport_t_sonstiges_sport_stock             ,0) as  oa_sport_t_sonstiges_sport_stock             ,
  coalesce(oa_sport_t_sonstiges_erholung_stock          ,0) as  oa_sport_t_sonstiges_erholung_stock          
  from osm_poi_oa_distcalc 
  where timeslice in (201701) 
) oa
on ewr.zeit = oa.timeslice
and cast(ewr.planungsraum as int) = cast(oa.planungsraum as int)


left join 
(select 
  planungsraum,
  201612 as timeslice, 
  coalesce(oa_total_d_tourismus_stock                   ,0) as  prev_oa_total_d_tourismus_stock                   ,
  coalesce(oa_total_d_vergnuegung_stock                 ,0) as  prev_oa_total_d_vergnuegung_stock                 ,
  coalesce(oa_total_d_sport_und_erholung_stock          ,0) as  prev_oa_total_d_sport_und_erholung_stock          ,
  coalesce(oa_total_d_public_service_stock              ,0) as  prev_oa_total_d_public_service_stock              ,
  coalesce(oa_total_d_buero_stock                       ,0) as  prev_oa_total_d_buero_stock                       ,
  coalesce(oa_total_d_mobilitaet_stock                  ,0) as  prev_oa_total_d_mobilitaet_stock                  ,
  coalesce(oa_total_d_sonstiges_stock                   ,0) as  prev_oa_total_d_sonstiges_stock                   ,
  coalesce(oa_total_d_gastronomie_stock                 ,0) as  prev_oa_total_d_gastronomie_stock                 ,
  coalesce(oa_total_d_religion_stock                    ,0) as  prev_oa_total_d_religion_stock                    ,
  coalesce(oa_total_d_oeffentlicher_raum_stock          ,0) as  prev_oa_total_d_oeffentlicher_raum_stock          ,
  coalesce(oa_total_d_dienstleistung_stock              ,0) as  prev_oa_total_d_dienstleistung_stock              ,
  coalesce(oa_total_d_waren_stock                       ,0) as  prev_oa_total_d_waren_stock                       ,
  coalesce(oa_total_d_leerstand_stock                   ,0) as  prev_oa_total_d_leerstand_stock                   ,
  coalesce(oa_gastro_c_fast_food_stock                  ,0) as  prev_oa_gastro_c_fast_food_stock                  ,
  coalesce(oa_gastro_c_restaurant_stock                 ,0) as  prev_oa_gastro_c_restaurant_stock                 ,
  coalesce(oa_gastro_c_cafe_stock                       ,0) as  prev_oa_gastro_c_cafe_stock                       ,  
  coalesce(oa_gastro_t_restaurant_italiener_stock       ,0) as  prev_oa_gastro_t_restaurant_italiener_stock       ,
  coalesce(oa_gastro_t_restaurant_deutsch_stock         ,0) as  prev_oa_gastro_t_restaurant_deutsch_stock         ,
  coalesce(oa_gastro_t_restaurant_indisch_stock         ,0) as  prev_oa_gastro_t_restaurant_indisch_stock         ,
  coalesce(oa_gastro_t_restaurant_asiatisch_stock       ,0) as  prev_oa_gastro_t_restaurant_asiatisch_stock       ,
  coalesce(oa_gastro_t_restaurant_sushi_stock           ,0) as  prev_oa_gastro_t_restaurant_sushi_stock           ,
  coalesce(oa_gastro_t_restaurant_griechisch_stock      ,0) as  prev_oa_gastro_t_restaurant_griechisch_stock      ,
  coalesce(oa_gastro_t_restaurant_steakhouse_stock      ,0) as  prev_oa_gastro_t_restaurant_steakhouse_stock      ,
  coalesce(oa_gastro_t_restaurant_international_stock   ,0) as  prev_oa_gastro_t_restaurant_international_stock   ,
  coalesce(oa_gastro_t_restaurant_tuerkisch_stock       ,0) as  prev_oa_gastro_t_restaurant_tuerkisch_stock       ,
  coalesce(oa_gastro_t_restaurant_sonstiges_stock       ,0) as  prev_oa_gastro_t_restaurant_sonstiges_stock       ,
  coalesce(oa_gastro_t_eisdiele_stock                   ,0) as  prev_oa_gastro_t_eisdiele_stock                   ,
  coalesce(oa_gastro_t_sonstige_cafes_stock             ,0) as  prev_oa_gastro_t_sonstige_cafes_stock             ,
  coalesce(oa_gastro_t_kaffee_stock                     ,0) as  prev_oa_gastro_t_kaffee_stock                     ,
  coalesce(oa_gastro_t_fastfood_kebap_stock             ,0) as  prev_oa_gastro_t_fastfood_kebap_stock             ,
  coalesce(oa_gastro_t_fastfood_burger_stock            ,0) as  prev_oa_gastro_t_fastfood_burger_stock            ,
  coalesce(oa_gastro_t_fastfood_asiatisch_stock         ,0) as  prev_oa_gastro_t_fastfood_asiatisch_stock         ,
  coalesce(oa_gastro_t_fastfood_pizza_stock             ,0) as  prev_oa_gastro_t_fastfood_pizza_stock             ,
  coalesce(oa_gastro_t_fastfood_pommesbude_stock        ,0) as  prev_oa_gastro_t_fastfood_pommesbude_stock        ,
  coalesce(oa_gastro_t_fast_food_sonstiges_stock        ,0) as  prev_oa_gastro_t_fast_food_sonstiges_stock        ,
  coalesce(oa_dl_c_friseur_stock                        ,0) as  prev_oa_dl_c_friseur_stock                        ,
  coalesce(oa_dl_c_kosmetik_und_beauty_stock            ,0) as  prev_oa_dl_c_kosmetik_und_beauty_stock            ,
  coalesce(oa_dl_c_massage_stock                        ,0) as  prev_oa_dl_c_massage_stock                        ,
  coalesce(oa_dl_c_reisen_stock                         ,0) as  prev_oa_dl_c_reisen_stock                         ,
  coalesce(oa_dl_c_waescherei_stock                     ,0) as  prev_oa_dl_c_waescherei_stock                     ,
  coalesce(oa_dl_c_beerdigung_stock                     ,0) as  prev_oa_dl_c_beerdigung_stock                     ,
  coalesce(oa_pubserv_c_bildung_stock                   ,0) as  prev_oa_pubserv_c_bildung_stock                   ,
  coalesce(oa_pubserv_c_sicherheit_stock                ,0) as  prev_oa_pubserv_c_sicherheit_stock                ,
  coalesce(oa_pubserv_c_sonstiges_stock                 ,0) as  prev_oa_pubserv_c_sonstiges_stock                 ,
  coalesce(oa_pubserv_c_sozial_stock                    ,0) as  prev_oa_pubserv_c_sozial_stock                    ,
  coalesce(oa_pubserv_c_gesundheit_stock                ,0) as  prev_oa_pubserv_c_gesundheit_stock                ,
  coalesce(oa_pubserv_c_bank_stock                      ,0) as  prev_oa_pubserv_c_bank_stock                      ,
  coalesce(oa_waren_c_essen_und_trinken_stock           ,0) as  prev_oa_waren_c_essen_und_trinken_stock           ,
  coalesce(oa_waren_c_kleidung_stock                    ,0) as  prev_oa_waren_c_kleidung_stock                    ,
  coalesce(oa_waren_c_sonstige_waren_stock              ,0) as  prev_oa_waren_c_sonstige_waren_stock              ,
  coalesce(oa_waren_c_werkstatt_stock                   ,0) as  prev_oa_waren_c_werkstatt_stock                   ,
  coalesce(oa_waren_c_medical_stock                     ,0) as  prev_oa_waren_c_medical_stock                     ,
  coalesce(oa_waren_c_print_stock                       ,0) as  prev_oa_waren_c_print_stock                       ,
  coalesce(oa_waren_c_drogerie_stock                    ,0) as  prev_oa_waren_c_drogerie_stock                    ,
  coalesce(oa_waren_c_technik_stock                     ,0) as  prev_oa_waren_c_technik_stock                     ,
  coalesce(oa_waren_c_spielzeug_und_geschenke_stock     ,0) as  prev_oa_waren_c_spielzeug_und_geschenke_stock     ,
  coalesce(oa_waren_c_kunst_stock                       ,0) as  prev_oa_waren_c_kunst_stock                       ,
  coalesce(oa_waren_c_handwerk_stock                    ,0) as  prev_oa_waren_c_handwerk_stock                    ,
  coalesce(oa_waren_c_sonstiger_shop_stock              ,0) as  prev_oa_waren_c_sonstiger_shop_stock              ,
  coalesce(oa_vergnuegung_t_kunstzentrum_stock          ,0) as  prev_oa_vergnuegung_t_kunstzentrum_stock          ,
  coalesce(oa_vergnuegung_t_gallerie_stock              ,0) as  prev_oa_vergnuegung_t_gallerie_stock              ,
  coalesce(oa_vergnuegung_t_museum_stock                ,0) as  prev_oa_vergnuegung_t_museum_stock                ,
  coalesce(oa_vergnuegung_t_zoo_stock                   ,0) as  prev_oa_vergnuegung_t_zoo_stock                   ,
  coalesce(oa_vergnuegung_t_spielothek_stock            ,0) as  prev_oa_vergnuegung_t_spielothek_stock            ,
  coalesce(oa_vergnuegung_t_kino_stock                  ,0) as  prev_oa_vergnuegung_t_kino_stock                  ,
  coalesce(oa_vergnuegung_t_biergarten_stock            ,0) as  prev_oa_vergnuegung_t_biergarten_stock            ,
  coalesce(oa_vergnuegung_t_theater_stock               ,0) as  prev_oa_vergnuegung_t_theater_stock               ,
  coalesce(oa_vergnuegung_t_nachtclub_stock             ,0) as  prev_oa_vergnuegung_t_nachtclub_stock             ,
  coalesce(oa_vergnuegung_t_bordell_stock               ,0) as  prev_oa_vergnuegung_t_bordell_stock               ,
  coalesce(oa_vergnuegung_t_bar_stock                   ,0) as  prev_oa_vergnuegung_t_bar_stock                   ,
  coalesce(oa_vergnuegung_t_pub_stock                   ,0) as  prev_oa_vergnuegung_t_pub_stock                   ,
  coalesce(oa_sport_t_schwimmen_stock                   ,0) as  prev_oa_sport_t_schwimmen_stock                   ,
  coalesce(oa_sport_t_basketball_stock                  ,0) as  prev_oa_sport_t_basketball_stock                  ,
  coalesce(oa_sport_t_fussball_stock                    ,0) as  prev_oa_sport_t_fussball_stock                    ,
  coalesce(oa_sport_t_sportzentrum_stock                ,0) as  prev_oa_sport_t_sportzentrum_stock                ,
  coalesce(oa_sport_t_tischtennis_stock                 ,0) as  prev_oa_sport_t_tischtennis_stock                 ,
  coalesce(oa_sport_t_sauna_stock                       ,0) as  prev_oa_sport_t_sauna_stock                       ,
  coalesce(oa_sport_t_tennis_stock                      ,0) as  prev_oa_sport_t_tennis_stock                      ,
  coalesce(oa_sport_t_kampfsport_stock                  ,0) as  prev_oa_sport_t_kampfsport_stock                  ,
  coalesce(oa_sport_t_fitnesszentrum_stock              ,0) as  prev_oa_sport_t_fitnesszentrum_stock              ,
  coalesce(oa_sport_t_spielplatz_stock                  ,0) as  prev_oa_sport_t_spielplatz_stock                  ,
  coalesce(oa_sport_t_wassersport_stock                 ,0) as  prev_oa_sport_t_wassersport_stock                 ,
  coalesce(oa_sport_t_sonstige_sportarten_stock         ,0) as  prev_oa_sport_t_sonstige_sportarten_stock         ,
  coalesce(oa_sport_t_sonstiges_sport_stock             ,0) as  prev_oa_sport_t_sonstiges_sport_stock             ,
  coalesce(oa_sport_t_sonstiges_erholung_stock          ,0) as  prev_oa_sport_t_sonstiges_erholung_stock          
  from osm_poi_oa_distcalc 
  where timeslice in (201501) 
) oa_prev
on ewr.zeit = oa_prev.timeslice
and cast(ewr.planungsraum as int) = cast(oa_prev.planungsraum as int)


left join 
(select 
  planungsraum,
  201612 as timeslice,

t_hostel_stock                                          as prev_t_hostel_stock                                     ,
t_hotel_stock                                           as prev_t_hotel_stock                                      ,
t_sonstige_stock                                        as prev_t_sonstige_stock                                   ,
t_kunstwerk_stock                                       as prev_t_kunstwerk_stock                                  ,
t_kunstzentrum_stock                                    as prev_t_kunstzentrum_stock                               ,
t_gallerie_stock                                        as prev_t_gallerie_stock                                   ,
t_info_stock                                            as prev_t_info_stock                                       ,
t_museum_stock                                          as prev_t_museum_stock                                     ,
t_aussichtspunkt_stock                                  as prev_t_aussichtspunkt_stock                             ,
t_zoo_stock                                             as prev_t_zoo_stock                                        ,
t_schwimmen_stock                                       as prev_t_schwimmen_stock                                  ,
t_basketball_stock                                      as prev_t_basketball_stock                                 ,
t_fussball_stock                                        as prev_t_fussball_stock                                   ,
t_sportzentrum_stock                                    as prev_t_sportzentrum_stock                               ,
t_tischtennis_stock                                     as prev_t_tischtennis_stock                                ,
t_sauna_stock                                           as prev_t_sauna_stock                                      ,
t_tennis_stock                                          as prev_t_tennis_stock                                     ,
t_kampfsport_stock                                      as prev_t_kampfsport_stock                                 ,
t_fitnesszentrum_stock                                  as prev_t_fitnesszentrum_stock                             ,
t_spielplatz_stock                                      as prev_t_spielplatz_stock                                 ,
t_wassersport_stock                                     as prev_t_wassersport_stock                                ,
t_spielothek_stock                                      as prev_t_spielothek_stock                                 ,
t_sonstige_sportarten_stock                             as prev_t_sonstige_sportarten_stock                        ,
t_kindergarten_stock                                    as prev_t_kindergarten_stock                               ,
t_buero_stock                                           as prev_t_buero_stock                                      ,
t_tankstelle_stock                                      as prev_t_tankstelle_stock                                 ,
t_coworking_space_stock                                 as prev_t_coworking_space_stock                            ,
t_universitaet_stock                                    as prev_t_universitaet_stock                               ,
t_poilzei_stock                                         as prev_t_poilzei_stock                                    ,
t_feuerwehr_stock                                       as prev_t_feuerwehr_stock                                  ,
t_kita_stock                                            as prev_t_kita_stock                                       ,
t_hoehere_schule_stock                                  as prev_t_hoehere_schule_stock                             ,
t_wochenmarkt_stock                                     as prev_t_wochenmarkt_stock                                ,
t_kino_stock                                            as prev_t_kino_stock                                       ,
t_biergarten_stock                                      as prev_t_biergarten_stock                                 ,
t_autovermietung_stock                                  as prev_t_autovermietung_stock                             ,
t_buecherei_stock                                       as prev_t_buecherei_stock                                  ,
t_nachbarschaftszentrum_stock                           as prev_t_nachbarschaftszentrum_stock                      ,
t_theater_stock                                         as prev_t_theater_stock                                    ,
t_eisdiele_stock                                        as prev_t_eisdiele_stock                                   ,
t_nachtclub_stock                                       as prev_t_nachtclub_stock                                  ,
t_kirche_stock                                          as prev_t_kirche_stock                                     ,
t_moschee_stock                                         as prev_t_moschee_stock                                    ,
t_sonstige_tempel_stock                                 as prev_t_sonstige_tempel_stock                            ,
t_schule_stock                                          as prev_t_schule_stock                                     ,
t_bordell_stock                                         as prev_t_bordell_stock                                    ,
t_post_filiale_stock                                    as prev_t_post_filiale_stock                               ,
t_sozialeinrichtung_stock                               as prev_t_sozialeinrichtung_stock                          ,
t_ladestation_stock                                     as prev_t_ladestation_stock                                ,
t_zahnarzt_stock                                        as prev_t_zahnarzt_stock                                   ,
t_fahrradverleih_stock                                  as prev_t_fahrradverleih_stock                             ,
t_fahrschule_stock                                      as prev_t_fahrschule_stock                                 ,
t_tierarzt_stock                                        as prev_t_tierarzt_stock                                   ,
t_botschaft_stock                                       as prev_t_botschaft_stock                                  ,
t_taxistand_stock                                       as prev_t_taxistand_stock                                  ,
t_wc_stock                                              as prev_t_wc_stock                                         ,
t_bankfiliale_stock                                     as prev_t_bankfiliale_stock                                ,
t_arzt_stock                                            as prev_t_arzt_stock                                       ,
t_parkplatz_stock                                       as prev_t_parkplatz_stock                                  ,
t_bar_stock                                             as prev_t_bar_stock                                        ,
t_apotheke_stock                                        as prev_t_apotheke_stock                                   ,
t_pub_stock                                             as prev_t_pub_stock                                        ,
t_telefon_stock                                         as prev_t_telefon_stock                                    ,
t_kaffee_stock                                          as prev_t_kaffee_stock                                     ,
t_sonstige_cafes_stock                                  as prev_t_sonstige_cafes_stock                             ,
t_fahrrad_parkplatz_stock                               as prev_t_fahrrad_parkplatz_stock                          ,
t_muelleimer_stock                                      as prev_t_muelleimer_stock                                 ,
t_parkbank_stock                                        as prev_t_parkbank_stock                                   ,
t_krankenhaus_stock                                     as prev_t_krankenhaus_stock                                ,
t_klinik_stock                                          as prev_t_klinik_stock                                     ,
t_geldautomat_stock                                     as prev_t_geldautomat_stock                                ,
t_briefkasten_stock                                     as prev_t_briefkasten_stock                                ,
t_friedhof_stock                                        as prev_t_friedhof_stock                                   ,
t_musikschule_stock                                     as prev_t_musikschule_stock                                ,
t_paketautomat_stock                                    as prev_t_paketautomat_stock                               ,
t_sonstige_automaten_stock                              as prev_t_sonstige_automaten_stock                         ,
t_fahrscheinautomat_stock                               as prev_t_fahrscheinautomat_stock                          ,
t_parkticketautomat_stock                               as prev_t_parkticketautomat_stock                          ,
t_kotbeutelautomat_stock                                as prev_t_kotbeutelautomat_stock                           ,
t_zigarettenautomat_stock                               as prev_t_zigarettenautomat_stock                          ,
t_suessigkeitenautomat_stock                            as prev_t_suessigkeitenautomat_stock                       ,
t_briefmarkenautomat_stock                              as prev_t_briefmarkenautomat_stock                         ,
t_kondomautomat_stock                                   as prev_t_kondomautomat_stock                              ,
t_getraenke_und_suessigkeitenautomat_stock              as prev_t_getraenke_und_suessigkeitenautomat_stock         ,
t_getraenkeautomat_stock                                as prev_t_getraenkeautomat_stock                           ,
t_grillplatz_stock                                      as prev_t_grillplatz_stock                                 ,
t_glascontainer_stock                                   as prev_t_glascontainer_stock                              ,
t_glas__und_kleidungscontainer_stock                    as prev_t_glas__und_kleidungscontainer_stock               ,
t_kleidungscontainer_stock                              as prev_t_kleidungscontainer_stock                         ,
t_sonstige_container_stock                              as prev_t_sonstige_container_stock                         ,
t_restaurant_italiener_stock                            as prev_t_restaurant_italiener_stock                       ,
t_restaurant_deutsch_stock                              as prev_t_restaurant_deutsch_stock                         ,
t_restaurant_indisch_stock                              as prev_t_restaurant_indisch_stock                         ,
t_restaurant_asiatisch_stock                            as prev_t_restaurant_asiatisch_stock                       ,
t_restaurant_sushi_stock                                as prev_t_restaurant_sushi_stock                           ,
t_restaurant_griechisch_stock                           as prev_t_restaurant_griechisch_stock                      ,
t_restaurant_steakhouse_stock                           as prev_t_restaurant_steakhouse_stock                      ,
t_restaurant_international_stock                        as prev_t_restaurant_international_stock                   ,
t_restaurant_tuerkisch_stock                            as prev_t_restaurant_tuerkisch_stock                       ,
t_fastfood_kebap_stock                                  as prev_t_fastfood_kebap_stock                             ,
t_fastfood_burger_stock                                 as prev_t_fastfood_burger_stock                            ,
t_fastfood_asiatisch_stock                              as prev_t_fastfood_asiatisch_stock                         ,
t_fastfood_pizza_stock                                  as prev_t_fastfood_pizza_stock                             ,
t_fastfood_pommesbude_stock                             as prev_t_fastfood_pommesbude_stock                        ,
t_fast_food_sonstiges_stock                             as prev_t_fast_food_sonstiges_stock                        ,
t_restaurant_sonstiges_stock                            as prev_t_restaurant_sonstiges_stock                       ,
t_friseur_stock                                         as prev_t_friseur_stock                                    ,
t_baeckerei_stock                                       as prev_t_baeckerei_stock                                  ,
t_kleidung_stock                                        as prev_t_kleidung_stock                                   ,
t_supermarkt_stock                                      as prev_t_supermarkt_stock                                 ,
t_kiosk_stock                                           as prev_t_kiosk_stock                                      ,
t_florist_stock                                         as prev_t_florist_stock                                    ,
t_fahrrad_stock                                         as prev_t_fahrrad_stock                                    ,
t_kosmetik_und_beauty_stock                             as prev_t_kosmetik_und_beauty_stock                        ,
t_optiker_stock                                         as prev_t_optiker_stock                                    ,
t_schuhe_stock                                          as prev_t_schuhe_stock                                     ,
t_buecher_stock                                         as prev_t_buecher_stock                                    ,
t_massage_stock                                         as prev_t_massage_stock                                    ,
t_schmuck_stock                                         as prev_t_schmuck_stock                                    ,
t_autoreperatur_stock                                   as prev_t_autoreperatur_stock                              ,
t_drogerie_stock                                        as prev_t_drogerie_stock                                   ,
t_reisen_stock                                          as prev_t_reisen_stock                                     ,
t_mobilfunk_stock                                       as prev_t_mobilfunk_stock                                  ,
t_moebel_stock                                          as prev_t_moebel_stock                                     ,
t_getraenke_stock                                       as prev_t_getraenke_stock                                  ,
t_feinkost_stock                                        as prev_t_feinkost_stock                                   ,
t_elektronik_stock                                      as prev_t_elektronik_stock                                 ,
t_boutique_stock                                        as prev_t_boutique_stock                                   ,
t_autohaus_stock                                        as prev_t_autohaus_stock                                   ,
t_spirituosen_stock                                     as prev_t_spirituosen_stock                                ,
t_geschenke_stock                                       as prev_t_geschenke_stock                                  ,
t_postenmarkt_stock                                     as prev_t_postenmarkt_stock                                ,
t_schlachter_stock                                      as prev_t_schlachter_stock                                 ,
t_waescherei_stock                                      as prev_t_waescherei_stock                                 ,
t_computer_stock                                        as prev_t_computer_stock                                   ,
t_spielzeug_stock                                       as prev_t_spielzeug_stock                                  ,
t_copyshop_stock                                        as prev_t_copyshop_stock                                   ,
t_schneider_stock                                       as prev_t_schneider_stock                                  ,
t_foto_stock                                            as prev_t_foto_stock                                       ,
t_kunst_stock                                           as prev_t_kunst_stock                                      ,
t_suessigkeiten_stock                                   as prev_t_suessigkeiten_stock                              ,
t_dekoration_stock                                      as prev_t_dekoration_stock                                 ,
t_reinigung_stock                                       as prev_t_reinigung_stock                                  ,
t_beerdigung_stock                                      as prev_t_beerdigung_stock                                 ,
t_sport_stock                                           as prev_t_sport_stock                                      ,
t_zoofachgeschaeft_stock                                as prev_t_zoofachgeschaeft_stock                           ,
t_textilgeschaeft_stock                                 as prev_t_textilgeschaeft_stock                            ,
t_hoergeraete_stock                                     as prev_t_hoergeraete_stock                                ,
t_baumarkt_stock                                        as prev_t_baumarkt_stock                                   ,
t_leerstand_stock                                       as prev_t_leerstand_stock                                  ,
t_medical_stock                                         as prev_t_medical_stock                                    ,
t_second_hand_stock                                     as prev_t_second_hand_stock                                ,
t_zeitung_stock                                         as prev_t_zeitung_stock                                    ,
t_eisenwarenhandlung_stock                              as prev_t_eisenwarenhandlung_stock                         ,
t_sonstiger_shop_stock                                  as prev_t_sonstiger_shop_stock                             ,
t_baudenkmal_stock                                      as prev_t_baudenkmal_stock                                 ,
t_haltestelle_stock                                     as prev_t_haltestelle_stock                                ,
t_sonstiges_gebaeude_stock                              as prev_t_sonstiges_gebaeude_stock                         ,
t_sonstiges_gelaende_stock                              as prev_t_sonstiges_gelaende_stock                         ,
t_sonstiges_denkmal_stock                               as prev_t_sonstiges_denkmal_stock                          ,
t_sonstiges_tourismus_stock                             as prev_t_sonstiges_tourismus_stock                        ,
t_sonstiges_sport_stock                                 as prev_t_sonstiges_sport_stock                            ,
t_sonstiges_erholung_stock                              as prev_t_sonstiges_erholung_stock


  from osm_poi_features_type_piv_distcalc
  where timeslice in (201501) 
) stock_t_prev
on ewr.zeit = stock_t_prev.timeslice
and cast(ewr.planungsraum as int) = cast(stock_t_prev.planungsraum as int)

left join 
(select 
  planungsraum,
  201612 as timeslice,

t_hostel_stock,
t_hotel_stock,
t_sonstige_stock,
t_kunstwerk_stock,
t_kunstzentrum_stock,
t_gallerie_stock,
t_info_stock,
t_museum_stock,
t_aussichtspunkt_stock,
t_zoo_stock,
t_schwimmen_stock,
t_basketball_stock,
t_fussball_stock,
t_sportzentrum_stock,
t_tischtennis_stock,
t_sauna_stock,
t_tennis_stock,
t_kampfsport_stock,
t_fitnesszentrum_stock,
t_spielplatz_stock,
t_wassersport_stock,
t_spielothek_stock,
t_sonstige_sportarten_stock,
t_kindergarten_stock,
t_buero_stock,
t_tankstelle_stock,
t_coworking_space_stock,
t_universitaet_stock,
t_poilzei_stock,
t_feuerwehr_stock,
t_kita_stock,
t_hoehere_schule_stock,
t_wochenmarkt_stock,
t_kino_stock,
t_biergarten_stock,
t_autovermietung_stock,
t_buecherei_stock,
t_nachbarschaftszentrum_stock,
t_theater_stock,
t_eisdiele_stock,
t_nachtclub_stock,
t_kirche_stock,
t_moschee_stock,
t_sonstige_tempel_stock,
t_schule_stock,
t_bordell_stock,
t_post_filiale_stock,
t_sozialeinrichtung_stock,
t_ladestation_stock,
t_zahnarzt_stock,
t_fahrradverleih_stock,
t_fahrschule_stock,
t_tierarzt_stock,
t_botschaft_stock,
t_taxistand_stock,
t_wc_stock,
t_bankfiliale_stock,
t_arzt_stock,
t_parkplatz_stock,
t_bar_stock,
t_apotheke_stock,
t_pub_stock,
t_telefon_stock,
t_kaffee_stock,
t_sonstige_cafes_stock,
t_fahrrad_parkplatz_stock,
t_muelleimer_stock,
t_parkbank_stock,
t_krankenhaus_stock,
t_klinik_stock,
t_geldautomat_stock,
t_briefkasten_stock,
t_friedhof_stock,
t_musikschule_stock,
t_paketautomat_stock,
t_sonstige_automaten_stock,
t_fahrscheinautomat_stock,
t_parkticketautomat_stock,
t_kotbeutelautomat_stock,
t_zigarettenautomat_stock,
t_suessigkeitenautomat_stock,
t_briefmarkenautomat_stock,
t_kondomautomat_stock,
t_getraenke_und_suessigkeitenautomat_stock,
t_getraenkeautomat_stock,
t_grillplatz_stock,
t_glascontainer_stock,
t_glas__und_kleidungscontainer_stock,
t_kleidungscontainer_stock,
t_sonstige_container_stock,
t_restaurant_italiener_stock,
t_restaurant_deutsch_stock,
t_restaurant_indisch_stock,
t_restaurant_asiatisch_stock,
t_restaurant_sushi_stock,
t_restaurant_griechisch_stock,
t_restaurant_steakhouse_stock,
t_restaurant_international_stock,
t_restaurant_tuerkisch_stock,
t_fastfood_kebap_stock,
t_fastfood_burger_stock,
t_fastfood_asiatisch_stock,
t_fastfood_pizza_stock,
t_fastfood_pommesbude_stock,
t_fast_food_sonstiges_stock,
t_restaurant_sonstiges_stock,
t_friseur_stock,
t_baeckerei_stock,
t_kleidung_stock,
t_supermarkt_stock,
t_kiosk_stock,
t_florist_stock,
t_fahrrad_stock,
t_kosmetik_und_beauty_stock,
t_optiker_stock,
t_schuhe_stock,
t_buecher_stock,
t_massage_stock,
t_schmuck_stock,
t_autoreperatur_stock,
t_drogerie_stock,
t_reisen_stock,
t_mobilfunk_stock,
t_moebel_stock,
t_getraenke_stock,
t_feinkost_stock,
t_elektronik_stock,
t_boutique_stock,
t_autohaus_stock,
t_spirituosen_stock,
t_geschenke_stock,
t_postenmarkt_stock,
t_schlachter_stock,
t_waescherei_stock,
t_computer_stock,
t_spielzeug_stock,
t_copyshop_stock,
t_schneider_stock,
t_foto_stock,
t_kunst_stock,
t_suessigkeiten_stock,
t_dekoration_stock,
t_reinigung_stock,
t_beerdigung_stock,
t_sport_stock,
t_zoofachgeschaeft_stock,
t_textilgeschaeft_stock,
t_hoergeraete_stock,
t_baumarkt_stock,
t_leerstand_stock,
t_medical_stock,
t_second_hand_stock,
t_zeitung_stock,
t_eisenwarenhandlung_stock,
t_sonstiger_shop_stock,
t_baudenkmal_stock,
t_haltestelle_stock,
t_sonstiges_gebaeude_stock,
t_sonstiges_gelaende_stock,
t_sonstiges_denkmal_stock,
t_sonstiges_tourismus_stock,
t_sonstiges_sport_stock,
t_sonstiges_erholung_stock


  from osm_poi_features_type_piv_distcalc
  where timeslice in (201701) 
) stock_t
on ewr.zeit = stock_t.timeslice
and cast(ewr.planungsraum as int) = cast(stock_t.planungsraum as int)
left join
(select
  planungsraum,
  201612 as timeslice,

SUM(t_hostel_ytd) as t_hostel_ytd,
SUM(t_hotel_ytd) as t_hotel_ytd,
SUM(t_sonstige_ytd) as t_sonstige_ytd,
SUM(t_kunstwerk_ytd) as t_kunstwerk_ytd,
SUM(t_kunstzentrum_ytd) as t_kunstzentrum_ytd,
SUM(t_gallerie_ytd) as t_gallerie_ytd,
SUM(t_info_ytd) as t_info_ytd,
SUM(t_museum_ytd) as t_museum_ytd,
SUM(t_aussichtspunkt_ytd) as t_aussichtspunkt_ytd,
SUM(t_zoo_ytd) as t_zoo_ytd,
SUM(t_schwimmen_ytd) as t_schwimmen_ytd,
SUM(t_basketball_ytd) as t_basketball_ytd,
SUM(t_fussball_ytd) as t_fussball_ytd,
SUM(t_sportzentrum_ytd) as t_sportzentrum_ytd,
SUM(t_tischtennis_ytd) as t_tischtennis_ytd,
SUM(t_sauna_ytd) as t_sauna_ytd,
SUM(t_tennis_ytd) as t_tennis_ytd,
SUM(t_kampfsport_ytd) as t_kampfsport_ytd,
SUM(t_fitnesszentrum_ytd) as t_fitnesszentrum_ytd,
SUM(t_spielplatz_ytd) as t_spielplatz_ytd,
SUM(t_wassersport_ytd) as t_wassersport_ytd,
SUM(t_spielothek_ytd) as t_spielothek_ytd,
SUM(t_sonstige_sportarten_ytd) as t_sonstige_sportarten_ytd,
SUM(t_kindergarten_ytd) as t_kindergarten_ytd,
SUM(t_buero_ytd) as t_buero_ytd,
SUM(t_tankstelle_ytd) as t_tankstelle_ytd,
SUM(t_coworking_space_ytd) as t_coworking_space_ytd,
SUM(t_universitaet_ytd) as t_universitaet_ytd,
SUM(t_poilzei_ytd) as t_poilzei_ytd,
SUM(t_feuerwehr_ytd) as t_feuerwehr_ytd,
SUM(t_kita_ytd) as t_kita_ytd,
SUM(t_hoehere_schule_ytd) as t_hoehere_schule_ytd,
SUM(t_wochenmarkt_ytd) as t_wochenmarkt_ytd,
SUM(t_kino_ytd) as t_kino_ytd,
SUM(t_biergarten_ytd) as t_biergarten_ytd,
SUM(t_autovermietung_ytd) as t_autovermietung_ytd,
SUM(t_buecherei_ytd) as t_buecherei_ytd,
SUM(t_nachbarschaftszentrum_ytd) as t_nachbarschaftszentrum_ytd,
SUM(t_theater_ytd) as t_theater_ytd,
SUM(t_eisdiele_ytd) as t_eisdiele_ytd,
SUM(t_nachtclub_ytd) as t_nachtclub_ytd,
SUM(t_kirche_ytd) as t_kirche_ytd,
SUM(t_moschee_ytd) as t_moschee_ytd,
SUM(t_sonstige_tempel_ytd) as t_sonstige_tempel_ytd,
SUM(t_schule_ytd) as t_schule_ytd,
SUM(t_bordell_ytd) as t_bordell_ytd,
SUM(t_post_filiale_ytd) as t_post_filiale_ytd,
SUM(t_sozialeinrichtung_ytd) as t_sozialeinrichtung_ytd,
SUM(t_ladestation_ytd) as t_ladestation_ytd,
SUM(t_zahnarzt_ytd) as t_zahnarzt_ytd,
SUM(t_fahrradverleih_ytd) as t_fahrradverleih_ytd,
SUM(t_fahrschule_ytd) as t_fahrschule_ytd,
SUM(t_tierarzt_ytd) as t_tierarzt_ytd,
SUM(t_botschaft_ytd) as t_botschaft_ytd,
SUM(t_taxistand_ytd) as t_taxistand_ytd,
SUM(t_wc_ytd) as t_wc_ytd,
SUM(t_bankfiliale_ytd) as t_bankfiliale_ytd,
SUM(t_arzt_ytd) as t_arzt_ytd,
SUM(t_parkplatz_ytd) as t_parkplatz_ytd,
SUM(t_bar_ytd) as t_bar_ytd,
SUM(t_apotheke_ytd) as t_apotheke_ytd,
SUM(t_pub_ytd) as t_pub_ytd,
SUM(t_telefon_ytd) as t_telefon_ytd,
SUM(t_kaffee_ytd) as t_kaffee_ytd,
SUM(t_sonstige_cafes_ytd) as t_sonstige_cafes_ytd,
SUM(t_fahrrad_parkplatz_ytd) as t_fahrrad_parkplatz_ytd,
SUM(t_muelleimer_ytd) as t_muelleimer_ytd,
SUM(t_parkbank_ytd) as t_parkbank_ytd,
SUM(t_krankenhaus_ytd) as t_krankenhaus_ytd,
SUM(t_klinik_ytd) as t_klinik_ytd,
SUM(t_geldautomat_ytd) as t_geldautomat_ytd,
SUM(t_briefkasten_ytd) as t_briefkasten_ytd,
SUM(t_friedhof_ytd) as t_friedhof_ytd,
SUM(t_musikschule_ytd) as t_musikschule_ytd,
SUM(t_paketautomat_ytd) as t_paketautomat_ytd,
SUM(t_sonstige_automaten_ytd) as t_sonstige_automaten_ytd,
SUM(t_fahrscheinautomat_ytd) as t_fahrscheinautomat_ytd,
SUM(t_parkticketautomat_ytd) as t_parkticketautomat_ytd,
SUM(t_kotbeutelautomat_ytd) as t_kotbeutelautomat_ytd,
SUM(t_zigarettenautomat_ytd) as t_zigarettenautomat_ytd,
SUM(t_suessigkeitenautomat_ytd) as t_suessigkeitenautomat_ytd,
SUM(t_briefmarkenautomat_ytd) as t_briefmarkenautomat_ytd,
SUM(t_kondomautomat_ytd) as t_kondomautomat_ytd,
SUM(t_getraenke_und_suessigkeitenautomat_ytd) as t_getraenke_und_suessigkeitenautomat_ytd,
SUM(t_getraenkeautomat_ytd) as t_getraenkeautomat_ytd,
SUM(t_grillplatz_ytd) as t_grillplatz_ytd,
SUM(t_glascontainer_ytd) as t_glascontainer_ytd,
SUM(t_glas__und_kleidungscontainer_ytd) as t_glas__und_kleidungscontainer_ytd,
SUM(t_kleidungscontainer_ytd) as t_kleidungscontainer_ytd,
SUM(t_sonstige_container_ytd) as t_sonstige_container_ytd,
SUM(t_restaurant_italiener_ytd) as t_restaurant_italiener_ytd,
SUM(t_restaurant_deutsch_ytd) as t_restaurant_deutsch_ytd,
SUM(t_restaurant_indisch_ytd) as t_restaurant_indisch_ytd,
SUM(t_restaurant_asiatisch_ytd) as t_restaurant_asiatisch_ytd,
SUM(t_restaurant_sushi_ytd) as t_restaurant_sushi_ytd,
SUM(t_restaurant_griechisch_ytd) as t_restaurant_griechisch_ytd,
SUM(t_restaurant_steakhouse_ytd) as t_restaurant_steakhouse_ytd,
SUM(t_restaurant_international_ytd) as t_restaurant_international_ytd,
SUM(t_restaurant_tuerkisch_ytd) as t_restaurant_tuerkisch_ytd,
SUM(t_fastfood_kebap_ytd) as t_fastfood_kebap_ytd,
SUM(t_fastfood_burger_ytd) as t_fastfood_burger_ytd,
SUM(t_fastfood_asiatisch_ytd) as t_fastfood_asiatisch_ytd,
SUM(t_fastfood_pizza_ytd) as t_fastfood_pizza_ytd,
SUM(t_fastfood_pommesbude_ytd) as t_fastfood_pommesbude_ytd,
SUM(t_fast_food_sonstiges_ytd) as t_fast_food_sonstiges_ytd,
SUM(t_restaurant_sonstiges_ytd) as t_restaurant_sonstiges_ytd,
SUM(t_friseur_ytd) as t_friseur_ytd,
SUM(t_baeckerei_ytd) as t_baeckerei_ytd,
SUM(t_kleidung_ytd) as t_kleidung_ytd,
SUM(t_supermarkt_ytd) as t_supermarkt_ytd,
SUM(t_kiosk_ytd) as t_kiosk_ytd,
SUM(t_florist_ytd) as t_florist_ytd,
SUM(t_fahrrad_ytd) as t_fahrrad_ytd,
SUM(t_kosmetik_und_beauty_ytd) as t_kosmetik_und_beauty_ytd,
SUM(t_optiker_ytd) as t_optiker_ytd,
SUM(t_schuhe_ytd) as t_schuhe_ytd,
SUM(t_buecher_ytd) as t_buecher_ytd,
SUM(t_massage_ytd) as t_massage_ytd,
SUM(t_schmuck_ytd) as t_schmuck_ytd,
SUM(t_autoreperatur_ytd) as t_autoreperatur_ytd,
SUM(t_drogerie_ytd) as t_drogerie_ytd,
SUM(t_reisen_ytd) as t_reisen_ytd,
SUM(t_mobilfunk_ytd) as t_mobilfunk_ytd,
SUM(t_moebel_ytd) as t_moebel_ytd,
SUM(t_getraenke_ytd) as t_getraenke_ytd,
SUM(t_feinkost_ytd) as t_feinkost_ytd,
SUM(t_elektronik_ytd) as t_elektronik_ytd,
SUM(t_boutique_ytd) as t_boutique_ytd,
SUM(t_autohaus_ytd) as t_autohaus_ytd,
SUM(t_spirituosen_ytd) as t_spirituosen_ytd,
SUM(t_geschenke_ytd) as t_geschenke_ytd,
SUM(t_postenmarkt_ytd) as t_postenmarkt_ytd,
SUM(t_schlachter_ytd) as t_schlachter_ytd,
SUM(t_waescherei_ytd) as t_waescherei_ytd,
SUM(t_computer_ytd) as t_computer_ytd,
SUM(t_spielzeug_ytd) as t_spielzeug_ytd,
SUM(t_copyshop_ytd) as t_copyshop_ytd,
SUM(t_schneider_ytd) as t_schneider_ytd,
SUM(t_foto_ytd) as t_foto_ytd,
SUM(t_kunst_ytd) as t_kunst_ytd,
SUM(t_suessigkeiten_ytd) as t_suessigkeiten_ytd,
SUM(t_dekoration_ytd) as t_dekoration_ytd,
SUM(t_reinigung_ytd) as t_reinigung_ytd,
SUM(t_beerdigung_ytd) as t_beerdigung_ytd,
SUM(t_sport_ytd) as t_sport_ytd,
SUM(t_zoofachgeschaeft_ytd) as t_zoofachgeschaeft_ytd,
SUM(t_textilgeschaeft_ytd) as t_textilgeschaeft_ytd,
SUM(t_hoergeraete_ytd) as t_hoergeraete_ytd,
SUM(t_baumarkt_ytd) as t_baumarkt_ytd,
SUM(t_leerstand_ytd) as t_leerstand_ytd,
SUM(t_medical_ytd) as t_medical_ytd,
SUM(t_second_hand_ytd) as t_second_hand_ytd,
SUM(t_zeitung_ytd) as t_zeitung_ytd,
SUM(t_eisenwarenhandlung_ytd) as t_eisenwarenhandlung_ytd,
SUM(t_sonstiger_shop_ytd) as t_sonstiger_shop_ytd,
SUM(t_baudenkmal_ytd) as t_baudenkmal_ytd,
SUM(t_haltestelle_ytd) as t_haltestelle_ytd,
SUM(t_sonstiges_gebaeude_ytd) as t_sonstiges_gebaeude_ytd,
SUM(t_sonstiges_gelaende_ytd) as t_sonstiges_gelaende_ytd,
SUM(t_sonstiges_denkmal_ytd) as t_sonstiges_denkmal_ytd,
SUM(t_sonstiges_tourismus_ytd) as t_sonstiges_tourismus_ytd,
SUM(t_sonstiges_sport_ytd) as t_sonstiges_sport_ytd,
SUM(t_sonstiges_erholung_ytd) as t_sonstiges_erholung_ytd,

SUM(t_hostel_new) as t_hostel_new,
SUM(t_hotel_new) as t_hotel_new,
SUM(t_sonstige_new) as t_sonstige_new,
SUM(t_kunstwerk_new) as t_kunstwerk_new,
SUM(t_kunstzentrum_new) as t_kunstzentrum_new,
SUM(t_gallerie_new) as t_gallerie_new,
SUM(t_info_new) as t_info_new,
SUM(t_museum_new) as t_museum_new,
SUM(t_aussichtspunkt_new) as t_aussichtspunkt_new,
SUM(t_zoo_new) as t_zoo_new,
SUM(t_schwimmen_new) as t_schwimmen_new,
SUM(t_basketball_new) as t_basketball_new,
SUM(t_fussball_new) as t_fussball_new,
SUM(t_sportzentrum_new) as t_sportzentrum_new,
SUM(t_tischtennis_new) as t_tischtennis_new,
SUM(t_sauna_new) as t_sauna_new,
SUM(t_tennis_new) as t_tennis_new,
SUM(t_kampfsport_new) as t_kampfsport_new,
SUM(t_fitnesszentrum_new) as t_fitnesszentrum_new,
SUM(t_spielplatz_new) as t_spielplatz_new,
SUM(t_wassersport_new) as t_wassersport_new,
SUM(t_spielothek_new) as t_spielothek_new,
SUM(t_sonstige_sportarten_new) as t_sonstige_sportarten_new,
SUM(t_kindergarten_new) as t_kindergarten_new,
SUM(t_buero_new) as t_buero_new,
SUM(t_tankstelle_new) as t_tankstelle_new,
SUM(t_coworking_space_new) as t_coworking_space_new,
SUM(t_universitaet_new) as t_universitaet_new,
SUM(t_poilzei_new) as t_poilzei_new,
SUM(t_feuerwehr_new) as t_feuerwehr_new,
SUM(t_kita_new) as t_kita_new,
SUM(t_hoehere_schule_new) as t_hoehere_schule_new,
SUM(t_wochenmarkt_new) as t_wochenmarkt_new,
SUM(t_kino_new) as t_kino_new,
SUM(t_biergarten_new) as t_biergarten_new,
SUM(t_autovermietung_new) as t_autovermietung_new,
SUM(t_buecherei_new) as t_buecherei_new,
SUM(t_nachbarschaftszentrum_new) as t_nachbarschaftszentrum_new,
SUM(t_theater_new) as t_theater_new,
SUM(t_eisdiele_new) as t_eisdiele_new,
SUM(t_nachtclub_new) as t_nachtclub_new,
SUM(t_kirche_new) as t_kirche_new,
SUM(t_moschee_new) as t_moschee_new,
SUM(t_sonstige_tempel_new) as t_sonstige_tempel_new,
SUM(t_schule_new) as t_schule_new,
SUM(t_bordell_new) as t_bordell_new,
SUM(t_post_filiale_new) as t_post_filiale_new,
SUM(t_sozialeinrichtung_new) as t_sozialeinrichtung_new,
SUM(t_ladestation_new) as t_ladestation_new,
SUM(t_zahnarzt_new) as t_zahnarzt_new,
SUM(t_fahrradverleih_new) as t_fahrradverleih_new,
SUM(t_fahrschule_new) as t_fahrschule_new,
SUM(t_tierarzt_new) as t_tierarzt_new,
SUM(t_botschaft_new) as t_botschaft_new,
SUM(t_taxistand_new) as t_taxistand_new,
SUM(t_wc_new) as t_wc_new,
SUM(t_bankfiliale_new) as t_bankfiliale_new,
SUM(t_arzt_new) as t_arzt_new,
SUM(t_parkplatz_new) as t_parkplatz_new,
SUM(t_bar_new) as t_bar_new,
SUM(t_apotheke_new) as t_apotheke_new,
SUM(t_pub_new) as t_pub_new,
SUM(t_telefon_new) as t_telefon_new,
SUM(t_kaffee_new) as t_kaffee_new,
SUM(t_sonstige_cafes_new) as t_sonstige_cafes_new,
SUM(t_fahrrad_parkplatz_new) as t_fahrrad_parkplatz_new,
SUM(t_muelleimer_new) as t_muelleimer_new,
SUM(t_parkbank_new) as t_parkbank_new,
SUM(t_krankenhaus_new) as t_krankenhaus_new,
SUM(t_klinik_new) as t_klinik_new,
SUM(t_geldautomat_new) as t_geldautomat_new,
SUM(t_briefkasten_new) as t_briefkasten_new,
SUM(t_friedhof_new) as t_friedhof_new,
SUM(t_musikschule_new) as t_musikschule_new,
SUM(t_paketautomat_new) as t_paketautomat_new,
SUM(t_sonstige_automaten_new) as t_sonstige_automaten_new,
SUM(t_fahrscheinautomat_new) as t_fahrscheinautomat_new,
SUM(t_parkticketautomat_new) as t_parkticketautomat_new,
SUM(t_kotbeutelautomat_new) as t_kotbeutelautomat_new,
SUM(t_zigarettenautomat_new) as t_zigarettenautomat_new,
SUM(t_suessigkeitenautomat_new) as t_suessigkeitenautomat_new,
SUM(t_briefmarkenautomat_new) as t_briefmarkenautomat_new,
SUM(t_kondomautomat_new) as t_kondomautomat_new,
SUM(t_getraenke_und_suessigkeitenautomat_new) as t_getraenke_und_suessigkeitenautomat_new,
SUM(t_getraenkeautomat_new) as t_getraenkeautomat_new,
SUM(t_grillplatz_new) as t_grillplatz_new,
SUM(t_glascontainer_new) as t_glascontainer_new,
SUM(t_glas__und_kleidungscontainer_new) as t_glas__und_kleidungscontainer_new,
SUM(t_kleidungscontainer_new) as t_kleidungscontainer_new,
SUM(t_sonstige_container_new) as t_sonstige_container_new,
SUM(t_restaurant_italiener_new) as t_restaurant_italiener_new,
SUM(t_restaurant_deutsch_new) as t_restaurant_deutsch_new,
SUM(t_restaurant_indisch_new) as t_restaurant_indisch_new,
SUM(t_restaurant_asiatisch_new) as t_restaurant_asiatisch_new,
SUM(t_restaurant_sushi_new) as t_restaurant_sushi_new,
SUM(t_restaurant_griechisch_new) as t_restaurant_griechisch_new,
SUM(t_restaurant_steakhouse_new) as t_restaurant_steakhouse_new,
SUM(t_restaurant_international_new) as t_restaurant_international_new,
SUM(t_restaurant_tuerkisch_new) as t_restaurant_tuerkisch_new,
SUM(t_fastfood_kebap_new) as t_fastfood_kebap_new,
SUM(t_fastfood_burger_new) as t_fastfood_burger_new,
SUM(t_fastfood_asiatisch_new) as t_fastfood_asiatisch_new,
SUM(t_fastfood_pizza_new) as t_fastfood_pizza_new,
SUM(t_fastfood_pommesbude_new) as t_fastfood_pommesbude_new,
SUM(t_fast_food_sonstiges_new) as t_fast_food_sonstiges_new,
SUM(t_restaurant_sonstiges_new) as t_restaurant_sonstiges_new,
SUM(t_friseur_new) as t_friseur_new,
SUM(t_baeckerei_new) as t_baeckerei_new,
SUM(t_kleidung_new) as t_kleidung_new,
SUM(t_supermarkt_new) as t_supermarkt_new,
SUM(t_kiosk_new) as t_kiosk_new,
SUM(t_florist_new) as t_florist_new,
SUM(t_fahrrad_new) as t_fahrrad_new,
SUM(t_kosmetik_und_beauty_new) as t_kosmetik_und_beauty_new,
SUM(t_optiker_new) as t_optiker_new,
SUM(t_schuhe_new) as t_schuhe_new,
SUM(t_buecher_new) as t_buecher_new,
SUM(t_massage_new) as t_massage_new,
SUM(t_schmuck_new) as t_schmuck_new,
SUM(t_autoreperatur_new) as t_autoreperatur_new,
SUM(t_drogerie_new) as t_drogerie_new,
SUM(t_reisen_new) as t_reisen_new,
SUM(t_mobilfunk_new) as t_mobilfunk_new,
SUM(t_moebel_new) as t_moebel_new,
SUM(t_getraenke_new) as t_getraenke_new,
SUM(t_feinkost_new) as t_feinkost_new,
SUM(t_elektronik_new) as t_elektronik_new,
SUM(t_boutique_new) as t_boutique_new,
SUM(t_autohaus_new) as t_autohaus_new,
SUM(t_spirituosen_new) as t_spirituosen_new,
SUM(t_geschenke_new) as t_geschenke_new,
SUM(t_postenmarkt_new) as t_postenmarkt_new,
SUM(t_schlachter_new) as t_schlachter_new,
SUM(t_waescherei_new) as t_waescherei_new,
SUM(t_computer_new) as t_computer_new,
SUM(t_spielzeug_new) as t_spielzeug_new,
SUM(t_copyshop_new) as t_copyshop_new,
SUM(t_schneider_new) as t_schneider_new,
SUM(t_foto_new) as t_foto_new,
SUM(t_kunst_new) as t_kunst_new,
SUM(t_suessigkeiten_new) as t_suessigkeiten_new,
SUM(t_dekoration_new) as t_dekoration_new,
SUM(t_reinigung_new) as t_reinigung_new,
SUM(t_beerdigung_new) as t_beerdigung_new,
SUM(t_sport_new) as t_sport_new,
SUM(t_zoofachgeschaeft_new) as t_zoofachgeschaeft_new,
SUM(t_textilgeschaeft_new) as t_textilgeschaeft_new,
SUM(t_hoergeraete_new) as t_hoergeraete_new,
SUM(t_baumarkt_new) as t_baumarkt_new,
SUM(t_leerstand_new) as t_leerstand_new,
SUM(t_medical_new) as t_medical_new,
SUM(t_second_hand_new) as t_second_hand_new,
SUM(t_zeitung_new) as t_zeitung_new,
SUM(t_eisenwarenhandlung_new) as t_eisenwarenhandlung_new,
SUM(t_sonstiger_shop_new) as t_sonstiger_shop_new,
SUM(t_baudenkmal_new) as t_baudenkmal_new,
SUM(t_haltestelle_new) as t_haltestelle_new,
SUM(t_sonstiges_gebaeude_new) as t_sonstiges_gebaeude_new,
SUM(t_sonstiges_gelaende_new) as t_sonstiges_gelaende_new,
SUM(t_sonstiges_denkmal_new) as t_sonstiges_denkmal_new,
SUM(t_sonstiges_tourismus_new) as t_sonstiges_tourismus_new,
SUM(t_sonstiges_sport_new) as t_sonstiges_sport_new,
SUM(t_sonstiges_erholung_new) as t_sonstiges_erholung_new

  
  from osm_poi_features_type_piv_distcalc
  where timeslice in (201601, 201701)
  group by planungsraum
) dyn_t
on ewr.zeit = dyn_t.timeslice
and cast(ewr.planungsraum as int) = cast(dyn_t.planungsraum as int)

left join
(select
  planungsraum,
  201612 as timeslice,

SUM(t_hostel_ytd) as prev_t_hostel_ytd,
SUM(t_hotel_ytd) as prev_t_hotel_ytd,
SUM(t_sonstige_ytd) as prev_t_sonstige_ytd,
SUM(t_kunstwerk_ytd) as prev_t_kunstwerk_ytd,
SUM(t_kunstzentrum_ytd) as prev_t_kunstzentrum_ytd,
SUM(t_gallerie_ytd) as prev_t_gallerie_ytd,
SUM(t_info_ytd) as prev_t_info_ytd,
SUM(t_museum_ytd) as prev_t_museum_ytd,
SUM(t_aussichtspunkt_ytd) as prev_t_aussichtspunkt_ytd,
SUM(t_zoo_ytd) as prev_t_zoo_ytd,
SUM(t_schwimmen_ytd) as prev_t_schwimmen_ytd,
SUM(t_basketball_ytd) as prev_t_basketball_ytd,
SUM(t_fussball_ytd) as prev_t_fussball_ytd,
SUM(t_sportzentrum_ytd) as prev_t_sportzentrum_ytd,
SUM(t_tischtennis_ytd) as prev_t_tischtennis_ytd,
SUM(t_sauna_ytd) as prev_t_sauna_ytd,
SUM(t_tennis_ytd) as prev_t_tennis_ytd,
SUM(t_kampfsport_ytd) as prev_t_kampfsport_ytd,
SUM(t_fitnesszentrum_ytd) as prev_t_fitnesszentrum_ytd,
SUM(t_spielplatz_ytd) as prev_t_spielplatz_ytd,
SUM(t_wassersport_ytd) as prev_t_wassersport_ytd,
SUM(t_spielothek_ytd) as prev_t_spielothek_ytd,
SUM(t_sonstige_sportarten_ytd) as prev_t_sonstige_sportarten_ytd,
SUM(t_kindergarten_ytd) as prev_t_kindergarten_ytd,
SUM(t_buero_ytd) as prev_t_buero_ytd,
SUM(t_tankstelle_ytd) as prev_t_tankstelle_ytd,
SUM(t_coworking_space_ytd) as prev_t_coworking_space_ytd,
SUM(t_universitaet_ytd) as prev_t_universitaet_ytd,
SUM(t_poilzei_ytd) as prev_t_poilzei_ytd,
SUM(t_feuerwehr_ytd) as prev_t_feuerwehr_ytd,
SUM(t_kita_ytd) as prev_t_kita_ytd,
SUM(t_hoehere_schule_ytd) as prev_t_hoehere_schule_ytd,
SUM(t_wochenmarkt_ytd) as prev_t_wochenmarkt_ytd,
SUM(t_kino_ytd) as prev_t_kino_ytd,
SUM(t_biergarten_ytd) as prev_t_biergarten_ytd,
SUM(t_autovermietung_ytd) as prev_t_autovermietung_ytd,
SUM(t_buecherei_ytd) as prev_t_buecherei_ytd,
SUM(t_nachbarschaftszentrum_ytd) as prev_t_nachbarschaftszentrum_ytd,
SUM(t_theater_ytd) as prev_t_theater_ytd,
SUM(t_eisdiele_ytd) as prev_t_eisdiele_ytd,
SUM(t_nachtclub_ytd) as prev_t_nachtclub_ytd,
SUM(t_kirche_ytd) as prev_t_kirche_ytd,
SUM(t_moschee_ytd) as prev_t_moschee_ytd,
SUM(t_sonstige_tempel_ytd) as prev_t_sonstige_tempel_ytd,
SUM(t_schule_ytd) as prev_t_schule_ytd,
SUM(t_bordell_ytd) as prev_t_bordell_ytd,
SUM(t_post_filiale_ytd) as prev_t_post_filiale_ytd,
SUM(t_sozialeinrichtung_ytd) as prev_t_sozialeinrichtung_ytd,
SUM(t_ladestation_ytd) as prev_t_ladestation_ytd,
SUM(t_zahnarzt_ytd) as prev_t_zahnarzt_ytd,
SUM(t_fahrradverleih_ytd) as prev_t_fahrradverleih_ytd,
SUM(t_fahrschule_ytd) as prev_t_fahrschule_ytd,
SUM(t_tierarzt_ytd) as prev_t_tierarzt_ytd,
SUM(t_botschaft_ytd) as prev_t_botschaft_ytd,
SUM(t_taxistand_ytd) as prev_t_taxistand_ytd,
SUM(t_wc_ytd) as prev_t_wc_ytd,
SUM(t_bankfiliale_ytd) as prev_t_bankfiliale_ytd,
SUM(t_arzt_ytd) as prev_t_arzt_ytd,
SUM(t_parkplatz_ytd) as prev_t_parkplatz_ytd,
SUM(t_bar_ytd) as prev_t_bar_ytd,
SUM(t_apotheke_ytd) as prev_t_apotheke_ytd,
SUM(t_pub_ytd) as prev_t_pub_ytd,
SUM(t_telefon_ytd) as prev_t_telefon_ytd,
SUM(t_kaffee_ytd) as prev_t_kaffee_ytd,
SUM(t_sonstige_cafes_ytd) as prev_t_sonstige_cafes_ytd,
SUM(t_fahrrad_parkplatz_ytd) as prev_t_fahrrad_parkplatz_ytd,
SUM(t_muelleimer_ytd) as prev_t_muelleimer_ytd,
SUM(t_parkbank_ytd) as prev_t_parkbank_ytd,
SUM(t_krankenhaus_ytd) as prev_t_krankenhaus_ytd,
SUM(t_klinik_ytd) as prev_t_klinik_ytd,
SUM(t_geldautomat_ytd) as prev_t_geldautomat_ytd,
SUM(t_briefkasten_ytd) as prev_t_briefkasten_ytd,
SUM(t_friedhof_ytd) as prev_t_friedhof_ytd,
SUM(t_musikschule_ytd) as prev_t_musikschule_ytd,
SUM(t_paketautomat_ytd) as prev_t_paketautomat_ytd,
SUM(t_sonstige_automaten_ytd) as prev_t_sonstige_automaten_ytd,
SUM(t_fahrscheinautomat_ytd) as prev_t_fahrscheinautomat_ytd,
SUM(t_parkticketautomat_ytd) as prev_t_parkticketautomat_ytd,
SUM(t_kotbeutelautomat_ytd) as prev_t_kotbeutelautomat_ytd,
SUM(t_zigarettenautomat_ytd) as prev_t_zigarettenautomat_ytd,
SUM(t_suessigkeitenautomat_ytd) as prev_t_suessigkeitenautomat_ytd,
SUM(t_briefmarkenautomat_ytd) as prev_t_briefmarkenautomat_ytd,
SUM(t_kondomautomat_ytd) as prev_t_kondomautomat_ytd,
SUM(t_getraenke_und_suessigkeitenautomat_ytd) as prev_t_getraenke_und_suessigkeitenautomat_ytd,
SUM(t_getraenkeautomat_ytd) as prev_t_getraenkeautomat_ytd,
SUM(t_grillplatz_ytd) as prev_t_grillplatz_ytd,
SUM(t_glascontainer_ytd) as prev_t_glascontainer_ytd,
SUM(t_glas__und_kleidungscontainer_ytd) as prev_t_glas__und_kleidungscontainer_ytd,
SUM(t_kleidungscontainer_ytd) as prev_t_kleidungscontainer_ytd,
SUM(t_sonstige_container_ytd) as prev_t_sonstige_container_ytd,
SUM(t_restaurant_italiener_ytd) as prev_t_restaurant_italiener_ytd,
SUM(t_restaurant_deutsch_ytd) as prev_t_restaurant_deutsch_ytd,
SUM(t_restaurant_indisch_ytd) as prev_t_restaurant_indisch_ytd,
SUM(t_restaurant_asiatisch_ytd) as prev_t_restaurant_asiatisch_ytd,
SUM(t_restaurant_sushi_ytd) as prev_t_restaurant_sushi_ytd,
SUM(t_restaurant_griechisch_ytd) as prev_t_restaurant_griechisch_ytd,
SUM(t_restaurant_steakhouse_ytd) as prev_t_restaurant_steakhouse_ytd,
SUM(t_restaurant_international_ytd) as prev_t_restaurant_international_ytd,
SUM(t_restaurant_tuerkisch_ytd) as prev_t_restaurant_tuerkisch_ytd,
SUM(t_fastfood_kebap_ytd) as prev_t_fastfood_kebap_ytd,
SUM(t_fastfood_burger_ytd) as prev_t_fastfood_burger_ytd,
SUM(t_fastfood_asiatisch_ytd) as prev_t_fastfood_asiatisch_ytd,
SUM(t_fastfood_pizza_ytd) as prev_t_fastfood_pizza_ytd,
SUM(t_fastfood_pommesbude_ytd) as prev_t_fastfood_pommesbude_ytd,
SUM(t_fast_food_sonstiges_ytd) as prev_t_fast_food_sonstiges_ytd,
SUM(t_restaurant_sonstiges_ytd) as prev_t_restaurant_sonstiges_ytd,
SUM(t_friseur_ytd) as prev_t_friseur_ytd,
SUM(t_baeckerei_ytd) as prev_t_baeckerei_ytd,
SUM(t_kleidung_ytd) as prev_t_kleidung_ytd,
SUM(t_supermarkt_ytd) as prev_t_supermarkt_ytd,
SUM(t_kiosk_ytd) as prev_t_kiosk_ytd,
SUM(t_florist_ytd) as prev_t_florist_ytd,
SUM(t_fahrrad_ytd) as prev_t_fahrrad_ytd,
SUM(t_kosmetik_und_beauty_ytd) as prev_t_kosmetik_und_beauty_ytd,
SUM(t_optiker_ytd) as prev_t_optiker_ytd,
SUM(t_schuhe_ytd) as prev_t_schuhe_ytd,
SUM(t_buecher_ytd) as prev_t_buecher_ytd,
SUM(t_massage_ytd) as prev_t_massage_ytd,
SUM(t_schmuck_ytd) as prev_t_schmuck_ytd,
SUM(t_autoreperatur_ytd) as prev_t_autoreperatur_ytd,
SUM(t_drogerie_ytd) as prev_t_drogerie_ytd,
SUM(t_reisen_ytd) as prev_t_reisen_ytd,
SUM(t_mobilfunk_ytd) as prev_t_mobilfunk_ytd,
SUM(t_moebel_ytd) as prev_t_moebel_ytd,
SUM(t_getraenke_ytd) as prev_t_getraenke_ytd,
SUM(t_feinkost_ytd) as prev_t_feinkost_ytd,
SUM(t_elektronik_ytd) as prev_t_elektronik_ytd,
SUM(t_boutique_ytd) as prev_t_boutique_ytd,
SUM(t_autohaus_ytd) as prev_t_autohaus_ytd,
SUM(t_spirituosen_ytd) as prev_t_spirituosen_ytd,
SUM(t_geschenke_ytd) as prev_t_geschenke_ytd,
SUM(t_postenmarkt_ytd) as prev_t_postenmarkt_ytd,
SUM(t_schlachter_ytd) as prev_t_schlachter_ytd,
SUM(t_waescherei_ytd) as prev_t_waescherei_ytd,
SUM(t_computer_ytd) as prev_t_computer_ytd,
SUM(t_spielzeug_ytd) as prev_t_spielzeug_ytd,
SUM(t_copyshop_ytd) as prev_t_copyshop_ytd,
SUM(t_schneider_ytd) as prev_t_schneider_ytd,
SUM(t_foto_ytd) as prev_t_foto_ytd,
SUM(t_kunst_ytd) as prev_t_kunst_ytd,
SUM(t_suessigkeiten_ytd) as prev_t_suessigkeiten_ytd,
SUM(t_dekoration_ytd) as prev_t_dekoration_ytd,
SUM(t_reinigung_ytd) as prev_t_reinigung_ytd,
SUM(t_beerdigung_ytd) as prev_t_beerdigung_ytd,
SUM(t_sport_ytd) as prev_t_sport_ytd,
SUM(t_zoofachgeschaeft_ytd) as prev_t_zoofachgeschaeft_ytd,
SUM(t_textilgeschaeft_ytd) as prev_t_textilgeschaeft_ytd,
SUM(t_hoergeraete_ytd) as prev_t_hoergeraete_ytd,
SUM(t_baumarkt_ytd) as prev_t_baumarkt_ytd,
SUM(t_leerstand_ytd) as prev_t_leerstand_ytd,
SUM(t_medical_ytd) as prev_t_medical_ytd,
SUM(t_second_hand_ytd) as prev_t_second_hand_ytd,
SUM(t_zeitung_ytd) as prev_t_zeitung_ytd,
SUM(t_eisenwarenhandlung_ytd) as prev_t_eisenwarenhandlung_ytd,
SUM(t_sonstiger_shop_ytd) as prev_t_sonstiger_shop_ytd,
SUM(t_baudenkmal_ytd) as prev_t_baudenkmal_ytd,
SUM(t_haltestelle_ytd) as prev_t_haltestelle_ytd,
SUM(t_sonstiges_gebaeude_ytd) as prev_t_sonstiges_gebaeude_ytd,
SUM(t_sonstiges_gelaende_ytd) as prev_t_sonstiges_gelaende_ytd,
SUM(t_sonstiges_denkmal_ytd) as prev_t_sonstiges_denkmal_ytd,
SUM(t_sonstiges_tourismus_ytd) as prev_t_sonstiges_tourismus_ytd,
SUM(t_sonstiges_sport_ytd) as prev_t_sonstiges_sport_ytd,
SUM(t_sonstiges_erholung_ytd) as prev_t_sonstiges_erholung_ytd,

SUM(t_hostel_new) as prev_t_hostel_new,
SUM(t_hotel_new) as prev_t_hotel_new,
SUM(t_sonstige_new) as prev_t_sonstige_new,
SUM(t_kunstwerk_new) as prev_t_kunstwerk_new,
SUM(t_kunstzentrum_new) as prev_t_kunstzentrum_new,
SUM(t_gallerie_new) as prev_t_gallerie_new,
SUM(t_info_new) as prev_t_info_new,
SUM(t_museum_new) as prev_t_museum_new,
SUM(t_aussichtspunkt_new) as prev_t_aussichtspunkt_new,
SUM(t_zoo_new) as prev_t_zoo_new,
SUM(t_schwimmen_new) as prev_t_schwimmen_new,
SUM(t_basketball_new) as prev_t_basketball_new,
SUM(t_fussball_new) as prev_t_fussball_new,
SUM(t_sportzentrum_new) as prev_t_sportzentrum_new,
SUM(t_tischtennis_new) as prev_t_tischtennis_new,
SUM(t_sauna_new) as prev_t_sauna_new,
SUM(t_tennis_new) as prev_t_tennis_new,
SUM(t_kampfsport_new) as prev_t_kampfsport_new,
SUM(t_fitnesszentrum_new) as prev_t_fitnesszentrum_new,
SUM(t_spielplatz_new) as prev_t_spielplatz_new,
SUM(t_wassersport_new) as prev_t_wassersport_new,
SUM(t_spielothek_new) as prev_t_spielothek_new,
SUM(t_sonstige_sportarten_new) as prev_t_sonstige_sportarten_new,
SUM(t_kindergarten_new) as prev_t_kindergarten_new,
SUM(t_buero_new) as prev_t_buero_new,
SUM(t_tankstelle_new) as prev_t_tankstelle_new,
SUM(t_coworking_space_new) as prev_t_coworking_space_new,
SUM(t_universitaet_new) as prev_t_universitaet_new,
SUM(t_poilzei_new) as prev_t_poilzei_new,
SUM(t_feuerwehr_new) as prev_t_feuerwehr_new,
SUM(t_kita_new) as prev_t_kita_new,
SUM(t_hoehere_schule_new) as prev_t_hoehere_schule_new,
SUM(t_wochenmarkt_new) as prev_t_wochenmarkt_new,
SUM(t_kino_new) as prev_t_kino_new,
SUM(t_biergarten_new) as prev_t_biergarten_new,
SUM(t_autovermietung_new) as prev_t_autovermietung_new,
SUM(t_buecherei_new) as prev_t_buecherei_new,
SUM(t_nachbarschaftszentrum_new) as prev_t_nachbarschaftszentrum_new,
SUM(t_theater_new) as prev_t_theater_new,
SUM(t_eisdiele_new) as prev_t_eisdiele_new,
SUM(t_nachtclub_new) as prev_t_nachtclub_new,
SUM(t_kirche_new) as prev_t_kirche_new,
SUM(t_moschee_new) as prev_t_moschee_new,
SUM(t_sonstige_tempel_new) as prev_t_sonstige_tempel_new,
SUM(t_schule_new) as prev_t_schule_new,
SUM(t_bordell_new) as prev_t_bordell_new,
SUM(t_post_filiale_new) as prev_t_post_filiale_new,
SUM(t_sozialeinrichtung_new) as prev_t_sozialeinrichtung_new,
SUM(t_ladestation_new) as prev_t_ladestation_new,
SUM(t_zahnarzt_new) as prev_t_zahnarzt_new,
SUM(t_fahrradverleih_new) as prev_t_fahrradverleih_new,
SUM(t_fahrschule_new) as prev_t_fahrschule_new,
SUM(t_tierarzt_new) as prev_t_tierarzt_new,
SUM(t_botschaft_new) as prev_t_botschaft_new,
SUM(t_taxistand_new) as prev_t_taxistand_new,
SUM(t_wc_new) as prev_t_wc_new,
SUM(t_bankfiliale_new) as prev_t_bankfiliale_new,
SUM(t_arzt_new) as prev_t_arzt_new,
SUM(t_parkplatz_new) as prev_t_parkplatz_new,
SUM(t_bar_new) as prev_t_bar_new,
SUM(t_apotheke_new) as prev_t_apotheke_new,
SUM(t_pub_new) as prev_t_pub_new,
SUM(t_telefon_new) as prev_t_telefon_new,
SUM(t_kaffee_new) as prev_t_kaffee_new,
SUM(t_sonstige_cafes_new) as prev_t_sonstige_cafes_new,
SUM(t_fahrrad_parkplatz_new) as prev_t_fahrrad_parkplatz_new,
SUM(t_muelleimer_new) as prev_t_muelleimer_new,
SUM(t_parkbank_new) as prev_t_parkbank_new,
SUM(t_krankenhaus_new) as prev_t_krankenhaus_new,
SUM(t_klinik_new) as prev_t_klinik_new,
SUM(t_geldautomat_new) as prev_t_geldautomat_new,
SUM(t_briefkasten_new) as prev_t_briefkasten_new,
SUM(t_friedhof_new) as prev_t_friedhof_new,
SUM(t_musikschule_new) as prev_t_musikschule_new,
SUM(t_paketautomat_new) as prev_t_paketautomat_new,
SUM(t_sonstige_automaten_new) as prev_t_sonstige_automaten_new,
SUM(t_fahrscheinautomat_new) as prev_t_fahrscheinautomat_new,
SUM(t_parkticketautomat_new) as prev_t_parkticketautomat_new,
SUM(t_kotbeutelautomat_new) as prev_t_kotbeutelautomat_new,
SUM(t_zigarettenautomat_new) as prev_t_zigarettenautomat_new,
SUM(t_suessigkeitenautomat_new) as prev_t_suessigkeitenautomat_new,
SUM(t_briefmarkenautomat_new) as prev_t_briefmarkenautomat_new,
SUM(t_kondomautomat_new) as prev_t_kondomautomat_new,
SUM(t_getraenke_und_suessigkeitenautomat_new) as prev_t_getraenke_und_suessigkeitenautomat_new,
SUM(t_getraenkeautomat_new) as prev_t_getraenkeautomat_new,
SUM(t_grillplatz_new) as prev_t_grillplatz_new,
SUM(t_glascontainer_new) as prev_t_glascontainer_new,
SUM(t_glas__und_kleidungscontainer_new) as prev_t_glas__und_kleidungscontainer_new,
SUM(t_kleidungscontainer_new) as prev_t_kleidungscontainer_new,
SUM(t_sonstige_container_new) as prev_t_sonstige_container_new,
SUM(t_restaurant_italiener_new) as prev_t_restaurant_italiener_new,
SUM(t_restaurant_deutsch_new) as prev_t_restaurant_deutsch_new,
SUM(t_restaurant_indisch_new) as prev_t_restaurant_indisch_new,
SUM(t_restaurant_asiatisch_new) as prev_t_restaurant_asiatisch_new,
SUM(t_restaurant_sushi_new) as prev_t_restaurant_sushi_new,
SUM(t_restaurant_griechisch_new) as prev_t_restaurant_griechisch_new,
SUM(t_restaurant_steakhouse_new) as prev_t_restaurant_steakhouse_new,
SUM(t_restaurant_international_new) as prev_t_restaurant_international_new,
SUM(t_restaurant_tuerkisch_new) as prev_t_restaurant_tuerkisch_new,
SUM(t_fastfood_kebap_new) as prev_t_fastfood_kebap_new,
SUM(t_fastfood_burger_new) as prev_t_fastfood_burger_new,
SUM(t_fastfood_asiatisch_new) as prev_t_fastfood_asiatisch_new,
SUM(t_fastfood_pizza_new) as prev_t_fastfood_pizza_new,
SUM(t_fastfood_pommesbude_new) as prev_t_fastfood_pommesbude_new,
SUM(t_fast_food_sonstiges_new) as prev_t_fast_food_sonstiges_new,
SUM(t_restaurant_sonstiges_new) as prev_t_restaurant_sonstiges_new,
SUM(t_friseur_new) as prev_t_friseur_new,
SUM(t_baeckerei_new) as prev_t_baeckerei_new,
SUM(t_kleidung_new) as prev_t_kleidung_new,
SUM(t_supermarkt_new) as prev_t_supermarkt_new,
SUM(t_kiosk_new) as prev_t_kiosk_new,
SUM(t_florist_new) as prev_t_florist_new,
SUM(t_fahrrad_new) as prev_t_fahrrad_new,
SUM(t_kosmetik_und_beauty_new) as prev_t_kosmetik_und_beauty_new,
SUM(t_optiker_new) as prev_t_optiker_new,
SUM(t_schuhe_new) as prev_t_schuhe_new,
SUM(t_buecher_new) as prev_t_buecher_new,
SUM(t_massage_new) as prev_t_massage_new,
SUM(t_schmuck_new) as prev_t_schmuck_new,
SUM(t_autoreperatur_new) as prev_t_autoreperatur_new,
SUM(t_drogerie_new) as prev_t_drogerie_new,
SUM(t_reisen_new) as prev_t_reisen_new,
SUM(t_mobilfunk_new) as prev_t_mobilfunk_new,
SUM(t_moebel_new) as prev_t_moebel_new,
SUM(t_getraenke_new) as prev_t_getraenke_new,
SUM(t_feinkost_new) as prev_t_feinkost_new,
SUM(t_elektronik_new) as prev_t_elektronik_new,
SUM(t_boutique_new) as prev_t_boutique_new,
SUM(t_autohaus_new) as prev_t_autohaus_new,
SUM(t_spirituosen_new) as prev_t_spirituosen_new,
SUM(t_geschenke_new) as prev_t_geschenke_new,
SUM(t_postenmarkt_new) as prev_t_postenmarkt_new,
SUM(t_schlachter_new) as prev_t_schlachter_new,
SUM(t_waescherei_new) as prev_t_waescherei_new,
SUM(t_computer_new) as prev_t_computer_new,
SUM(t_spielzeug_new) as prev_t_spielzeug_new,
SUM(t_copyshop_new) as prev_t_copyshop_new,
SUM(t_schneider_new) as prev_t_schneider_new,
SUM(t_foto_new) as prev_t_foto_new,
SUM(t_kunst_new) as prev_t_kunst_new,
SUM(t_suessigkeiten_new) as prev_t_suessigkeiten_new,
SUM(t_dekoration_new) as prev_t_dekoration_new,
SUM(t_reinigung_new) as prev_t_reinigung_new,
SUM(t_beerdigung_new) as prev_t_beerdigung_new,
SUM(t_sport_new) as prev_t_sport_new,
SUM(t_zoofachgeschaeft_new) as prev_t_zoofachgeschaeft_new,
SUM(t_textilgeschaeft_new) as prev_t_textilgeschaeft_new,
SUM(t_hoergeraete_new) as prev_t_hoergeraete_new,
SUM(t_baumarkt_new) as prev_t_baumarkt_new,
SUM(t_leerstand_new) as prev_t_leerstand_new,
SUM(t_medical_new) as prev_t_medical_new,
SUM(t_second_hand_new) as prev_t_second_hand_new,
SUM(t_zeitung_new) as prev_t_zeitung_new,
SUM(t_eisenwarenhandlung_new) as prev_t_eisenwarenhandlung_new,
SUM(t_sonstiger_shop_new) as prev_t_sonstiger_shop_new,
SUM(t_baudenkmal_new) as prev_t_baudenkmal_new,
SUM(t_haltestelle_new) as prev_t_haltestelle_new,
SUM(t_sonstiges_gebaeude_new) as prev_t_sonstiges_gebaeude_new,
SUM(t_sonstiges_gelaende_new) as prev_t_sonstiges_gelaende_new,
SUM(t_sonstiges_denkmal_new) as prev_t_sonstiges_denkmal_new,
SUM(t_sonstiges_tourismus_new) as prev_t_sonstiges_tourismus_new,
SUM(t_sonstiges_sport_new) as prev_t_sonstiges_sport_new,
SUM(t_sonstiges_erholung_new) as prev_t_sonstiges_erholung_new

  
  from osm_poi_features_type_piv_distcalc
  where timeslice in (201401, 201501)
  group by planungsraum
) dyn_t_prev
on ewr.zeit = dyn_t_prev.timeslice
and cast(ewr.planungsraum as int) = cast(dyn_t_prev.planungsraum as int)

left join 
(select 
  planungsraum,
  201612 as timeslice,

c_uebernachtung_stock               as prev_c_uebernachtung_stock               ,
c_sehenswuerdigkeit_stock           as prev_c_sehenswuerdigkeit_stock           ,
c_kultur_stock                      as prev_c_kultur_stock                      ,
c_info_stock                        as prev_c_info_stock                        ,
c_sport_stock                       as prev_c_sport_stock                       ,
c_erholung_stock                    as prev_c_erholung_stock                    ,
c_zwielicht_stock                   as prev_c_zwielicht_stock                   ,
c_bildung_stock                     as prev_c_bildung_stock                     ,
c_buero_stock                       as prev_c_buero_stock                       ,
c_individual_stock                  as prev_c_individual_stock                  ,
c_hipster_stock                     as prev_c_hipster_stock                     ,
c_sicherheit_stock                  as prev_c_sicherheit_stock                  ,
c_sonstiges_stock                   as prev_c_sonstiges_stock                   ,
c_ausgehen_stock                    as prev_c_ausgehen_stock                    ,
c_gaststaetten_stock                as prev_c_gaststaetten_stock                ,
c_sozial_stock                      as prev_c_sozial_stock                      ,
c_cafe_stock                        as prev_c_cafe_stock                        ,
c_religioese_gebaeude_stock         as prev_c_religioese_gebaeude_stock         ,
c_post_stock                        as prev_c_post_stock                        ,
c_gesundheit_stock                  as prev_c_gesundheit_stock                  ,
c_wc_stock                          as prev_c_wc_stock                          ,
c_bank_stock                        as prev_c_bank_stock                        ,
c_telefon_stock                     as prev_c_telefon_stock                     ,
c_recycling_stock                   as prev_c_recycling_stock                   ,
c_parkbank_stock                    as prev_c_parkbank_stock                    ,
c_briefe_und_pakete_stock           as prev_c_briefe_und_pakete_stock           ,
c_friedhof_stock                    as prev_c_friedhof_stock                    ,
c_automaten_stock                   as prev_c_automaten_stock                   ,
c_oepnv_stock                       as prev_c_oepnv_stock                       ,
c_restaurant_stock                  as prev_c_restaurant_stock                  ,
c_fast_food_stock                   as prev_c_fast_food_stock                   ,
c_friseur_stock                     as prev_c_friseur_stock                     ,
c_essen_und_trinken_stock           as prev_c_essen_und_trinken_stock           ,
c_kleidung_stock                    as prev_c_kleidung_stock                    ,
c_sonstige_waren_stock              as prev_c_sonstige_waren_stock              ,
c_werkstatt_stock                   as prev_c_werkstatt_stock                   ,
c_kosmetik_und_beauty_stock         as prev_c_kosmetik_und_beauty_stock         ,
c_medical_stock                     as prev_c_medical_stock                     ,
c_print_stock                       as prev_c_print_stock                       ,
c_massage_stock                     as prev_c_massage_stock                     ,
c_drogerie_stock                    as prev_c_drogerie_stock                    ,
c_reisen_stock                      as prev_c_reisen_stock                      ,
c_technik_stock                     as prev_c_technik_stock                     ,
c_spielzeug_und_geschenke_stock     as prev_c_spielzeug_und_geschenke_stock     ,
c_waescherei_stock                  as prev_c_waescherei_stock                  ,
c_kunst_stock                       as prev_c_kunst_stock                       ,
c_beerdigung_stock                  as prev_c_beerdigung_stock                  ,
c_handwerk_stock                    as prev_c_handwerk_stock                    ,
c_leerstand_stock                   as prev_c_leerstand_stock                   ,
c_sonstiger_shop_stock              as prev_c_sonstiger_shop_stock              ,
c_sonstiges_gebaeude_stock          as prev_c_sonstiges_gebaeude_stock          ,
c_sonstiges_gelaende_stock          as prev_c_sonstiges_gelaende_stock          ,
c_sonstiges_tourismus_stock         as prev_c_sonstiges_tourismus_stock         
  
  from osm_poi_features_category_piv_distcalc
  where timeslice in (201501) 
) stock_c_prev
on ewr.zeit = stock_c_prev.timeslice
and cast(ewr.planungsraum as int) = cast(stock_c_prev.planungsraum as int)

left join 
(select 
  planungsraum,
  201612 as timeslice,

c_uebernachtung_stock,
c_sehenswuerdigkeit_stock,
c_kultur_stock,
c_info_stock,
c_sport_stock,
c_erholung_stock,
c_zwielicht_stock,
c_bildung_stock,
c_buero_stock,
c_individual_stock,
c_hipster_stock,
c_sicherheit_stock,
c_sonstiges_stock,
c_ausgehen_stock,
c_gaststaetten_stock,
c_sozial_stock,
c_cafe_stock,
c_religioese_gebaeude_stock,
c_post_stock,
c_gesundheit_stock,
c_wc_stock,
c_bank_stock,
c_telefon_stock,
c_recycling_stock,
c_parkbank_stock,
c_briefe_und_pakete_stock,
c_friedhof_stock,
c_automaten_stock,
c_oepnv_stock,
c_restaurant_stock,
c_fast_food_stock,
c_friseur_stock,
c_essen_und_trinken_stock,
c_kleidung_stock,
c_sonstige_waren_stock,
c_werkstatt_stock,
c_kosmetik_und_beauty_stock,
c_medical_stock,
c_print_stock,
c_massage_stock,
c_drogerie_stock,
c_reisen_stock,
c_technik_stock,
c_spielzeug_und_geschenke_stock,
c_waescherei_stock,
c_kunst_stock,
c_beerdigung_stock,
c_handwerk_stock,
c_leerstand_stock,
c_sonstiger_shop_stock,
c_sonstiges_gebaeude_stock,
c_sonstiges_gelaende_stock,
c_sonstiges_tourismus_stock
  
  from osm_poi_features_category_piv_distcalc
  where timeslice in (201701) 
) stock_c
on ewr.zeit = stock_c.timeslice
and cast(ewr.planungsraum as int) = cast(stock_c.planungsraum as int)
left join
(select
  planungsraum,
  201612 as timeslice,

SUM(c_uebernachtung_ytd) as c_uebernachtung_ytd,
SUM(c_sehenswuerdigkeit_ytd) as c_sehenswuerdigkeit_ytd,
SUM(c_kultur_ytd) as c_kultur_ytd,
SUM(c_info_ytd) as c_info_ytd,
SUM(c_sport_ytd) as c_sport_ytd,
SUM(c_erholung_ytd) as c_erholung_ytd,
SUM(c_zwielicht_ytd) as c_zwielicht_ytd,
SUM(c_bildung_ytd) as c_bildung_ytd,
SUM(c_buero_ytd) as c_buero_ytd,
SUM(c_individual_ytd) as c_individual_ytd,
SUM(c_hipster_ytd) as c_hipster_ytd,
SUM(c_sicherheit_ytd) as c_sicherheit_ytd,
SUM(c_sonstiges_ytd) as c_sonstiges_ytd,
SUM(c_ausgehen_ytd) as c_ausgehen_ytd,
SUM(c_gaststaetten_ytd) as c_gaststaetten_ytd,
SUM(c_sozial_ytd) as c_sozial_ytd,
SUM(c_cafe_ytd) as c_cafe_ytd,
SUM(c_religioese_gebaeude_ytd) as c_religioese_gebaeude_ytd,
SUM(c_post_ytd) as c_post_ytd,
SUM(c_gesundheit_ytd) as c_gesundheit_ytd,
SUM(c_wc_ytd) as c_wc_ytd,
SUM(c_bank_ytd) as c_bank_ytd,
SUM(c_telefon_ytd) as c_telefon_ytd,
SUM(c_recycling_ytd) as c_recycling_ytd,
SUM(c_parkbank_ytd) as c_parkbank_ytd,
SUM(c_briefe_und_pakete_ytd) as c_briefe_und_pakete_ytd,
SUM(c_friedhof_ytd) as c_friedhof_ytd,
SUM(c_automaten_ytd) as c_automaten_ytd,
SUM(c_oepnv_ytd) as c_oepnv_ytd,
SUM(c_restaurant_ytd) as c_restaurant_ytd,
SUM(c_fast_food_ytd) as c_fast_food_ytd,
SUM(c_friseur_ytd) as c_friseur_ytd,
SUM(c_essen_und_trinken_ytd) as c_essen_und_trinken_ytd,
SUM(c_kleidung_ytd) as c_kleidung_ytd,
SUM(c_sonstige_waren_ytd) as c_sonstige_waren_ytd,
SUM(c_werkstatt_ytd) as c_werkstatt_ytd,
SUM(c_kosmetik_und_beauty_ytd) as c_kosmetik_und_beauty_ytd,
SUM(c_medical_ytd) as c_medical_ytd,
SUM(c_print_ytd) as c_print_ytd,
SUM(c_massage_ytd) as c_massage_ytd,
SUM(c_drogerie_ytd) as c_drogerie_ytd,
SUM(c_reisen_ytd) as c_reisen_ytd,
SUM(c_technik_ytd) as c_technik_ytd,
SUM(c_spielzeug_und_geschenke_ytd) as c_spielzeug_und_geschenke_ytd,
SUM(c_waescherei_ytd) as c_waescherei_ytd,
SUM(c_kunst_ytd) as c_kunst_ytd,
SUM(c_beerdigung_ytd) as c_beerdigung_ytd,
SUM(c_handwerk_ytd) as c_handwerk_ytd,
SUM(c_leerstand_ytd) as c_leerstand_ytd,
SUM(c_sonstiger_shop_ytd) as c_sonstiger_shop_ytd,
SUM(c_sonstiges_gebaeude_ytd) as c_sonstiges_gebaeude_ytd,
SUM(c_sonstiges_gelaende_ytd) as c_sonstiges_gelaende_ytd,
SUM(c_sonstiges_tourismus_ytd) as c_sonstiges_tourismus_ytd,

SUM(c_uebernachtung_new) as c_uebernachtung_new,
SUM(c_sehenswuerdigkeit_new) as c_sehenswuerdigkeit_new,
SUM(c_kultur_new) as c_kultur_new,
SUM(c_info_new) as c_info_new,
SUM(c_sport_new) as c_sport_new,
SUM(c_erholung_new) as c_erholung_new,
SUM(c_zwielicht_new) as c_zwielicht_new,
SUM(c_bildung_new) as c_bildung_new,
SUM(c_buero_new) as c_buero_new,
SUM(c_individual_new) as c_individual_new,
SUM(c_hipster_new) as c_hipster_new,
SUM(c_sicherheit_new) as c_sicherheit_new,
SUM(c_sonstiges_new) as c_sonstiges_new,
SUM(c_ausgehen_new) as c_ausgehen_new,
SUM(c_gaststaetten_new) as c_gaststaetten_new,
SUM(c_sozial_new) as c_sozial_new,
SUM(c_cafe_new) as c_cafe_new,
SUM(c_religioese_gebaeude_new) as c_religioese_gebaeude_new,
SUM(c_post_new) as c_post_new,
SUM(c_gesundheit_new) as c_gesundheit_new,
SUM(c_wc_new) as c_wc_new,
SUM(c_bank_new) as c_bank_new,
SUM(c_telefon_new) as c_telefon_new,
SUM(c_recycling_new) as c_recycling_new,
SUM(c_parkbank_new) as c_parkbank_new,
SUM(c_briefe_und_pakete_new) as c_briefe_und_pakete_new,
SUM(c_friedhof_new) as c_friedhof_new,
SUM(c_automaten_new) as c_automaten_new,
SUM(c_oepnv_new) as c_oepnv_new,
SUM(c_restaurant_new) as c_restaurant_new,
SUM(c_fast_food_new) as c_fast_food_new,
SUM(c_friseur_new) as c_friseur_new,
SUM(c_essen_und_trinken_new) as c_essen_und_trinken_new,
SUM(c_kleidung_new) as c_kleidung_new,
SUM(c_sonstige_waren_new) as c_sonstige_waren_new,
SUM(c_werkstatt_new) as c_werkstatt_new,
SUM(c_kosmetik_und_beauty_new) as c_kosmetik_und_beauty_new,
SUM(c_medical_new) as c_medical_new,
SUM(c_print_new) as c_print_new,
SUM(c_massage_new) as c_massage_new,
SUM(c_drogerie_new) as c_drogerie_new,
SUM(c_reisen_new) as c_reisen_new,
SUM(c_technik_new) as c_technik_new,
SUM(c_spielzeug_und_geschenke_new) as c_spielzeug_und_geschenke_new,
SUM(c_waescherei_new) as c_waescherei_new,
SUM(c_kunst_new) as c_kunst_new,
SUM(c_beerdigung_new) as c_beerdigung_new,
SUM(c_handwerk_new) as c_handwerk_new,
SUM(c_leerstand_new) as c_leerstand_new,
SUM(c_sonstiger_shop_new) as c_sonstiger_shop_new,
SUM(c_sonstiges_gebaeude_new) as c_sonstiges_gebaeude_new,
SUM(c_sonstiges_gelaende_new) as c_sonstiges_gelaende_new,
SUM(c_sonstiges_tourismus_new) as c_sonstiges_tourismus_new


  
  from osm_poi_features_category_piv_distcalc
  where timeslice in (201601, 201701)
  group by planungsraum
) dyn_c
on ewr.zeit = dyn_c.timeslice
and cast(ewr.planungsraum as int) = cast(dyn_c.planungsraum as int)

left join
(select
  planungsraum,
  201612 as timeslice,

SUM(c_uebernachtung_ytd) as prev_c_uebernachtung_ytd,
SUM(c_sehenswuerdigkeit_ytd) as prev_c_sehenswuerdigkeit_ytd,
SUM(c_kultur_ytd) as prev_c_kultur_ytd,
SUM(c_info_ytd) as prev_c_info_ytd,
SUM(c_sport_ytd) as prev_c_sport_ytd,
SUM(c_erholung_ytd) as prev_c_erholung_ytd,
SUM(c_zwielicht_ytd) as prev_c_zwielicht_ytd,
SUM(c_bildung_ytd) as prev_c_bildung_ytd,
SUM(c_buero_ytd) as prev_c_buero_ytd,
SUM(c_individual_ytd) as prev_c_individual_ytd,
SUM(c_hipster_ytd) as prev_c_hipster_ytd,
SUM(c_sicherheit_ytd) as prev_c_sicherheit_ytd,
SUM(c_sonstiges_ytd) as prev_c_sonstiges_ytd,
SUM(c_ausgehen_ytd) as prev_c_ausgehen_ytd,
SUM(c_gaststaetten_ytd) as prev_c_gaststaetten_ytd,
SUM(c_sozial_ytd) as prev_c_sozial_ytd,
SUM(c_cafe_ytd) as prev_c_cafe_ytd,
SUM(c_religioese_gebaeude_ytd) as prev_c_religioese_gebaeude_ytd,
SUM(c_post_ytd) as prev_c_post_ytd,
SUM(c_gesundheit_ytd) as prev_c_gesundheit_ytd,
SUM(c_wc_ytd) as prev_c_wc_ytd,
SUM(c_bank_ytd) as prev_c_bank_ytd,
SUM(c_telefon_ytd) as prev_c_telefon_ytd,
SUM(c_recycling_ytd) as prev_c_recycling_ytd,
SUM(c_parkbank_ytd) as prev_c_parkbank_ytd,
SUM(c_briefe_und_pakete_ytd) as prev_c_briefe_und_pakete_ytd,
SUM(c_friedhof_ytd) as prev_c_friedhof_ytd,
SUM(c_automaten_ytd) as prev_c_automaten_ytd,
SUM(c_oepnv_ytd) as prev_c_oepnv_ytd,
SUM(c_restaurant_ytd) as prev_c_restaurant_ytd,
SUM(c_fast_food_ytd) as prev_c_fast_food_ytd,
SUM(c_friseur_ytd) as prev_c_friseur_ytd,
SUM(c_essen_und_trinken_ytd) as prev_c_essen_und_trinken_ytd,
SUM(c_kleidung_ytd) as prev_c_kleidung_ytd,
SUM(c_sonstige_waren_ytd) as prev_c_sonstige_waren_ytd,
SUM(c_werkstatt_ytd) as prev_c_werkstatt_ytd,
SUM(c_kosmetik_und_beauty_ytd) as prev_c_kosmetik_und_beauty_ytd,
SUM(c_medical_ytd) as prev_c_medical_ytd,
SUM(c_print_ytd) as prev_c_print_ytd,
SUM(c_massage_ytd) as prev_c_massage_ytd,
SUM(c_drogerie_ytd) as prev_c_drogerie_ytd,
SUM(c_reisen_ytd) as prev_c_reisen_ytd,
SUM(c_technik_ytd) as prev_c_technik_ytd,
SUM(c_spielzeug_und_geschenke_ytd) as prev_c_spielzeug_und_geschenke_ytd,
SUM(c_waescherei_ytd) as prev_c_waescherei_ytd,
SUM(c_kunst_ytd) as prev_c_kunst_ytd,
SUM(c_beerdigung_ytd) as prev_c_beerdigung_ytd,
SUM(c_handwerk_ytd) as prev_c_handwerk_ytd,
SUM(c_leerstand_ytd) as prev_c_leerstand_ytd,
SUM(c_sonstiger_shop_ytd) as prev_c_sonstiger_shop_ytd,
SUM(c_sonstiges_gebaeude_ytd) as prev_c_sonstiges_gebaeude_ytd,
SUM(c_sonstiges_gelaende_ytd) as prev_c_sonstiges_gelaende_ytd,
SUM(c_sonstiges_tourismus_ytd) as prev_c_sonstiges_tourismus_ytd,

SUM(c_uebernachtung_new) as prev_c_uebernachtung_new,
SUM(c_sehenswuerdigkeit_new) as prev_c_sehenswuerdigkeit_new,
SUM(c_kultur_new) as prev_c_kultur_new,
SUM(c_info_new) as prev_c_info_new,
SUM(c_sport_new) as prev_c_sport_new,
SUM(c_erholung_new) as prev_c_erholung_new,
SUM(c_zwielicht_new) as prev_c_zwielicht_new,
SUM(c_bildung_new) as prev_c_bildung_new,
SUM(c_buero_new) as prev_c_buero_new,
SUM(c_individual_new) as prev_c_individual_new,
SUM(c_hipster_new) as prev_c_hipster_new,
SUM(c_sicherheit_new) as prev_c_sicherheit_new,
SUM(c_sonstiges_new) as prev_c_sonstiges_new,
SUM(c_ausgehen_new) as prev_c_ausgehen_new,
SUM(c_gaststaetten_new) as prev_c_gaststaetten_new,
SUM(c_sozial_new) as prev_c_sozial_new,
SUM(c_cafe_new) as prev_c_cafe_new,
SUM(c_religioese_gebaeude_new) as prev_c_religioese_gebaeude_new,
SUM(c_post_new) as prev_c_post_new,
SUM(c_gesundheit_new) as prev_c_gesundheit_new,
SUM(c_wc_new) as prev_c_wc_new,
SUM(c_bank_new) as prev_c_bank_new,
SUM(c_telefon_new) as prev_c_telefon_new,
SUM(c_recycling_new) as prev_c_recycling_new,
SUM(c_parkbank_new) as prev_c_parkbank_new,
SUM(c_briefe_und_pakete_new) as prev_c_briefe_und_pakete_new,
SUM(c_friedhof_new) as prev_c_friedhof_new,
SUM(c_automaten_new) as prev_c_automaten_new,
SUM(c_oepnv_new) as prev_c_oepnv_new,
SUM(c_restaurant_new) as prev_c_restaurant_new,
SUM(c_fast_food_new) as prev_c_fast_food_new,
SUM(c_friseur_new) as prev_c_friseur_new,
SUM(c_essen_und_trinken_new) as prev_c_essen_und_trinken_new,
SUM(c_kleidung_new) as prev_c_kleidung_new,
SUM(c_sonstige_waren_new) as prev_c_sonstige_waren_new,
SUM(c_werkstatt_new) as prev_c_werkstatt_new,
SUM(c_kosmetik_und_beauty_new) as prev_c_kosmetik_und_beauty_new,
SUM(c_medical_new) as prev_c_medical_new,
SUM(c_print_new) as prev_c_print_new,
SUM(c_massage_new) as prev_c_massage_new,
SUM(c_drogerie_new) as prev_c_drogerie_new,
SUM(c_reisen_new) as prev_c_reisen_new,
SUM(c_technik_new) as prev_c_technik_new,
SUM(c_spielzeug_und_geschenke_new) as prev_c_spielzeug_und_geschenke_new,
SUM(c_waescherei_new) as prev_c_waescherei_new,
SUM(c_kunst_new) as prev_c_kunst_new,
SUM(c_beerdigung_new) as prev_c_beerdigung_new,
SUM(c_handwerk_new) as prev_c_handwerk_new,
SUM(c_leerstand_new) as prev_c_leerstand_new,
SUM(c_sonstiger_shop_new) as prev_c_sonstiger_shop_new,
SUM(c_sonstiges_gebaeude_new) as prev_c_sonstiges_gebaeude_new,
SUM(c_sonstiges_gelaende_new) as prev_c_sonstiges_gelaende_new,
SUM(c_sonstiges_tourismus_new) as prev_c_sonstiges_tourismus_new


  
  from osm_poi_features_category_piv_distcalc
  where timeslice in (201401, 201501)
  group by planungsraum
) dyn_c_prev
on ewr.zeit = dyn_c_prev.timeslice
and cast(ewr.planungsraum as int) = cast(dyn_c_prev.planungsraum as int)

left join 
(select 
  planungsraum,
  201612 as timeslice,
  d_tourismus_stock                 as   prev_d_tourismus_stock            ,
  d_vergnuegung_stock               as   prev_d_vergnuegung_stock          ,
  d_sport_und_erholung_stock        as   prev_d_sport_und_erholung_stock   ,
  d_public_service_stock            as   prev_d_public_service_stock       ,
  d_buero_stock                     as   prev_d_buero_stock                ,
  d_mobilitaet_stock                as   prev_d_mobilitaet_stock           ,
  d_sonstiges_stock                 as   prev_d_sonstiges_stock            ,
  d_gastronomie_stock               as   prev_d_gastronomie_stock          ,
  d_religion_stock                  as   prev_d_religion_stock             ,
  d_oeffentlicher_raum_stock        as   prev_d_oeffentlicher_raum_stock   ,
  d_dienstleistung_stock            as   prev_d_dienstleistung_stock       ,
  d_waren_stock                     as   prev_d_waren_stock                ,
  d_leerstand_stock                 as   prev_d_leerstand_stock            
  from osm_poi_features_domain_piv_distcalc
  where timeslice in (201501) 
) stock_d_prev
on ewr.zeit = stock_d_prev.timeslice
and cast(ewr.planungsraum as int) = cast(stock_d_prev.planungsraum as int)
left join 
(select 
  planungsraum,
  201612 as timeslice,
  d_tourismus_stock,
  d_vergnuegung_stock,
  d_sport_und_erholung_stock,
  d_public_service_stock,
  d_buero_stock,
  d_mobilitaet_stock,
  d_sonstiges_stock,
  d_gastronomie_stock,
  d_religion_stock,
  d_oeffentlicher_raum_stock,
  d_dienstleistung_stock,
  d_waren_stock,
  d_leerstand_stock
  from osm_poi_features_domain_piv_distcalc
  where timeslice in (201701) 
) stock_d
on ewr.zeit = stock_d.timeslice
and cast(ewr.planungsraum as int) = cast(stock_d.planungsraum as int)
left join
(select
  planungsraum,
  201612 as timeslice,
  SUM(d_tourismus_ytd) as d_tourismus_ytd,
  SUM(d_vergnuegung_ytd) as d_vergnuegung_ytd,
  SUM(d_sport_und_erholung_ytd) as d_sport_und_erholung_ytd,
  SUM(d_public_service_ytd) as d_public_service_ytd,
  SUM(d_buero_ytd) as d_buero_ytd,
  SUM(d_mobilitaet_ytd) as d_mobilitaet_ytd,
  SUM(d_sonstiges_ytd) as d_sonstiges_ytd,
  SUM(d_gastronomie_ytd) as d_gastronomie_ytd,
  SUM(d_religion_ytd) as d_religion_ytd,
  SUM(d_oeffentlicher_raum_ytd) as d_oeffentlicher_raum_ytd,
  SUM(d_dienstleistung_ytd) as d_dienstleistung_ytd,
  SUM(d_waren_ytd) as d_waren_ytd,
  SUM(d_leerstand_ytd) as d_leerstand_ytd,
  SUM(d_tourismus_new) as d_tourismus_new,
SUM(d_vergnuegung_new) as d_vergnuegung_new,
SUM(d_sport_und_erholung_new) as d_sport_und_erholung_new,
SUM(d_public_service_new) as d_public_service_new,
SUM(d_buero_new) as d_buero_new,
SUM(d_mobilitaet_new) as d_mobilitaet_new,
SUM(d_sonstiges_new) as d_sonstiges_new,
SUM(d_gastronomie_new) as d_gastronomie_new,
SUM(d_religion_new) as d_religion_new,
SUM(d_oeffentlicher_raum_new) as d_oeffentlicher_raum_new,
SUM(d_dienstleistung_new) as d_dienstleistung_new,
SUM(d_waren_new) as d_waren_new,
SUM(d_leerstand_new) as d_leerstand_new
  from osm_poi_features_domain_piv_distcalc
  where timeslice in (201601, 201701)
  group by planungsraum
) dyn_d
on ewr.zeit = dyn_d.timeslice
and cast(ewr.planungsraum as int) = cast(dyn_d.planungsraum as int)

left join
(select
  planungsraum,
  201612 as timeslice,
  SUM(d_tourismus_ytd) as prev_d_tourismus_ytd,
  SUM(d_vergnuegung_ytd) as prev_d_vergnuegung_ytd,
  SUM(d_sport_und_erholung_ytd) as prev_d_sport_und_erholung_ytd,
  SUM(d_public_service_ytd) as prev_d_public_service_ytd,
  SUM(d_buero_ytd) as prev_d_buero_ytd,
  SUM(d_mobilitaet_ytd) as prev_d_mobilitaet_ytd,
  SUM(d_sonstiges_ytd) as prev_d_sonstiges_ytd,
  SUM(d_gastronomie_ytd) as prev_d_gastronomie_ytd,
  SUM(d_religion_ytd) as prev_d_religion_ytd,
  SUM(d_oeffentlicher_raum_ytd) as prev_d_oeffentlicher_raum_ytd,
  SUM(d_dienstleistung_ytd) as prev_d_dienstleistung_ytd,
  SUM(d_waren_ytd) as prev_d_waren_ytd,
  SUM(d_leerstand_ytd) as prev_d_leerstand_ytd,
  SUM(d_tourismus_new) as prev_d_tourismus_new,
SUM(d_vergnuegung_new) as prev_d_vergnuegung_new,
SUM(d_sport_und_erholung_new) as prev_d_sport_und_erholung_new,
SUM(d_public_service_new) as prev_d_public_service_new,
SUM(d_buero_new) as prev_d_buero_new,
SUM(d_mobilitaet_new) as prev_d_mobilitaet_new,
SUM(d_sonstiges_new) as prev_d_sonstiges_new,
SUM(d_gastronomie_new) as prev_d_gastronomie_new,
SUM(d_religion_new) as prev_d_religion_new,
SUM(d_oeffentlicher_raum_new) as prev_d_oeffentlicher_raum_new,
SUM(d_dienstleistung_new) as prev_d_dienstleistung_new,
SUM(d_waren_new) as prev_d_waren_new,
SUM(d_leerstand_new) as prev_d_leerstand_new
  from osm_poi_features_domain_piv_distcalc
  where timeslice in (201401, 201501)
  group by planungsraum
) dyn_d_prev
on ewr.zeit = dyn_d_prev.timeslice
and cast(ewr.planungsraum as int) = cast(dyn_d_prev.planungsraum as int)

where ewr.zeit = 201612
and mss.dynamik_klasse not like "0"
;